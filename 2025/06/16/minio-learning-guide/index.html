<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>MinIO 学习指南 | 凌霄的博客</title><meta name="keywords" content="MinIO,对象存储,分布式存储,S3兼容"><meta name="author" content="XR"><meta name="copyright" content="XR"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="MinIO 学习指南"><meta name="application-name" content="MinIO 学习指南"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="MinIO 学习指南"><meta property="og:url" content="http://example.com/2025/06/16/minio-learning-guide/index.html"><meta property="og:site_name" content="凌霄的博客"><meta property="og:description" content="MinIO 是一个高性能的分布式对象存储系统，完全兼容 Amazon S3 API。本文将全面介绍 MinIO 的核心概念、架构设计和实际使用方法。"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/09c33b5dbe1bd3fec63ad2e4128b55b6.png"><meta property="article:author" content="XR"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/09c33b5dbe1bd3fec63ad2e4128b55b6.png"><meta name="description" content="MinIO 是一个高性能的分布式对象存储系统，完全兼容 Amazon S3 API。本文将全面介绍 MinIO 的核心概念、架构设计和实际使用方法。"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2025/06/16/minio-learning-guide/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🧱 团队小组发动机"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: XR","link":"链接: ","source":"来源: 凌霄的博客","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '凌霄的博客',
  title: 'MinIO 学习指南',
  postAI: '',
  pageFillDescription: 'MinIO 学习指南, 概述, 文档结构, 1. MinIO 核心概念, 1.1 基本概念, Object（对象）, Bucket（存储桶）, Key（键）, Node（节点）, Drive（驱动器）, 1.2 高级概念, Erasure Coding（纠删码）, Tenant（租户）, 2. MinIO 整体架构, 2.1 系统架构图, 2.2 架构特点, 2.2.1 S3兼容性, 2.2.2 无主架构, 2.2.3 横向扩展, 2.2.4 高可用性, 2.3 无主架构技术原理, 2.3.1 核心机制：确定性哈希与纠删码, 确定性哈希分布算法, Reed-Solomon 纠删码, 2.3.2 数据读写机制, 并行读写真相：并非所有节点参与, 读写Quorum机制, 2.3.3 分布式元数据管理, 对象元数据 (Object Metadata), 配置元数据 (Configuration Metadata), 2.3.4 故障检测与自愈机制, 实时故障监控, 自动数据重建（自愈）, 2.3.5 无主架构的优缺点, 优势, 缺点, 2.4 集群扩容机制, 2.4.1 对等扩容（Server Pool扩容）, 2.4.2 联邦扩容（Federation）, 2.4.3 扩容方式选择建议, 2.5 MinIO技术澄清与问题解答, 重要技术澄清, 核心技术问题解答, 问题1：MinIO读写文件会并行写到所有节点吗？, 问题2：分布式元数据在扩容x2F缩容和节点宕机时如何处理？, 3. MinIO 核心流程, 3.1 数据写入流程, 3.2 数据读取流程, 3.3 故障恢复流程, 4. MinIO 与其他存储系统对比, 4.1 对象存储 vs 文件存储 vs 块存储, 存储类型架构对比, 4.2 MinIO vs HDFS 详细对比, 4.2.1 架构差异, 4.2.2 技术实现对比, 4.2.3 性能与可靠性对比, 读写性能, 故障恢复, 4.2.4 使用场景对比, 4.3 MinIO vs 其他对象存储, 4.3.1 MinIO vs AWS S3, 4.3.2 MinIO vs Ceph, 4.4 选型决策框架, 4.4.1 技术选型矩阵, 4.4.2 决策要素权重, 4.5 实际应用案例分析, 4.5.1 电商平台存储架构, 4.5.2 AIx2FML平台存储设计, 5. MinIO 命令使用指南, 5.1 安装和部署, 单机部署, 集群部署 (示例), 5.2 MinIO Client (mc) 命令, 基本配置, Bucket 操作, 对象操作, 同步操作, 5.3 权限和策略管理, 用户管理, 策略管理, 组管理, 5.4 监控和管理, 服务器信息, 性能测试, 日志管理, 5.5 高级功能, 版本控制, 生命周期管理 (ILM), 加密, 5.6 联邦扩容配置, 5.7 故障排除命令, 健康检查, 配置管理, 6. 最佳实践, 6.1 部署建议, 6.1.1 硬件配置建议, 6.1.2 集群规划建议, 6.1.3 连续IP规划, 6.2 性能优化, 6.2.1 纠删码配置优化, 6.2.2 硬件性能优化, 6.2.3 网络优化, 6.2.4 关键监控指标, 6.3 安全建议, 6.4 监控和维护, 7. 总结, 7.1 MinIO 核心优势总览, 7.2 技术特色总结, 7.3 适用场景总结, 7.4 总体评价, 7.5 最佳实践建议, 分阶段部署策略, 关键技术要点学习指南概述是一个高性能的分布式对象存储系统专为云原生应用而设计它完全兼容可以用于存储非结构化数据如图片视频日志文件备份和容器镜像等文档结构学习指南核心概念整体架构核心流程存储系统对比命令使用指南最佳实践总结基本概念高级概念系统架构图架构特点无主架构原理数据写入流程数据读取流程故障恢复流程存储类型对比选型决策框架安装部署基本命令高级功能部署建议性能优化安全建议技术特色适用场景最佳实践核心概念基本概念对象中的基本存储单元包含数据本身和相关的元数据对象大小可以从几到存储桶用于组织对象的容器类似于文件系统中的顶级目录每个部署可以有多个名称在同一集群内必须唯一键对象在中的唯一标识符类似于文件路径支持层次结构使用分隔符节点集群中的单个服务器实例可以是物理机器或虚拟机每个节点运行服务器进程驱动器节点上的存储设备可以是硬盘或网络存储使用纠删码将数据分布在多个驱动器上高级概念纠删码的核心数据保护机制将数据分割成多个数据片和校验片即使部分驱动器故障也能恢复数据提供比副本更高的存储效率租户多租户环境中的隔离单元每个租户有独立的存储空间和权限支持细粒度的访问控制整体架构系统架构图客户端层浏览器应用工具兼容客户端接入层负载均衡器集群示例节点驱动器节点节点节点节点存储层每个节点管理自己的驱动器节点驱动器节点驱动器节点驱动器节点驱动器架构特点兼容性兼容完全兼容支持支持所有主流编程语言的工具兼容支持兼容的工具和客户端功能对等支持的主要功能如存储桶操作对象操作版本控制生命周期管理加密访问控制无主架构所有节点都是对等的没有单点故障自动故障转移和恢复横向扩展支持从单节点到数千节点的扩展线性性能增长热添加新节点高可用性支持多数据中心部署自动故障检测和恢复数据一致性保证无主架构技术原理的无主架构是其实现高可用和高性能的核心这套架构依赖于几个关键的技术机制确定性哈希算法纠删码自描述的元数据管理以及智能的故障检测与自愈核心机制确定性哈希与纠删码确定性哈希分布算法不使用传统的一致性哈希环它采用基于对象名称的确定性哈希算法来决定对象应存放在哪个纠删码集合中一个纠删码集合是一组驱动器的组合因为算法是确定性的任何一个节点都可以独立计算出任意对象的存放位置从而无需中心节点协调确定性哈希分布对象名称确定性哈希对象名称确定性哈希纠删码集合驱动器组合纠删码集合驱动器组合纠删码纠删码是数据保护的基石它取代了传统的多副本方式提供了更高的存储效率基本原理编码将原始数据分割成个数据分片并基于这些数据分片生成个校验分片总共得到个分片存储将这个分片存储在不同的驱动器上恢复系统最多可以容忍个分片即个驱动器丢失只要有不少于个分片存在无论是数据分片还是校验分片就可以通过解码算法完整地恢复出原始数据纠删码配置示例会根据集群中驱动器的总数自动选择最合适的纠删码配置用户也可以手动指定常用纠删码配置个驱动器表示个校验分片数据分片个驱动器存储效率可容忍个驱动器故障适用场景高可靠性要求个驱动器存储效率可容忍个驱动器故障适用场景平衡效率和可靠性个驱动器存储效率可容忍个驱动器故障适用场景最高可靠性要求性能优化为了加速纠删码的编解码计算使用了指令集如大幅提升了处理效率使得纠删码的性能开销降到最低数据读写机制并行读写真相并非所有节点参与一个常见的误解是会将数据写入到所有节点实际上只向当前对象所属的纠删码集合所包含的驱动器及对应节点进行并行读写节点集群纠删码配置客户端请求确定性哈希计算选择个驱动器组成纠删码集合个数据分片个校验分片并行写入个驱动器并行写入个驱动器对象的存储节点节点对象的存储不同分布节点节点关键点精确并行读写操作只涉及构成纠删码集合的节点和驱动器而非整个集群负载均衡由于不同对象的哈希值不同它们会被分散到集群内不同的驱动器组合上从而自然实现了负载均衡读写机制的读写成功与否依赖于一个机制这个机制基于纠删码的特性写入对于的配置一次写入操作必须成功写入至少个分片才算成功这保证了数据至少有足够的基础可以被恢复在实际实现中要求所有个分片都写入成功如果某个驱动器暂时不可用写操作会报错由客户端重试读取一个读取操作只需要成功读取任意个分片数据或校验就可以在内存中重构出完整的原始数据会并行向所有个分片发起读取并采用最先返回的个分片写入流程写请求计算哈希定位个驱动器并行写入个分片成功写入分片数写入成功写入失败读取流程读请求计算哈希定位个驱动器并行读取所有分片成功返回分片数数据重构成功读取失败分布式元数据管理的元数据管理是其无主架构设计的精髓之一它没有中心化的元数据服务器其元数据分为两类对象元数据和配置元数据对象元数据自描述格式每个对象在磁盘上都包含一个文件这个文件与对象的数据分片存储在一起内容包含了关于该对象的所有元信息例如纠删码配置算法值值分片分布校验和创建时间等保护机制文件本身也被视为对象的一部分与数据分片一样它会被复制并分布到纠删码集合的所有驱动器上这意味着元数据和数据享有同等级别的纠删码保护优势这种设计使得每个对象都是自包含和自描述的恢复数据时系统无需查询外部的元数据服务只需读取对象自身的文件即可了解如何重构它这极大地简化了系统设计和故障恢复流程对象在磁盘上的实际存储格式示例桶对象存储在个驱动器的纠删码集合中元数据文件该驱动器上的数据校验分片元数据文件的副本该驱动器上的数据校验分片配置元数据范围这类元数据包括存储桶策略版本控制设置生命周期规则用户和策略等存储位置这些配置信息存储在每个节点的数据目录下名为的隐藏目录中同步机制集群内的所有节点会通过一个内部的分布式共识算法来保证目录下的内容在所有节点间是最终一致的当管理员在一个节点上创建用户或修改存储桶策略时这个变更会被同步到所有其他节点高可用性即使部分节点宕机只要集群的多数节点存活配置信息就不会丢失并且可以在新节点加入时同步给它这确保了集群管理操作的高可用性故障检测与自愈机制实时故障监控心跳机制节点间通过心跳包默认秒一次相互探测健康状态多维度检测监控不仅限于节点存活还包括网络延迟磁盘健康信息性能等渐进式判断系统不会因为短暂的网络抖动就立即判定节点故障而是采用可疑到故障的渐进式策略避免误判自动数据重建自愈当一个驱动器被确认故障后的自愈过程会自动启动降级模式包含故障驱动器的纠删码集合会进入降级模式此时读写请求仍可正常服务只要剩余驱动器数量大于等于后台扫描系统会扫描所有受该故障驱动器影响的对象数据重构对于每个受影响的对象会读取其剩余的个可用分片重构出丢失的分片写入新位置将重构好的分片写入到集群中的一个健康的可用的新驱动器上更新元数据更新相关对象的文件记录新的分片位置恢复正常一旦所有受影响的数据都完成重建系统就恢复到正常状态这个过程完全在后台自动进行对前台应用透明无主架构的优缺点优势高可用性无单点故障所有节点对等没有主节点任何节点的故障都不会导致整个服务中断只要满足纠删码的最小可用驱动器数线性扩展增加节点或驱动器可以带来近乎线性的性能和容量增长确定性哈希算法保证了新加入的资源会被自动利用起来运维简化所有节点配置相同部署和维护都非常简单扩容通过服务器池也无需复杂的数据重分布操作成本效益纠删码相比副本等机制在同等或更高可靠性下存储空间利用率更高从而降低了硬件成本缺点最终一致性在某些场景下比如配置信息的变更节点间的同步存在短暂延迟属于最终一致性但对于对象数据通过其机制保证了强一致性网络开销无主架构下节点间的通信心跳数据修复等会比主从架构更频繁对网络质量要求较高扩容限制单个服务器池的扩容增加驱动器需要重启虽然支持通过添加新服务器池的方式在线扩容但这增加了架构的逻辑层次同时官方建议单个集群规模不宜过大如超过个节点超大规模推荐使用联邦模式集群扩容机制支持两种主要的扩容方式每种方式都有其特定的使用场景和限制对等扩容扩容基本原理采用服务器池的概念进行扩容要求新增的节点数和磁盘数与原集群保持对等关系新老数据保持在各自的服务器池中不进行重新分布扩容流程扩容前服务器池节点原有数据扩容后服务器池服务器池节点原有数据节点新数据新对象写入负载均衡基于可用空间基于可用空间技术限制对等要求新增的服务器池必须与现有池具有完全相同的节点数和每节点的驱动器数数据不重分布旧数据停留在旧池新数据根据负载均衡策略写入到所有池中重启需求扩容操作需要重启整个集群以应用新的服务器池配置联邦扩容基本原理通过将多个独立的集群或称为租户组成一个逻辑上的大集群联邦提供统一的命名空间但各租户集群在物理上和管理上是独立的负责维护存储桶到具体租户集群的映射关系联邦架构联邦集群客户端请求统一入口网关查询集群在租户集群独立租户集群租户集群租户集群注册心跳注册心跳注册心跳联邦扩容优势无限扩展理论上可以无限连接新的租户集群打破单集群的节点数限制故障隔离一个租户集群的故障不会影响其他集群灵活性不同租户集群可以有不同的规模和配置联邦扩容缺点引入外部依赖需要部署和维护一个高可用的集群配置与管理更复杂增加了系统的整体复杂度扩容方式选择建议扩容方式适用场景优势劣势对等扩容中小型集群节点配置简单无外部依赖有节点数建议上限需要重启联邦扩容超大规模环境多租户场景无限扩展故障隔离配置复杂依赖技术澄清与问题解答基于对架构的深入理解我们可以澄清一些常见的技术误解并回答一些核心问题重要技术澄清不使用传统的一致性哈希环它使用基于对象名称的确定性哈希算法这与需要维护哈希环状态的系统有本质区别的机制基于纠删码其读写由算法的数学特性值决定而非传统的基于多数派投票的的元数据管理是自描述和分布式的对象元数据随对象本身存储和保护不存在集中式的元数据瓶颈核心技术问题解答问题读写文件会并行写到所有节点吗答案不会这是一个常见误解正确理解只向当前对象所属的纠删码集合所包含的节点驱动器并行写入而非集群中的所有节点例如在一个节点的集群中如果使用的纠删码配置那么任何一个对象的读写操作都只涉及其中的个节点驱动器通过确定性哈希算法不同的对象会被智能地分配到不同的纠删码集合上这就在宏观上实现了整个集群的负载均衡避免了不必要的网络和开销问题分布式元数据在扩容缩容和节点宕机时如何处理答案需要区分对象元数据和配置元数据对象元数据节点宕机由于和数据分片一样在纠删码集合的所有驱动器上都有副本因此它的可用性和恢复机制与对象数据完全相同只要满足读取个可用分片对象及其元数据就可以被访问和恢复扩容在服务器池扩容模式下现有对象的元数据和数据都保留在原有的服务器池中不会发生变动新对象及其元数据将被写入到包括新池在内的所有可用池中配置元数据节点宕机由于配置信息在所有节点间通过共识算法同步少数节点的宕机不会影响配置的可用性存活的节点仍然拥有完整的配置信息扩容新节点加入新加入的节点会自动从集群中的其他节点同步最新的配置信息从而快速融入集群总结的无主架构通过精巧的技术设计确定性哈希纠删码自描述元数据成功地解决了分布式系统中的经典难题实现了高可用高性能易扩展的存储系统核心流程数据写入流程客户端负载均衡器任一节点驱动器纠删码集合对象请求携带数据路由到任一可用节点根据对象名计算哈希确定驱动器集合对数据进行纠删码编码分片并行将分片写入对应驱动器确认写入完成返回成功响应数据读取流程客户端负载均衡器任一节点驱动器纠删码集合对象请求路由到任一可用节点根据对象名计算哈希确定驱动器集合并行向所有个驱动器请求分片最先返回的个分片到达在内存中重构原始数据将数据流式传输给客户端故障恢复流程检测到驱动器故障检查冗余是否充足是剩余驱动器集群进入降级模式服务不中断否剩余驱动器部分数据不可用告警管理员后台自愈进程启动扫描受影响的对象对每个对象读取个可用分片重构丢失的分片将新分片写入健康的备用驱动器更新对象的元数据所有数据恢复后集群恢复正常模式与其他存储系统对比对象存储文件存储块存储存储类型架构对比对象存储应用程序对象存储引擎扁平化命名空间元数据分布式存储池文件存储应用程序文件系统接口层级目录树结构元数据服务器数据节点块存储操作系统文件系统块设备接口存储控制器物理磁盘阵列详细对比架构差异对比维度架构模式无主架构所有节点对等主从架构单点故障无单点故障是潜在单点故障需方案数据保护纠删码多副本机制通常副本存储效率高如为低副本为访问接口小文件处理较优压力大性能较差技术实现对比架构客户端任意节点无主确定性哈希计算纠删码分片纠删码集合存储架构客户端主节点元数据查询管理从节点指令下发副本存储性能与可靠性对比读写性能擅长处理混合负载对大文件和小文件都有良好的性能表现通过智能并行读写吞吐量可达纠删码节点组的总带宽为大文件顺序读写优化流式处理能力强小文件场景下成为瓶颈性能下降严重故障恢复自动检测自动修复自愈可容忍的故障数取决于纠删码配置更灵活恢复过程对业务透明依赖协调块的复制故障需要复杂的切换如恢复过程管理相对复杂使用场景对比适用场景云原生应用存储及静态资源备份归档数据湖容器镜像仓库适用场景海量数据批处理数据仓库日志存储与分析传统大数据生态其他对象存储特性部署方式私有云混合云边缘公有云服务兼容性兼容原生标准成本硬件运维成本可控按使用量付费易超支数据主权完全自主控制依赖云服务商政策性能取决于硬件可极致优化服务等级限制有吞吐量上限定制化高度可定制黑盒不可定制对比项设计哲学简洁高性能统一功能全面存储类型纯对象存储统一存储对象块文件复杂度非常简单易于部署和运维非常复杂学习曲线陡峭性能对象存储场景下性能极致通用性强但为对象存储的调优复杂资源占用轻量级重量级适用场景需要高性能易于管理的对象存储需要统一存储平台有强大运维团队选型决策框架技术选型矩阵存储需求分析主要数据访问模式选择对象存储文件选择文件存储块设备选择块存储部署环境私有云混合云运维复杂度要求公有云阿里云等追求简洁高性能需要统一存储平台主要应用场景大数据分析通用文件共享决策要素权重要素易用性对象存储性能可靠性扩展性运维成本功能全面性实际应用案例分析电商平台存储架构电商平台存储层次电商应用缓存层热数据层商品图片视频温数据层历史订单快照冷数据层归档日志磁带云归档存储数据库数据库备份业务日志系统日志分析平台平台存储设计数据流原始数据采集数据湖统一存储数据预处理训练验证数据集读取训练数据模型训练集群模型仓库模型部署推理服务命令使用指南安装和部署单机部署下载服务器启动服务器和是启动所必需的环境变量集群部署示例在个节点上分别设置环境变量和启动命令假设节点为到在所有节点上执行命令基本配置安装客户端添加服务器别名列出所有别名操作创建列出所有删除必须为空强制删除非空对象操作上传文件上传目录下载文件下载目录列出对象递归列出所有对象删除对象批量删除同步操作将本地目录的更改同步到将目录的更改同步到本地权限和策略管理用户管理创建用户列出用户禁用用户启用用户删除用户策略管理列出内置策略创建自定义策略文件添加策略将策略分配给用户组管理创建组列出组将策略分配给组监控和管理服务器信息查看服务器信息包含存储版本运行时间等重启服务性能测试运行基准性能测试日志管理查看服务器日志查看审计日志高级功能版本控制启用版本控制查看版本控制状态列出对象所有版本删除特定版本生命周期管理创建生命周期规则天后过期对象应用生命周期规则查看生命周期规则加密启用服务器端加密查看加密状态联邦扩容配置启动集群示例节点配置并启动租户集群在所有节点上设置环境变量租户集群的公共启动集群租户故障排除命令健康检查检查集群健康状况并修复递归地检查所有对象配置管理查看当前配置设置配置例如区域重置配置为默认值最佳实践部署建议硬件配置建议存储设备强烈推荐使用同质化的以避免慢盘效应使用模式避免使用硬件网络带宽为发挥极致性能建议节点间使用到的高速网络要求为最大化纠删码性能推荐使用支持指令集的内存配置内存使用与并发请求数和纠删码配置相关官方建议对于以下的小规模部署每节点至少配置内存对于更大规模的部署应根据监控的实际内存使用情况进行规划以支持高并发连接和元数据缓存集群规划建议纠删码集合大小每个纠删码集合的驱动器数量建议为到块节点数量限制对于单个集群为保证通信效率和一致性建议节点数不要超过个更大规模请使用联邦模式可用区部署为实现高可用性应将节点和驱动器分布在不同的物理机架数据中心可用区中轮询配置轮询或使用负载均衡器将客户端请求分发到所有节点连续规划推荐使用连续的节点和相似的目录结构便于模板化配置和管理而非分散的和不规则的目录性能优化纠删码配置优化可靠性与效率的平衡根据业务对数据可靠性的要求和成本预算选择合适的纠删码配置例如存储效率可容忍个驱动器故障是性能和可靠性的良好平衡点例如存储效率可容忍个驱动器故障提供极高的可靠性但成本较高默认配置推荐对于大多数场景自动选择的默认纠删码配置通常是是一个很好的起点硬件性能优化启用确保支持并启用了指令集使用充分利用其高和低延迟特性避免硬件会与自身的纠删码和数据保护机制冲突并引入性能瓶颈网络优化高速网络使用网络以支持线速读写负载均衡策略使用支持最小连接数或轮询的负载均衡策略网络拓扑设计扁平化的网络拓扑最小化节点间的网络跳数和延迟关键监控指标吞吐量监控集群的读写吞吐量是否符合预期延迟监控请求的平均和延迟驱动器健康监控驱动器的数据等待时间错误率等纠删码状态监控是否有降级的纠删码集合以及数据重建的进度和速度安全建议启用为所有和控制台流量强制启用加密传输使用实施最小权限原则为不同应用创建专用的用户和策略密钥管理定期轮换访问密钥和密钥加密密钥审计日志启用并定期审计访问日志监控异常行为监控和维护集成利用内置的端点进行全面的监控和告警定期健康检查定期运行检查数据完整性容量规划监控磁盘使用率并根据增长趋势制定扩容计划灾难恢复演练定期进行灾备演练确保备份和恢复流程有效总结核心优势总览核心优势对象存储简洁高性能云原生设计兼容性企业级特性无主架构纠删码优化加速轻量级容器化易于自动化运维水平扩展事实标准庞大的生态系统无缝迁移加密与安全生命周期管理多租户与联邦技术特色总结通过以下关键技术实现了其独特的优势架构创新无主设计采用确定性哈希算法和纠删码集合从根本上消除了单点故障和性能瓶颈纠删码提供比传统副本更高的存储效率和更灵活的容错能力自描述元数据随对象存储确保数据的完整性可移植性和恢复的简便性性能优化加速利用等指令集将纠删码计算的开销降至最低智能并行处理读写操作仅限于纠删码集合内的节点精准并行避免了不必要的网络风暴运维友好极简设计单个二进制文件无复杂依赖配置简单自动修复内置数据完整性检查和自愈机制大大降低了运维负担适用场景总结在以下场景中表现尤为出色云原生应用存储作为等容器化环境的持久化存储后端数据湖与为等框架提供高性能可扩展的统一存储层备份与归档为数据库虚拟机应用日志提供高性价比高可靠的数据保护方案与媒体服务作为静态资源图片视频的源站满足高并发访问需求总体评价是一个功能强大性能卓越且设计简洁的对象存储解决方案它通过对分布式系统核心问题的深刻理解和创新性的工程实现成功地在性能可靠性可扩展性和易用性之间取得了卓越的平衡对于寻求在私有云混合云或边缘环境中部署兼容存储的组织而言无疑是当前市场上最具竞争力的选择之一最佳实践建议分阶段部署策略规划阶段根据业务需求选择合适的纠删码配置是良好起点规划集群节点和驱动器数量确保它们均匀分布在不同故障域设计长远的扩容策略对等扩容联邦扩容部署阶段确保硬件和网络配置满足性能要求高速网络使用自动化工具如进行声明式部署和配置管理配置轮询或负载均衡器运维阶段集成和建立完善的监控和告警体系定期执行进行数据巡检定期进行安全审计和密钥轮换优化阶段根据监控数据持续调优系统参数根据业务增长执行预先规划的扩容策略关键技术要点理解纠删码深入理解纠删码的值对可靠性和存储效率的影响理解元数据清晰区分对象元数据和配置元数据的不同管理方式善用硬件特性充分利用高速网络等硬件特性来释放的全部潜力',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-06-18 09:38:36',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">凌霄的博客</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231130275.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231130275.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231143327.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231143327.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Argon2/" style="font-size: 1.05rem;">Argon2<sup>1</sup></a><a href="/tags/DNS/" style="font-size: 1.05rem;">DNS<sup>2</sup></a><a href="/tags/DSP/" style="font-size: 1.05rem;">DSP<sup>1</sup></a><a href="/tags/HBase/" style="font-size: 1.05rem;">HBase<sup>1</sup></a><a href="/tags/HDFS/" style="font-size: 1.05rem;">HDFS<sup>2</sup></a><a href="/tags/Hadoop/" style="font-size: 1.05rem;">Hadoop<sup>1</sup></a><a href="/tags/Hive/" style="font-size: 1.05rem;">Hive<sup>1</sup></a><a href="/tags/Java/" style="font-size: 1.05rem;">Java<sup>6</sup></a><a href="/tags/Kubernetes/" style="font-size: 1.05rem;">Kubernetes<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>4</sup></a><a href="/tags/MinIO/" style="font-size: 1.05rem;">MinIO<sup>1</sup></a><a href="/tags/NAT/" style="font-size: 1.05rem;">NAT<sup>1</sup></a><a href="/tags/RTB/" style="font-size: 1.05rem;">RTB<sup>1</sup></a><a href="/tags/S3%E5%85%BC%E5%AE%B9/" style="font-size: 1.05rem;">S3兼容<sup>1</sup></a><a href="/tags/SGX/" style="font-size: 1.05rem;">SGX<sup>2</sup></a><a href="/tags/Spark/" style="font-size: 1.05rem;">Spark<sup>2</sup></a><a href="/tags/Spring/" style="font-size: 1.05rem;">Spring<sup>2</sup></a><a href="/tags/TDX/" style="font-size: 1.05rem;">TDX<sup>2</sup></a><a href="/tags/TEE/" style="font-size: 1.05rem;">TEE<sup>2</sup></a><a href="/tags/TME/" style="font-size: 1.05rem;">TME<sup>2</sup></a><a href="/tags/YARN/" style="font-size: 1.05rem;">YARN<sup>1</sup></a><a href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/" style="font-size: 1.05rem;">云原生<sup>1</sup></a><a href="/tags/%E5%86%85%E5%AD%98%E8%AE%A1%E7%AE%97/" style="font-size: 1.05rem;">内存计算<sup>1</sup></a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%A4%84%E7%90%86/" style="font-size: 1.05rem;">分布式处理<sup>1</sup></a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/" style="font-size: 1.05rem;">分布式存储<sup>2</sup></a><a href="/tags/%E5%93%88%E5%B8%8C/" style="font-size: 1.05rem;">哈希<sup>1</sup></a><a href="/tags/%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/" style="font-size: 1.05rem;">哈希算法<sup>1</sup></a><a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 1.05rem;">大数据<sup>1</sup></a><a href="/tags/%E5%AE%89%E5%85%A8/" style="font-size: 1.05rem;">安全<sup>2</sup></a><a href="/tags/%E5%AF%86%E7%A0%81%E5%93%88%E5%B8%8C/" style="font-size: 1.05rem;">密码哈希<sup>1</sup></a><a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8/" style="font-size: 1.05rem;">密码存储<sup>1</sup></a><a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size: 1.05rem;">密码学<sup>1</sup></a><a href="/tags/%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8/" style="font-size: 1.05rem;">对象存储<sup>1</sup></a><a href="/tags/%E5%B9%B6%E5%8F%91/" style="font-size: 1.05rem;">并发<sup>2</sup></a><a href="/tags/%E5%B9%BF%E5%91%8A%E6%8A%95%E6%94%BE/" style="font-size: 1.05rem;">广告投放<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F/" style="font-size: 1.05rem;">系统<sup>2</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/" style="font-size: 1.05rem;">系统安全<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 1.05rem;">网络<sup>4</sup></a><a href="/tags/%E9%98%B2%E7%81%AB%E5%A2%99/" style="font-size: 1.05rem;">防火墙<sup>2</sup></a><a href="/tags/%E9%9A%90%E7%A7%81%E8%AE%A1%E7%AE%97/" style="font-size: 1.05rem;">隐私计算<sup>2</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/07/"><span class="card-archive-list-date">七月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">六月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">32</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url">后端</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/MinIO/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>MinIO</span></a><a class="article-meta__tags" href="/tags/%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>对象存储</span></a><a class="article-meta__tags" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>分布式存储</span></a><a class="article-meta__tags" href="/tags/S3%E5%85%BC%E5%AE%B9/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>S3兼容</span></a></span></div></div><h1 class="post-title" itemprop="name headline">MinIO 学习指南</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-06-16T01:00:00.000Z" title="发表于 2025-06-16 09:00:00">2025-06-16</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-06-18T01:38:36.335Z" title="更新于 2025-06-18 09:38:36">2025-06-18</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="MinIO 学习指南"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为杭州"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>杭州</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/09c33b5dbe1bd3fec63ad2e4128b55b6.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2025/06/16/minio-learning-guide/"><header><a class="post-meta-categories" href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url">后端</a><a href="/tags/MinIO/" tabindex="-1" itemprop="url">MinIO</a><a href="/tags/%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8/" tabindex="-1" itemprop="url">对象存储</a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/" tabindex="-1" itemprop="url">分布式存储</a><a href="/tags/S3%E5%85%BC%E5%AE%B9/" tabindex="-1" itemprop="url">S3兼容</a><h1 id="CrawlerTitle" itemprop="name headline">MinIO 学习指南</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">XR</span><time itemprop="dateCreated datePublished" datetime="2025-06-16T01:00:00.000Z" title="发表于 2025-06-16 09:00:00">2025-06-16</time><time itemprop="dateCreated datePublished" datetime="2025-06-18T01:38:36.335Z" title="更新于 2025-06-18 09:38:36">2025-06-18</time></header><h1 id="MinIO-学习指南"><a href="#MinIO-学习指南" class="headerlink" title="MinIO 学习指南"></a>MinIO 学习指南</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>MinIO 是一个高性能的分布式对象存储系统，专为云原生应用而设计。它完全兼容 Amazon S3 API，可以用于存储非结构化数据，如图片、视频、日志文件、备份和容器镜像等。</p>
<h2 id="文档结构"><a href="#文档结构" class="headerlink" title="文档结构"></a>文档结构</h2><div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph TD
    A[MinIO学习指南] --&gt; B[1.核心概念]
    A --&gt; C[2.整体架构]
    A --&gt; D[3.核心流程]
    A --&gt; E[4.存储系统对比]
    A --&gt; F[5.命令使用指南]
    A --&gt; G[6.最佳实践]
    A --&gt; H[7.总结]
    
    B --&gt; B1[基本概念]
    B --&gt; B2[高级概念]
    
    C --&gt; C1[系统架构图]
    C --&gt; C2[架构特点]
    C --&gt; C3[无主架构原理]
    
    D --&gt; D1[数据写入流程]
    D --&gt; D2[数据读取流程]
    D --&gt; D3[故障恢复流程]
    
    E --&gt; E1[存储类型对比]
    E --&gt; E2[MinIO vs HDFS]
    E --&gt; E3[选型决策框架]
    
    F --&gt; F1[安装部署]
    F --&gt; F2[基本命令]
    F --&gt; F3[高级功能]
    
    G --&gt; G1[部署建议]
    G --&gt; G2[性能优化]
    G --&gt; G3[安全建议]
    
    H --&gt; H1[技术特色]
    H --&gt; H2[适用场景]
    H --&gt; H3[最佳实践]
  </pre></div>

<h2 id="1-MinIO-核心概念"><a href="#1-MinIO-核心概念" class="headerlink" title="1. MinIO 核心概念"></a>1. MinIO 核心概念</h2><h3 id="1-1-基本概念"><a href="#1-1-基本概念" class="headerlink" title="1.1 基本概念"></a>1.1 基本概念</h3><h4 id="Object（对象）"><a href="#Object（对象）" class="headerlink" title="Object（对象）"></a>Object（对象）</h4><ul>
<li>MinIO 中的基本存储单元</li>
<li>包含数据本身和相关的元数据</li>
<li>对象大小可以从几 KB 到 5TB</li>
</ul>
<h4 id="Bucket（存储桶）"><a href="#Bucket（存储桶）" class="headerlink" title="Bucket（存储桶）"></a>Bucket（存储桶）</h4><ul>
<li>用于组织对象的容器</li>
<li>类似于文件系统中的顶级目录</li>
<li>每个 MinIO 部署可以有多个 bucket</li>
<li>Bucket 名称在同一 MinIO 集群内必须唯一</li>
</ul>
<h4 id="Key（键）"><a href="#Key（键）" class="headerlink" title="Key（键）"></a>Key（键）</h4><ul>
<li>对象在 bucket 中的唯一标识符</li>
<li>类似于文件路径</li>
<li>支持层次结构（使用 <code>/</code> 分隔符）</li>
</ul>
<h4 id="Node（节点）"><a href="#Node（节点）" class="headerlink" title="Node（节点）"></a>Node（节点）</h4><ul>
<li>MinIO 集群中的单个服务器实例</li>
<li>可以是物理机器或虚拟机</li>
<li>每个节点运行 MinIO 服务器进程</li>
</ul>
<h4 id="Drive（驱动器）"><a href="#Drive（驱动器）" class="headerlink" title="Drive（驱动器）"></a>Drive（驱动器）</h4><ul>
<li>节点上的存储设备</li>
<li>可以是硬盘、SSD 或网络存储</li>
<li>MinIO 使用纠删码将数据分布在多个驱动器上</li>
</ul>
<h3 id="1-2-高级概念"><a href="#1-2-高级概念" class="headerlink" title="1.2 高级概念"></a>1.2 高级概念</h3><h4 id="Erasure-Coding（纠删码）"><a href="#Erasure-Coding（纠删码）" class="headerlink" title="Erasure Coding（纠删码）"></a>Erasure Coding（纠删码）</h4><ul>
<li>MinIO 的核心数据保护机制</li>
<li>将数据分割成多个数据片和校验片</li>
<li>即使部分驱动器故障也能恢复数据</li>
<li>提供比副本更高的存储效率</li>
</ul>
<h4 id="Tenant（租户）"><a href="#Tenant（租户）" class="headerlink" title="Tenant（租户）"></a>Tenant（租户）</h4><ul>
<li>多租户环境中的隔离单元</li>
<li>每个租户有独立的存储空间和权限</li>
<li>支持细粒度的访问控制</li>
</ul>
<h2 id="2-MinIO-整体架构"><a href="#2-MinIO-整体架构" class="headerlink" title="2. MinIO 整体架构"></a>2. MinIO 整体架构</h2><h3 id="2-1-系统架构图"><a href="#2-1-系统架构图" class="headerlink" title="2.1 系统架构图"></a>2.1 系统架构图</h3><div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph TB
    subgraph &quot;客户端层&quot;
        A1[Web浏览器]
        A2[SDK应用]
        A3[CLI工具]
        A4[S3兼容客户端]
    end

    subgraph &quot;接入层&quot;
        B1[DNS]
        B2[负载均衡器]
    end

    subgraph &quot;MinIO集群 (示例: 4节点, 16驱动器)&quot;
        C1[节点1]
        C2[节点2]
        C3[节点3]
        C4[节点4]
    end

    subgraph &quot;存储层 (每个节点管理自己的驱动器)&quot;
        subgraph &quot;节点1驱动器&quot;
            D1_1[Drive]
            D1_2[Drive]
            D1_3[Drive]
            D1_4[Drive]
        end
        subgraph &quot;节点2驱动器&quot;
            D2_1[Drive]
            D2_2[Drive]
            D2_3[Drive]
            D2_4[Drive]
        end
        subgraph &quot;节点3驱动器&quot;
            D3_1[Drive]
            D3_2[Drive]
            D3_3[Drive]
            D3_4[Drive]
        end
        subgraph &quot;节点4驱动器&quot;
            D4_1[Drive]
            D4_2[Drive]
            D4_3[Drive]
            D4_4[Drive]
        end
    end

    A1 --&gt; B1
    A2 --&gt; B1
    A3 --&gt; B1
    A4 --&gt; B1

    B1 --&gt; B2

    B2 --&gt; C1
    B2 --&gt; C2
    B2 --&gt; C3
    B2 --&gt; C4

    C1 --&gt; D1_1
    C1 --&gt; D1_2
    C1 --&gt; D1_3
    C1 --&gt; D1_4

    C2 --&gt; D2_1
    C2 --&gt; D2_2
    C2 --&gt; D2_3
    C2 --&gt; D2_4

    C3 --&gt; D3_1
    C3 --&gt; D3_2
    C3 --&gt; D3_3
    C3 --&gt; D3_4

    C4 --&gt; D4_1
    C4 --&gt; D4_2
    C4 --&gt; D4_3
    C4 --&gt; D4_4
  </pre></div>

<h3 id="2-2-架构特点"><a href="#2-2-架构特点" class="headerlink" title="2.2 架构特点"></a>2.2 架构特点</h3><h4 id="2-2-1-S3兼容性"><a href="#2-2-1-S3兼容性" class="headerlink" title="2.2.1 S3兼容性"></a>2.2.1 S3兼容性</h4><ul>
<li><strong>API兼容</strong>：完全兼容Amazon S3 API</li>
<li><strong>SDK支持</strong>：支持所有主流编程语言的S3 SDK</li>
<li><strong>工具兼容</strong>：支持S3兼容的工具和客户端</li>
<li><strong>功能对等</strong>：支持S3的主要功能，如：<ul>
<li>存储桶操作</li>
<li>对象操作</li>
<li>版本控制</li>
<li>生命周期管理</li>
<li>加密</li>
<li>访问控制</li>
</ul>
</li>
</ul>
<h4 id="2-2-2-无主架构"><a href="#2-2-2-无主架构" class="headerlink" title="2.2.2 无主架构"></a>2.2.2 无主架构</h4><ul>
<li>所有节点都是对等的</li>
<li>没有单点故障</li>
<li>自动故障转移和恢复</li>
</ul>
<h4 id="2-2-3-横向扩展"><a href="#2-2-3-横向扩展" class="headerlink" title="2.2.3 横向扩展"></a>2.2.3 横向扩展</h4><ul>
<li>支持从单节点到数千节点的扩展</li>
<li>线性性能增长</li>
<li>热添加新节点</li>
</ul>
<h4 id="2-2-4-高可用性"><a href="#2-2-4-高可用性" class="headerlink" title="2.2.4 高可用性"></a>2.2.4 高可用性</h4><ul>
<li>支持多数据中心部署</li>
<li>自动故障检测和恢复</li>
<li>数据一致性保证</li>
</ul>
<h3 id="2-3-无主架构技术原理"><a href="#2-3-无主架构技术原理" class="headerlink" title="2.3 无主架构技术原理"></a>2.3 无主架构技术原理</h3><p>MinIO的无主架构是其实现高可用和高性能的核心。这套架构依赖于几个关键的技术机制：确定性哈希算法、纠删码、自描述的元数据管理以及智能的故障检测与自愈。</p>
<h4 id="2-3-1-核心机制：确定性哈希与纠删码"><a href="#2-3-1-核心机制：确定性哈希与纠删码" class="headerlink" title="2.3.1 核心机制：确定性哈希与纠删码"></a>2.3.1 核心机制：确定性哈希与纠删码</h4><h5 id="确定性哈希分布算法"><a href="#确定性哈希分布算法" class="headerlink" title="确定性哈希分布算法"></a>确定性哈希分布算法</h5><p>MinIO不使用传统的一致性哈希环。它采用基于对象名称（Bucket + Object）的确定性哈希算法（HighwayHash）来决定对象应存放在哪个纠删码集合（Erasure Set）中。一个纠删码集合是一组驱动器的组合。因为算法是确定性的，任何一个节点都可以独立计算出任意对象的存放位置，从而无需中心节点协调。</p>
<div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph LR
    subgraph &quot;确定性哈希分布&quot;
        A[对象A名称] --&gt; H1[确定性哈希]
        B[对象B名称] --&gt; H2[确定性哈希]
        
        H1 --&gt; ES1[&quot;纠删码集合1 (驱动器组合A)&quot;]
        H2 --&gt; ES2[&quot;纠删码集合2 (驱动器组合B)&quot;]
    end
  </pre></div>

<h5 id="Reed-Solomon-纠删码"><a href="#Reed-Solomon-纠删码" class="headerlink" title="Reed-Solomon 纠删码"></a>Reed-Solomon 纠删码</h5><p>纠删码是MinIO数据保护的基石，它取代了传统的多副本方式，提供了更高的存储效率。</p>
<p><strong>基本原理</strong>:</p>
<ul>
<li><strong>编码</strong>: 将原始数据分割成K个数据分片，并基于这些数据分片生成M个校验分片。总共得到K+M个分片。</li>
<li><strong>存储</strong>: 将这K+M个分片存储在不同的驱动器上。</li>
<li><strong>恢复</strong>: 系统最多可以容忍M个分片（即M个驱动器）丢失。只要有不少于K个分片存在（无论是数据分片还是校验分片），就可以通过Reed-Solomon解码算法完整地恢复出原始数据。</li>
</ul>
<p><strong>纠删码配置示例</strong>:<br>MinIO会根据集群中驱动器的总数自动选择最合适的纠删码配置（K+M）。用户也可以手动指定。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 常用纠删码配置 (N个驱动器，EC:M表示M个校验分片)</span></span><br><span class="line"><span class="comment"># 数据分片K = N - M</span></span><br><span class="line"></span><br><span class="line">1. 8个驱动器, EC:4 (4+4)</span><br><span class="line">   - 存储效率: 50%, 可容忍4个驱动器故障。</span><br><span class="line">   - 适用场景: 高可靠性要求。</span><br><span class="line"></span><br><span class="line">2. 16个驱动器, EC:4 (12+4)</span><br><span class="line">   - 存储效率: 75%, 可容忍4个驱动器故障。</span><br><span class="line">   - 适用场景: 平衡效率和可靠性。</span><br><span class="line"></span><br><span class="line">3. 16个驱动器, EC:8 (8+8)</span><br><span class="line">   - 存储效率: 50%, 可容忍8个驱动器故障。</span><br><span class="line">   - 适用场景: 最高可靠性要求。</span><br></pre></td></tr></table></figure>

<p><strong>性能优化</strong>：<br>为了加速纠删码的编解码计算，MinIO使用了SIMD指令集（如Intel AVX512），大幅提升了CPU处理效率，使得纠删码的性能开销降到最低。</p>
<h4 id="2-3-2-数据读写机制"><a href="#2-3-2-数据读写机制" class="headerlink" title="2.3.2 数据读写机制"></a>2.3.2 数据读写机制</h4><h5 id="并行读写真相：并非所有节点参与"><a href="#并行读写真相：并非所有节点参与" class="headerlink" title="并行读写真相：并非所有节点参与"></a>并行读写真相：并非所有节点参与</h5><p>一个常见的误解是MinIO会将数据写入到所有节点。实际上，MinIO只向当前对象所属的纠删码集合（Erasure Set）所包含的驱动器（及对应节点）进行并行读写。</p>
<div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph TB
    subgraph &quot;16节点集群, 8+8纠删码配置&quot;
        A[客户端请求] --&gt; B[确定性哈希计算]
        B --&gt; C{选择16个驱动器组成纠删码集合}
        
        C --&gt; D[8个数据分片]
        C --&gt; E[8个校验分片]
        
        D --&gt; N_Data[并行写入8个驱动器]
        E --&gt; N_Parity[并行写入8个驱动器]
        
        subgraph &quot;对象A的存储&quot;
            N_Data --&gt; NA[&quot;节点1,3,5,...&quot;]
            N_Parity --&gt; PA[&quot;节点2,4,6,...&quot;]
        end
        
        subgraph &quot;对象B的存储 (不同分布)&quot;
            style NB fill:#cce5ff
            style PB fill:#fff2cc
            B --&gt; NB[&quot;节点2,5,8,...&quot;]
            B --&gt; PB[&quot;节点1,4,7,...&quot;]
        end
    end
  </pre></div>
<p><strong>关键点</strong>:</p>
<ol>
<li><strong>精确并行</strong>：读写操作只涉及构成纠删码集合的节点和驱动器，而非整个集群。</li>
<li><strong>负载均衡</strong>：由于不同对象的哈希值不同，它们会被分散到集群内不同的驱动器组合上，从而自然实现了负载均衡。</li>
</ol>
<h5 id="读写Quorum机制"><a href="#读写Quorum机制" class="headerlink" title="读写Quorum机制"></a>读写Quorum机制</h5><p>MinIO的读写成功与否依赖于一个”Quorum”机制，这个机制基于纠删码的特性。</p>
<ul>
<li><strong>写入Quorum</strong>：对于K+M的配置，一次写入操作必须成功写入至少K个分片才算成功。这保证了数据至少有足够的”基础”可以被恢复。在实际实现中，MinIO要求所有K+M个分片都写入成功，如果某个驱动器暂时不可用，写操作会报错，由客户端重试。</li>
<li><strong>读取Quorum</strong>：一个读取操作只需要成功读取任意K个分片（数据或校验），就可以在内存中重构出完整的原始数据。MinIO会并行向所有K+M个分片发起读取，并采用最先返回的K个分片。</li>
</ul>
<div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph TD
    subgraph &quot;写入流程&quot;
        A[写请求] --&gt; B[&quot;计算哈希, 定位K+M个驱动器&quot;]
        B --&gt; C[&quot;并行写入K+M个分片&quot;]
        C --&gt; D{成功写入分片数}
        D --&gt;|&gt;&#x3D; K+M| E[写入成功]
        D --&gt;|&lt; K+M| F[写入失败]
    end

    subgraph &quot;读取流程&quot;
        G[读请求] --&gt; H[&quot;计算哈希, 定位K+M个驱动器&quot;]
        H --&gt; I[并行读取所有分片]
        I --&gt; J{成功返回分片数}
        J --&gt;|&gt;&#x3D; K| K[数据重构成功]
        J --&gt;|&lt; K| L[读取失败]
    end
  </pre></div>

<h4 id="2-3-3-分布式元数据管理"><a href="#2-3-3-分布式元数据管理" class="headerlink" title="2.3.3 分布式元数据管理"></a>2.3.3 分布式元数据管理</h4><p>MinIO的元数据管理是其无主架构设计的精髓之一，它没有中心化的元数据服务器。其元数据分为两类：对象元数据和配置元数据。</p>
<h5 id="对象元数据-Object-Metadata"><a href="#对象元数据-Object-Metadata" class="headerlink" title="对象元数据 (Object Metadata)"></a>对象元数据 (Object Metadata)</h5><ul>
<li><strong>自描述格式</strong>：每个对象在磁盘上都包含一个 <code>xl.json</code> 文件。这个文件与对象的数据分片（<code>part.1</code>）存储在一起。</li>
<li><strong>内容</strong>: <code>xl.json</code> 包含了关于该对象的所有元信息，例如纠删码配置（算法、K值、M值）、分片分布、校验和、创建时间等。</li>
<li><strong>保护机制</strong>: <code>xl.json</code> 文件本身也被视为对象的一部分，与数据分片一样，它会被复制并分布到纠删码集合的所有驱动器上。这意味着元数据和数据享有同等级别的纠删码保护。</li>
<li><strong>优势</strong>: 这种设计使得每个对象都是”自包含”和”自描述”的。恢复数据时，系统无需查询外部的元数据服务，只需读取对象自身的 <code>xl.json</code> 文件即可了解如何重构它。这极大地简化了系统设计和故障恢复流程。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对象在磁盘上的实际存储格式示例</span></span><br><span class="line"><span class="comment"># 桶 MyBucket, 对象 MyObject, 存储在4个驱动器的纠删码集合中</span></span><br><span class="line">/path/to/drive1/MyBucket/MyObject/</span><br><span class="line">├── xl.json        <span class="comment"># 元数据文件</span></span><br><span class="line">└── part.1         <span class="comment"># 该驱动器上的数据/校验分片</span></span><br><span class="line"></span><br><span class="line">/path/to/drive2/MyBucket/MyObject/</span><br><span class="line">├── xl.json        <span class="comment"># 元数据文件的副本</span></span><br><span class="line">└── part.2         <span class="comment"># 该驱动器上的数据/校验分片</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h5 id="配置元数据-Configuration-Metadata"><a href="#配置元数据-Configuration-Metadata" class="headerlink" title="配置元数据 (Configuration Metadata)"></a>配置元数据 (Configuration Metadata)</h5><ul>
<li><strong>范围</strong>: 这类元数据包括存储桶策略、版本控制设置、生命周期规则（ILM）、IAM用户和策略等。</li>
<li><strong>存储位置</strong>: 这些配置信息存储在每个节点的数据目录下名为 <code>.minio.sys/</code> 的隐藏目录中。</li>
<li><strong>同步机制</strong>: MinIO集群内的所有节点会通过一个内部的分布式共识（consensus）算法来保证 <code>.minio.sys/</code> 目录下的内容在所有节点间是最终一致的。当管理员在一个节点上创建用户或修改存储桶策略时，这个变更会被同步到所有其他节点。</li>
<li><strong>高可用性</strong>: 即使部分节点宕机，只要集群的多数节点存活，配置信息就不会丢失，并且可以在新节点加入时同步给它。这确保了集群管理操作的高可用性。</li>
</ul>
<h4 id="2-3-4-故障检测与自愈机制"><a href="#2-3-4-故障检测与自愈机制" class="headerlink" title="2.3.4 故障检测与自愈机制"></a>2.3.4 故障检测与自愈机制</h4><h5 id="实时故障监控"><a href="#实时故障监控" class="headerlink" title="实时故障监控"></a>实时故障监控</h5><ul>
<li><strong>心跳机制</strong>：节点间通过心跳包（默认30秒一次）相互探测健康状态。</li>
<li><strong>多维度检测</strong>：监控不仅限于节点存活，还包括网络延迟、磁盘健康（SMART信息）、IO性能等。</li>
<li><strong>渐进式判断</strong>：系统不会因为短暂的网络抖动就立即判定节点故障，而是采用”可疑”到”故障”的渐进式策略，避免误判。</li>
</ul>
<h5 id="自动数据重建（自愈）"><a href="#自动数据重建（自愈）" class="headerlink" title="自动数据重建（自愈）"></a>自动数据重建（自愈）</h5><p>当一个驱动器被确认故障后，MinIO的自愈（Healing）过程会自动启动：</p>
<ol>
<li><strong>降级模式</strong>：包含故障驱动器的纠删码集合会进入降级（degraded）模式。此时读写请求仍可正常服务（只要剩余驱动器数量大于等于K）。</li>
<li><strong>后台扫描</strong>：系统会扫描所有受该故障驱动器影响的对象。</li>
<li><strong>数据重构</strong>：对于每个受影响的对象，MinIO会读取其剩余的K个可用分片，重构出丢失的分片。</li>
<li><strong>写入新位置</strong>：将重构好的分片写入到集群中的一个健康的、可用的新驱动器上。</li>
<li><strong>更新元数据</strong>：更新相关对象的<code>xl.json</code>文件，记录新的分片位置。</li>
<li><strong>恢复正常</strong>：一旦所有受影响的数据都完成重建，系统就恢复到正常状态。</li>
</ol>
<p>这个过程完全在后台自动进行，对前台应用透明。</p>
<h4 id="2-3-5-无主架构的优缺点"><a href="#2-3-5-无主架构的优缺点" class="headerlink" title="2.3.5 无主架构的优缺点"></a>2.3.5 无主架构的优缺点</h4><h5 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h5><ol>
<li>**高可用性 (无单点故障)**：所有节点对等，没有主节点。任何节点的故障都不会导致整个服务中断，只要满足纠删码的最小可用驱动器数。</li>
<li><strong>线性扩展</strong>：增加节点或驱动器可以带来近乎线性的性能和容量增长。确定性哈希算法保证了新加入的资源会被自动利用起来。</li>
<li><strong>运维简化</strong>：所有节点配置相同，部署和维护都非常简单。扩容（通过服务器池）也无需复杂的数据重分布操作。</li>
<li><strong>成本效益</strong>：纠删码相比3副本等机制，在同等或更高可靠性下，存储空间利用率更高，从而降低了硬件成本。</li>
</ol>
<h5 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h5><ol>
<li><strong>最终一致性</strong>：在某些场景下，比如配置信息的变更，节点间的同步存在短暂延迟，属于最终一致性。但对于对象数据IO，MinIO通过其Quorum机制保证了强一致性。</li>
<li><strong>网络开销</strong>：无主架构下，节点间的通信（心跳、数据修复等）会比主从架构更频繁，对网络质量要求较高。</li>
<li><strong>扩容限制</strong>：单个服务器池的扩容（增加驱动器）需要重启。虽然支持通过添加新服务器池（Server Pool）的方式在线扩容，但这增加了架构的逻辑层次。同时，官方建议单个集群规模不宜过大（如超过32个节点），超大规模推荐使用联邦模式。</li>
</ol>
<h3 id="2-4-集群扩容机制"><a href="#2-4-集群扩容机制" class="headerlink" title="2.4 集群扩容机制"></a>2.4 集群扩容机制</h3><p>MinIO 支持两种主要的扩容方式，每种方式都有其特定的使用场景和限制。</p>
<h4 id="2-4-1-对等扩容（Server-Pool扩容）"><a href="#2-4-1-对等扩容（Server-Pool扩容）" class="headerlink" title="2.4.1 对等扩容（Server Pool扩容）"></a>2.4.1 对等扩容（Server Pool扩容）</h4><p><strong>基本原理</strong>：</p>
<ul>
<li>MinIO 采用服务器池（Server Pool）的概念进行扩容</li>
<li>要求新增的节点数和磁盘数与原集群保持对等关系</li>
<li>新老数据保持在各自的服务器池中，不进行重新分布</li>
</ul>
<p><strong>扩容流程</strong>：</p>
<div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph TB
    subgraph &quot;扩容前&quot;
        SP1[服务器池1]
        SP1 --&gt; N1[节点1-4]
        SP1 --&gt; D1[原有数据]
    end
    
    subgraph &quot;扩容后&quot;
        SP1_FINAL[服务器池1]
        SP2_FINAL[服务器池2]
        
        SP1_FINAL --&gt; N1_FINAL[节点1-4]
        SP1_FINAL --&gt; D1_FINAL[原有数据]
        
        SP2_FINAL --&gt; N2_FINAL[节点5-8]
        SP2_FINAL --&gt; D2_FINAL[新数据]
        
        APP[新对象写入] --&gt; BALANCE{负载均衡}
        BALANCE --&gt;|基于可用空间| SP1_FINAL
        BALANCE --&gt;|基于可用空间| SP2_FINAL
    end
  </pre></div>

<p><strong>技术限制</strong>：</p>
<ul>
<li><strong>对等要求</strong>：新增的服务器池必须与现有池具有完全相同的节点数和每节点的驱动器数。</li>
<li><strong>数据不重分布</strong>：旧数据停留在旧池，新数据根据负载均衡策略写入到所有池中。</li>
<li><strong>重启需求</strong>：扩容操作需要重启整个集群以应用新的服务器池配置。</li>
</ul>
<h4 id="2-4-2-联邦扩容（Federation）"><a href="#2-4-2-联邦扩容（Federation）" class="headerlink" title="2.4.2 联邦扩容（Federation）"></a>2.4.2 联邦扩容（Federation）</h4><p><strong>基本原理</strong>：</p>
<ul>
<li>通过 etcd 将多个独立的 MinIO 集群（或称为租户）组成一个逻辑上的大集群。</li>
<li>联邦提供统一的命名空间，但各租户集群在物理上和管理上是独立的。</li>
<li>etcd 负责维护存储桶到具体租户集群的映射关系。</li>
</ul>
<p><strong>联邦架构</strong>：</p>
<div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph TB
    subgraph &quot;MinIO联邦集群&quot;
        CLIENT[客户端] --&gt; |请求bucket-A| LB[&quot;统一入口&#x2F;网关&quot;]
        LB --&gt;|查询etcd| ETCD[etcd集群]
        ETCD --&gt;|bucket-A 在 Cluster1| LB
        
        LB --&gt; CLUSTER1[租户集群1]
        
        subgraph &quot;独立租户集群&quot;
            CLUSTER1
            CLUSTER2[租户集群2]
            CLUSTER3[租户集群N]
        end
        
        CLUSTER1 -- &quot;注册&#x2F;心跳&quot; --&gt; ETCD
        CLUSTER2 -- &quot;注册&#x2F;心跳&quot; --&gt; ETCD
        CLUSTER3 -- &quot;注册&#x2F;心跳&quot; --&gt; ETCD
    end
  </pre></div>

<p><strong>联邦扩容优势</strong>：</p>
<ul>
<li><strong>无限扩展</strong>：理论上可以无限连接新的租户集群，打破单集群的节点数限制。</li>
<li><strong>故障隔离</strong>：一个租户集群的故障不会影响其他集群。</li>
<li><strong>灵活性</strong>：不同租户集群可以有不同的规模和配置。</li>
</ul>
<p><strong>联邦扩容缺点</strong>：</p>
<ul>
<li><strong>引入外部依赖</strong>：需要部署和维护一个高可用的etcd集群。</li>
<li><strong>配置与管理更复杂</strong>：增加了系统的整体复杂度。</li>
</ul>
<h4 id="2-4-3-扩容方式选择建议"><a href="#2-4-3-扩容方式选择建议" class="headerlink" title="2.4.3 扩容方式选择建议"></a>2.4.3 扩容方式选择建议</h4><table>
<thead>
<tr>
<th>扩容方式</th>
<th>适用场景</th>
<th>优势</th>
<th>劣势</th>
</tr>
</thead>
<tbody><tr>
<td><strong>对等扩容</strong></td>
<td>中小型集群（&lt;32节点）</td>
<td>配置简单，无外部依赖</td>
<td>有节点数建议上限，需要重启</td>
</tr>
<tr>
<td><strong>联邦扩容</strong></td>
<td>超大规模环境，多租户场景</td>
<td>无限扩展，故障隔离</td>
<td>配置复杂，依赖etcd</td>
</tr>
</tbody></table>
<h3 id="2-5-MinIO技术澄清与问题解答"><a href="#2-5-MinIO技术澄清与问题解答" class="headerlink" title="2.5 MinIO技术澄清与问题解答"></a>2.5 MinIO技术澄清与问题解答</h3><p>基于对MinIO架构的深入理解，我们可以澄清一些常见的技术误解，并回答一些核心问题。</p>
<h4 id="重要技术澄清"><a href="#重要技术澄清" class="headerlink" title="重要技术澄清"></a>重要技术澄清</h4><ul>
<li><strong>MinIO不使用传统的一致性哈希环</strong>: 它使用基于对象名称的确定性哈希算法，这与需要维护哈希环状态的系统有本质区别。</li>
<li><strong>MinIO的Quorum机制基于纠删码</strong>: 其读写Quorum由Reed-Solomon算法的数学特性（K&#x2F;M值）决定，而非传统的基于多数派投票的Quorum。</li>
<li><strong>MinIO的元数据管理是自描述和分布式的</strong>: 对象元数据随对象本身存储和保护，不存在集中式的元数据瓶颈。</li>
</ul>
<h4 id="核心技术问题解答"><a href="#核心技术问题解答" class="headerlink" title="核心技术问题解答"></a>核心技术问题解答</h4><h5 id="问题1：MinIO读写文件会并行写到所有节点吗？"><a href="#问题1：MinIO读写文件会并行写到所有节点吗？" class="headerlink" title="问题1：MinIO读写文件会并行写到所有节点吗？"></a>问题1：MinIO读写文件会并行写到所有节点吗？</h5><p><strong>答案：不会，这是一个常见误解。</strong></p>
<p><strong>正确理解</strong>：</p>
<ul>
<li>MinIO只向当前对象所属的纠删码集合所包含的节点&#x2F;驱动器并行写入，而非集群中的所有节点。</li>
<li>例如，在一个100节点的集群中，如果使用8+8的纠删码配置，那么任何一个对象的读写操作都只涉及其中的16个节点&#x2F;驱动器。</li>
<li>通过确定性哈希算法，不同的对象会被智能地分配到不同的纠删码集合上，这就在宏观上实现了整个集群的负载均衡，避免了不必要的网络和IO开销。</li>
</ul>
<h5 id="问题2：分布式元数据在扩容-缩容和节点宕机时如何处理？"><a href="#问题2：分布式元数据在扩容-缩容和节点宕机时如何处理？" class="headerlink" title="问题2：分布式元数据在扩容&#x2F;缩容和节点宕机时如何处理？"></a>问题2：分布式元数据在扩容&#x2F;缩容和节点宕机时如何处理？</h5><p><strong>答案</strong>：需要区分对象元数据和配置元数据。</p>
<p>**对象元数据 (<code>xl.json</code>)**：</p>
<ul>
<li><strong>节点宕机</strong>：由于 <code>xl.json</code> 和数据分片一样，在纠删码集合的所有驱动器上都有副本，因此它的可用性和恢复机制与对象数据完全相同。只要满足读取Quorum（K个可用分片），对象及其元数据就可以被访问和恢复。</li>
<li><strong>扩容</strong>：在服务器池扩容模式下，现有对象的元数据和数据都保留在原有的服务器池中，不会发生变动。新对象及其元数据将被写入到包括新池在内的所有可用池中。</li>
</ul>
<p>**配置元数据 (<code>.minio.sys/</code>)**：</p>
<ul>
<li><strong>节点宕机</strong>：由于配置信息在所有节点间通过共识算法同步，少数节点的宕机不会影响配置的可用性。存活的节点仍然拥有完整的配置信息。</li>
<li><strong>扩容&#x2F;新节点加入</strong>：新加入的节点会自动从集群中的其他节点同步最新的配置信息，从而快速融入集群。</li>
</ul>
<p><strong>总结</strong>：MinIO的无主架构通过精巧的技术设计（确定性哈希、纠删码、自描述元数据），成功地解决了分布式系统中的经典难题，实现了高可用、高性能、易扩展的存储系统。</p>
<h2 id="3-MinIO-核心流程"><a href="#3-MinIO-核心流程" class="headerlink" title="3. MinIO 核心流程"></a>3. MinIO 核心流程</h2><h3 id="3-1-数据写入流程"><a href="#3-1-数据写入流程" class="headerlink" title="3.1 数据写入流程"></a>3.1 数据写入流程</h3><div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  sequenceDiagram
    participant C as 客户端
    participant LB as 负载均衡器
    participant M as 任一MinIO节点
    participant DSet as 驱动器纠删码集合
    
    C-&gt;&gt;LB: PUT对象请求 (携带数据)
    LB-&gt;&gt;M: 路由到任一可用节点
    M-&gt;&gt;M: 1. 根据对象名计算哈希, 确定驱动器集合
    M-&gt;&gt;M: 2. 对数据进行纠删码编码(K+M分片)
    M-&gt;&gt;DSet: 3. 并行将K+M分片写入对应驱动器
    DSet--&gt;&gt;M: 确认写入完成
    M--&gt;&gt;C: 4. 返回成功响应 (200 OK)
  </pre></div>

<h3 id="3-2-数据读取流程"><a href="#3-2-数据读取流程" class="headerlink" title="3.2 数据读取流程"></a>3.2 数据读取流程</h3><div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  sequenceDiagram
    participant C as 客户端
    participant LB as 负载均衡器
    participant M as 任一MinIO节点
    participant DSet as 驱动器纠删码集合
    
    C-&gt;&gt;LB: GET对象请求
    LB-&gt;&gt;M: 路由到任一可用节点
    M-&gt;&gt;M: 1. 根据对象名计算哈希, 确定驱动器集合
    M-&gt;&gt;DSet: 2. 并行向所有K+M个驱动器请求分片
    DSet--&gt;&gt;M: 3. 最先返回的K个分片到达
    M-&gt;&gt;M: 4. 在内存中重构原始数据
    M--&gt;&gt;C: 5. 将数据流式传输给客户端
  </pre></div>

<h3 id="3-3-故障恢复流程"><a href="#3-3-故障恢复流程" class="headerlink" title="3.3 故障恢复流程"></a>3.3 故障恢复流程</h3><div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph TD
    A[检测到驱动器故障] --&gt; B{&quot;检查冗余是否充足&quot;}
    B -- &quot;是 (剩余驱动器 &gt;&#x3D; K)&quot; --&gt; C[&quot;集群进入降级模式, 服务不中断&quot;]
    B -- &quot;否 (剩余驱动器 &lt; K)&quot; --&gt; D[&quot;部分数据不可用, 告警管理员&quot;]
    
    C --&gt; E[&quot;后台自愈(Healing)进程启动&quot;]
    E --&gt; F[扫描受影响的对象]
    F --&gt; G[&quot;对每个对象, 读取K个可用分片&quot;]
    G --&gt; H[重构丢失的分片]
    H --&gt; I[&quot;将新分片写入健康的备用驱动器&quot;]
    I --&gt; J[&quot;更新对象的元数据(xl.json)&quot;]
    J --&gt; K[&quot;所有数据恢复后, 集群恢复正常模式&quot;]
  </pre></div>

<h2 id="4-MinIO-与其他存储系统对比"><a href="#4-MinIO-与其他存储系统对比" class="headerlink" title="4. MinIO 与其他存储系统对比"></a>4. MinIO 与其他存储系统对比</h2><h3 id="4-1-对象存储-vs-文件存储-vs-块存储"><a href="#4-1-对象存储-vs-文件存储-vs-块存储" class="headerlink" title="4.1 对象存储 vs 文件存储 vs 块存储"></a>4.1 对象存储 vs 文件存储 vs 块存储</h3><h4 id="存储类型架构对比"><a href="#存储类型架构对比" class="headerlink" title="存储类型架构对比"></a>存储类型架构对比</h4><div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph TB
    subgraph &quot;对象存储 (MinIO)&quot;
        OBJ1[应用程序] --&gt; OBJ2[&quot;REST API (HTTP)&quot;]
        OBJ2 --&gt; OBJ3[对象存储引擎]
        OBJ3 --&gt; OBJ4[&quot;扁平化命名空间 + 元数据&quot;]
        OBJ4 --&gt; OBJ5[分布式存储池]
    end
    
    subgraph &quot;文件存储 (NFS&#x2F;HDFS)&quot;
        FILE1[应用程序] --&gt; FILE2[&quot;文件系统接口 (POSIX)&quot;]
        FILE2 --&gt; FILE3[层级目录树结构]
        FILE3 --&gt; FILE4[元数据服务器]
        FILE4 --&gt; FILE5[数据节点]
    end
    
    subgraph &quot;块存储 (SAN)&quot;
        BLOCK1[操作系统] --&gt; BLOCK2[&quot;文件系统 (ext4&#x2F;xfs)&quot;]
        BLOCK2 --&gt; BLOCK3[&quot;块设备接口 (SCSI&#x2F;iSCSI)&quot;]
        BLOCK3 --&gt; BLOCK4[存储控制器]
        BLOCK4 --&gt; BLOCK5[&quot;物理磁盘阵列 (RAID)&quot;]
    end
  </pre></div>

<h3 id="4-2-MinIO-vs-HDFS-详细对比"><a href="#4-2-MinIO-vs-HDFS-详细对比" class="headerlink" title="4.2 MinIO vs HDFS 详细对比"></a>4.2 MinIO vs HDFS 详细对比</h3><h4 id="4-2-1-架构差异"><a href="#4-2-1-架构差异" class="headerlink" title="4.2.1 架构差异"></a>4.2.1 架构差异</h4><table>
<thead>
<tr>
<th>对比维度</th>
<th>MinIO</th>
<th>HDFS</th>
</tr>
</thead>
<tbody><tr>
<td><strong>架构模式</strong></td>
<td>无主架构，所有节点对等</td>
<td>主从架构，NameNode + DataNode</td>
</tr>
<tr>
<td><strong>单点故障</strong></td>
<td>无单点故障</td>
<td>NameNode 是潜在单点故障 (需HA方案)</td>
</tr>
<tr>
<td><strong>数据保护</strong></td>
<td>Reed-Solomon纠删码</td>
<td>多副本机制（通常3副本）</td>
</tr>
<tr>
<td><strong>存储效率</strong></td>
<td>高 (如EC:4为75%)</td>
<td>低 (3副本为33.3%)</td>
</tr>
<tr>
<td><strong>访问接口</strong></td>
<td>S3 API (HTTP)</td>
<td>HDFS API, WebHDFS</td>
</tr>
<tr>
<td><strong>小文件处理</strong></td>
<td>较优</td>
<td>NameNode压力大，性能较差</td>
</tr>
</tbody></table>
<h4 id="4-2-2-技术实现对比"><a href="#4-2-2-技术实现对比" class="headerlink" title="4.2.2 技术实现对比"></a>4.2.2 技术实现对比</h4><div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph TB
    subgraph &quot;MinIO 架构&quot;
        M1[客户端] --&gt; M2[&quot;任意节点 (无主)&quot;]
        M2 --&gt; M3[确定性哈希计算]
        M3 --&gt; M4[纠删码分片]
        M4 --&gt; M5[纠删码集合存储]
    end
    
    subgraph &quot;HDFS 架构&quot;
        H1[客户端] --&gt; H2[&quot;NameNode (主节点)&quot;]
        H2 --&gt; H3[&quot;元数据查询&#x2F;管理&quot;]
        H1 --&gt; H4[&quot;DataNode (从节点)&quot;]
        H2 --&gt; H4[指令下发]
        H4 --&gt; H5[3副本存储]
    end
  </pre></div>

<h4 id="4-2-3-性能与可靠性对比"><a href="#4-2-3-性能与可靠性对比" class="headerlink" title="4.2.3 性能与可靠性对比"></a>4.2.3 性能与可靠性对比</h4><h5 id="读写性能"><a href="#读写性能" class="headerlink" title="读写性能"></a>读写性能</h5><ul>
<li><strong>MinIO</strong>：<ul>
<li>擅长处理混合负载，对大文件和小文件都有良好的性能表现。</li>
<li>通过智能并行读写，吞吐量可达纠删码节点组的总带宽。</li>
</ul>
</li>
<li><strong>HDFS</strong>：<ul>
<li>为大文件顺序读写优化，流式处理能力强。</li>
<li>小文件场景下，NameNode成为瓶颈，性能下降严重。</li>
</ul>
</li>
</ul>
<h5 id="故障恢复"><a href="#故障恢复" class="headerlink" title="故障恢复"></a>故障恢复</h5><ul>
<li><strong>MinIO</strong>：<ul>
<li>自动检测、自动修复（自愈）。</li>
<li>可容忍的故障数取决于纠删码配置，更灵活。</li>
<li>恢复过程对业务透明。</li>
</ul>
</li>
<li><strong>HDFS</strong>：<ul>
<li>依赖NameNode协调块的复制。</li>
<li>NameNode故障需要复杂的HA切换（如JournalNode+ZKFC）。</li>
<li>恢复过程管理相对复杂。</li>
</ul>
</li>
</ul>
<h4 id="4-2-4-使用场景对比"><a href="#4-2-4-使用场景对比" class="headerlink" title="4.2.4 使用场景对比"></a>4.2.4 使用场景对比</h4><div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph LR
    subgraph &quot;MinIO 适用场景&quot;
        MINIO1[云原生应用存储]
        MINIO2[CDN及静态资源]
        MINIO3[备份归档]
        MINIO4[AI&#x2F;ML数据湖]
        MINIO5[容器镜像仓库]
    end
    
    subgraph &quot;HDFS 适用场景&quot;
        HDFS1[&quot;海量数据批处理 (MapReduce&#x2F;Spark)&quot;]
        HDFS2[数据仓库]
        HDFS3[日志存储与分析]
        HDFS4[传统大数据生态]
    end
  </pre></div>

<h3 id="4-3-MinIO-vs-其他对象存储"><a href="#4-3-MinIO-vs-其他对象存储" class="headerlink" title="4.3 MinIO vs 其他对象存储"></a>4.3 MinIO vs 其他对象存储</h3><h4 id="4-3-1-MinIO-vs-AWS-S3"><a href="#4-3-1-MinIO-vs-AWS-S3" class="headerlink" title="4.3.1 MinIO vs AWS S3"></a>4.3.1 MinIO vs AWS S3</h4><table>
<thead>
<tr>
<th>特性</th>
<th>MinIO</th>
<th>AWS S3</th>
</tr>
</thead>
<tbody><tr>
<td><strong>部署方式</strong></td>
<td>私有云&#x2F;混合云&#x2F;边缘</td>
<td>公有云服务</td>
</tr>
<tr>
<td><strong>API兼容性</strong></td>
<td>100% S3兼容</td>
<td>原生S3 API标准</td>
</tr>
<tr>
<td><strong>成本</strong></td>
<td>硬件+运维成本，可控</td>
<td>按使用量付费，易超支</td>
</tr>
<tr>
<td><strong>数据主权</strong></td>
<td>完全自主控制</td>
<td>依赖云服务商政策</td>
</tr>
<tr>
<td><strong>性能</strong></td>
<td>取决于硬件，可极致优化</td>
<td>服务等级限制，有吞吐量上限</td>
</tr>
<tr>
<td><strong>定制化</strong></td>
<td>高度可定制</td>
<td>黑盒，不可定制</td>
</tr>
</tbody></table>
<h4 id="4-3-2-MinIO-vs-Ceph"><a href="#4-3-2-MinIO-vs-Ceph" class="headerlink" title="4.3.2 MinIO vs Ceph"></a>4.3.2 MinIO vs Ceph</h4><table>
<thead>
<tr>
<th>对比项</th>
<th>MinIO</th>
<th>Ceph</th>
</tr>
</thead>
<tbody><tr>
<td><strong>设计哲学</strong></td>
<td>简洁、高性能</td>
<td>统一、功能全面</td>
</tr>
<tr>
<td><strong>存储类型</strong></td>
<td>纯对象存储</td>
<td>统一存储（对象+块+文件）</td>
</tr>
<tr>
<td><strong>复杂度</strong></td>
<td>非常简单，易于部署和运维</td>
<td>非常复杂，学习曲线陡峭</td>
</tr>
<tr>
<td><strong>性能</strong></td>
<td>对象存储场景下性能极致</td>
<td>通用性强，但为对象存储的调优复杂</td>
</tr>
<tr>
<td><strong>资源占用</strong></td>
<td>轻量级</td>
<td>重量级</td>
</tr>
<tr>
<td><strong>适用场景</strong></td>
<td>需要高性能、易于管理的对象存储</td>
<td>需要统一存储平台，有强大运维团队</td>
</tr>
</tbody></table>
<h3 id="4-4-选型决策框架"><a href="#4-4-选型决策框架" class="headerlink" title="4.4 选型决策框架"></a>4.4 选型决策框架</h3><h4 id="4-4-1-技术选型矩阵"><a href="#4-4-1-技术选型矩阵" class="headerlink" title="4.4.1 技术选型矩阵"></a>4.4.1 技术选型矩阵</h4><div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph TD
    A[存储需求分析] --&gt; B{&quot;主要数据访问模式?&quot;}
    B -- &quot;HTTP&#x2F;S3 API&quot; --&gt; C[选择对象存储]
    B -- &quot;文件&#x2F;POSIX API&quot; --&gt; D[选择文件存储]
    B -- &quot;iSCSI&#x2F;块设备&quot; --&gt; E[选择块存储]
    
    C --&gt; F{&quot;部署环境?&quot;}
    F -- &quot;私有云&#x2F;混合云&quot; --&gt; G{&quot;运维复杂度要求?&quot;}
    F -- &quot;公有云&quot; --&gt; H[&quot;AWS S3&#x2F;阿里云OSS等&quot;]
    
    G -- &quot;追求简洁、高性能&quot; --&gt; I[MinIO]
    G -- &quot;需要统一存储平台&quot; --&gt; J[Ceph]
    
    D --&gt; K{&quot;主要应用场景?&quot;}
    K -- &quot;大数据分析&quot; --&gt; L[HDFS]
    K -- &quot;通用文件共享&quot; --&gt; M[&quot;NFS&#x2F;GlusterFS&quot;]
    
    E --&gt; N[&quot;SAN&#x2F;iSCSI&#x2F;Ceph RBD&quot;]
  </pre></div>

<h4 id="4-4-2-决策要素权重"><a href="#4-4-2-决策要素权重" class="headerlink" title="4.4.2 决策要素权重"></a>4.4.2 决策要素权重</h4><table>
<thead>
<tr>
<th>要素</th>
<th align="center">MinIO</th>
<th align="center">HDFS</th>
<th align="center">Ceph</th>
</tr>
</thead>
<tbody><tr>
<td><strong>易用性</strong></td>
<td align="center">⭐⭐⭐⭐⭐</td>
<td align="center">⭐⭐⭐</td>
<td align="center">⭐⭐</td>
</tr>
<tr>
<td><strong>对象存储性能</strong></td>
<td align="center">⭐⭐⭐⭐⭐</td>
<td align="center">⭐⭐</td>
<td align="center">⭐⭐⭐⭐</td>
</tr>
<tr>
<td><strong>可靠性</strong></td>
<td align="center">⭐⭐⭐⭐⭐</td>
<td align="center">⭐⭐⭐⭐</td>
<td align="center">⭐⭐⭐⭐</td>
</tr>
<tr>
<td><strong>扩展性</strong></td>
<td align="center">⭐⭐⭐⭐⭐</td>
<td align="center">⭐⭐⭐⭐</td>
<td align="center">⭐⭐⭐⭐⭐</td>
</tr>
<tr>
<td><strong>运维成本</strong></td>
<td align="center">⭐⭐⭐⭐⭐</td>
<td align="center">⭐⭐⭐</td>
<td align="center">⭐⭐</td>
</tr>
<tr>
<td><strong>功能全面性</strong></td>
<td align="center">⭐⭐⭐</td>
<td align="center">⭐⭐⭐</td>
<td align="center">⭐⭐⭐⭐⭐</td>
</tr>
</tbody></table>
<h3 id="4-5-实际应用案例分析"><a href="#4-5-实际应用案例分析" class="headerlink" title="4.5 实际应用案例分析"></a>4.5 实际应用案例分析</h3><h4 id="4-5-1-电商平台存储架构"><a href="#4-5-1-电商平台存储架构" class="headerlink" title="4.5.1 电商平台存储架构"></a>4.5.1 电商平台存储架构</h4><div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph TB
    subgraph &quot;电商平台存储层次&quot;
        APP[电商应用] --&gt; CDN[CDN缓存层]
        CDN --&gt; HOT[&quot;热数据层(商品图片&#x2F;视频) - MinIO&quot;]
        HOT --&gt; WARM[&quot;温数据层(历史订单快照) - MinIO&quot;]
        WARM --&gt; COLD[&quot;冷数据层(归档日志) - 磁带&#x2F;云归档存储&quot;]
        
        DB[数据库] --&gt; BACKUP[&quot;数据库备份 - MinIO&quot;]
        LOG[业务日志系统] --&gt; LOG_ANALYZE[&quot;日志分析平台 - HDFS&#x2F;ClickHouse&quot;]
    end
  </pre></div>

<h4 id="4-5-2-AI-ML平台存储设计"><a href="#4-5-2-AI-ML平台存储设计" class="headerlink" title="4.5.2 AI&#x2F;ML平台存储设计"></a>4.5.2 AI&#x2F;ML平台存储设计</h4><div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph LR
    subgraph &quot;AI&#x2F;ML数据流&quot;
        RAW[原始数据采集] --&gt; MINIO1[&quot;MinIO - 数据湖(统一存储)&quot;]
        MINIO1 --&gt;|数据预处理| SPARK[&quot;Spark&#x2F;Dask&quot;]
        SPARK --&gt; TRAIN_SET[&quot;训练&#x2F;验证数据集&quot;]
        TRAIN_SET --&gt; MINIO1
        
        MINIO1 --&gt;|读取训练数据| TRAIN[&quot;模型训练集群 (GPU)&quot;]
        TRAIN --&gt; MINIO2[&quot;MinIO - 模型仓库&quot;]
        MINIO2 --&gt; DEPLOY[&quot;模型部署&#x2F;推理服务&quot;]
    end
  </pre></div>

<h2 id="5-MinIO-命令使用指南"><a href="#5-MinIO-命令使用指南" class="headerlink" title="5. MinIO 命令使用指南"></a>5. MinIO 命令使用指南</h2><h3 id="5-1-安装和部署"><a href="#5-1-安装和部署" class="headerlink" title="5.1 安装和部署"></a>5.1 安装和部署</h3><h4 id="单机部署"><a href="#单机部署" class="headerlink" title="单机部署"></a>单机部署</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载 MinIO 服务器</span></span><br><span class="line">wget https://dl.min.io/server/minio/release/linux-amd64/minio</span><br><span class="line"><span class="built_in">chmod</span> +x minio</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动 MinIO 服务器</span></span><br><span class="line"><span class="comment"># MINIO_ROOT_USER 和 MINIO_ROOT_PASSWORD 是启动所必需的环境变量</span></span><br><span class="line"><span class="built_in">export</span> MINIO_ROOT_USER=minioadmin</span><br><span class="line"><span class="built_in">export</span> MINIO_ROOT_PASSWORD=minioadmin</span><br><span class="line">./minio server /data --console-address <span class="string">&quot;:9001&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="集群部署-示例"><a href="#集群部署-示例" class="headerlink" title="集群部署 (示例)"></a>集群部署 (示例)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在4个节点上分别设置环境变量和启动命令</span></span><br><span class="line"><span class="comment"># 假设节点IP为 192.168.1.101 到 192.168.1.104</span></span><br><span class="line"><span class="comment"># 在所有节点上执行:</span></span><br><span class="line"><span class="built_in">export</span> MINIO_ROOT_USER=myminioadmin</span><br><span class="line"><span class="built_in">export</span> MINIO_ROOT_PASSWORD=minioadmin_secret</span><br><span class="line">minio server http://192.168.1.10&#123;1...4&#125;/data&#123;1...4&#125; --console-address <span class="string">&quot;:9001&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-MinIO-Client-mc-命令"><a href="#5-2-MinIO-Client-mc-命令" class="headerlink" title="5.2 MinIO Client (mc) 命令"></a>5.2 MinIO Client (mc) 命令</h3><h4 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 mc 客户端</span></span><br><span class="line">wget https://dl.min.io/client/mc/release/linux-amd64/mc</span><br><span class="line"><span class="built_in">chmod</span> +x mc</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">mv</span> mc /usr/local/bin/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加 MinIO 服务器别名</span></span><br><span class="line">mc <span class="built_in">alias</span> <span class="built_in">set</span> myminio http://localhost:9000 minioadmin minioadmin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出所有别名</span></span><br><span class="line">mc <span class="built_in">alias</span> list</span><br></pre></td></tr></table></figure>

<h4 id="Bucket-操作"><a href="#Bucket-操作" class="headerlink" title="Bucket 操作"></a>Bucket 操作</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建 bucket</span></span><br><span class="line">mc mb myminio/mybucket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出所有 buckets</span></span><br><span class="line">mc <span class="built_in">ls</span> myminio</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除 bucket（必须为空）</span></span><br><span class="line">mc rb myminio/mybucket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 强制删除非空 bucket</span></span><br><span class="line">mc rb myminio/mybucket --force</span><br></pre></td></tr></table></figure>

<h4 id="对象操作"><a href="#对象操作" class="headerlink" title="对象操作"></a>对象操作</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 上传文件</span></span><br><span class="line">mc <span class="built_in">cp</span> localfile.txt myminio/mybucket/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 上传目录</span></span><br><span class="line">mc <span class="built_in">cp</span> --recursive localdir/ myminio/mybucket/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载文件</span></span><br><span class="line">mc <span class="built_in">cp</span> myminio/mybucket/file.txt .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载目录</span></span><br><span class="line">mc <span class="built_in">cp</span> --recursive myminio/mybucket/dir/ .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出对象</span></span><br><span class="line">mc <span class="built_in">ls</span> myminio/mybucket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 递归列出所有对象</span></span><br><span class="line">mc <span class="built_in">ls</span> --recursive myminio/mybucket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除对象</span></span><br><span class="line">mc <span class="built_in">rm</span> myminio/mybucket/file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 批量删除</span></span><br><span class="line">mc <span class="built_in">rm</span> --recursive --force myminio/mybucket/dir/</span><br></pre></td></tr></table></figure>

<h4 id="同步操作"><a href="#同步操作" class="headerlink" title="同步操作"></a>同步操作</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将本地目录的更改同步到 MinIO</span></span><br><span class="line">mc mirror localdir/ myminio/mybucket/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 MinIO 目录的更改同步到本地</span></span><br><span class="line">mc mirror myminio/mybucket/ localdir/</span><br></pre></td></tr></table></figure>

<h3 id="5-3-权限和策略管理"><a href="#5-3-权限和策略管理" class="headerlink" title="5.3 权限和策略管理"></a>5.3 权限和策略管理</h3><h4 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建用户</span></span><br><span class="line">mc admin user add myminio newuser password123</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出用户</span></span><br><span class="line">mc admin user list myminio</span><br><span class="line"></span><br><span class="line"><span class="comment"># 禁用用户</span></span><br><span class="line">mc admin user <span class="built_in">disable</span> myminio newuser</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启用用户</span></span><br><span class="line">mc admin user <span class="built_in">enable</span> myminio newuser</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除用户</span></span><br><span class="line">mc admin user remove myminio newuser</span><br></pre></td></tr></table></figure>

<h4 id="策略管理"><a href="#策略管理" class="headerlink" title="策略管理"></a>策略管理</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出内置策略</span></span><br><span class="line">mc admin policy list myminio</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建自定义策略文件</span></span><br><span class="line"><span class="built_in">cat</span> &gt; readonly-policy.json &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  &quot;Version&quot;: &quot;2012-10-17&quot;,</span></span><br><span class="line"><span class="string">  &quot;Statement&quot;: [</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">      &quot;Effect&quot;: &quot;Allow&quot;,</span></span><br><span class="line"><span class="string">      &quot;Action&quot;: [&quot;s3:GetObject&quot;],</span></span><br><span class="line"><span class="string">      &quot;Resource&quot;: [&quot;arn:aws:s3:::mybucket/*&quot;]</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  ]</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加策略</span></span><br><span class="line">mc admin policy add myminio readonly-policy readonly-policy.json</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将策略分配给用户</span></span><br><span class="line">mc admin policy <span class="built_in">set</span> myminio readonly-policy user=newuser</span><br></pre></td></tr></table></figure>

<h4 id="组管理"><a href="#组管理" class="headerlink" title="组管理"></a>组管理</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建组</span></span><br><span class="line">mc admin group add myminio mygroup newuser</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出组</span></span><br><span class="line">mc admin group list myminio</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将策略分配给组</span></span><br><span class="line">mc admin policy <span class="built_in">set</span> myminio readwrite group=mygroup</span><br></pre></td></tr></table></figure>

<h3 id="5-4-监控和管理"><a href="#5-4-监控和管理" class="headerlink" title="5.4 监控和管理"></a>5.4 监控和管理</h3><h4 id="服务器信息"><a href="#服务器信息" class="headerlink" title="服务器信息"></a>服务器信息</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看服务器信息 (包含存储、版本、运行时间等)</span></span><br><span class="line">mc admin info myminio</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启服务</span></span><br><span class="line">mc admin service restart myminio</span><br></pre></td></tr></table></figure>

<h4 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 运行 S3 基准性能测试</span></span><br><span class="line">mc admin speedtest myminio</span><br></pre></td></tr></table></figure>

<h4 id="日志管理"><a href="#日志管理" class="headerlink" title="日志管理"></a>日志管理</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看服务器日志</span></span><br><span class="line">mc admin logs myminio</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看审计日志</span></span><br><span class="line">mc admin logs myminio --<span class="built_in">type</span> audit --follow</span><br></pre></td></tr></table></figure>

<h3 id="5-5-高级功能"><a href="#5-5-高级功能" class="headerlink" title="5.5 高级功能"></a>5.5 高级功能</h3><h4 id="版本控制"><a href="#版本控制" class="headerlink" title="版本控制"></a>版本控制</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启用版本控制</span></span><br><span class="line">mc version <span class="built_in">enable</span> myminio/mybucket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看版本控制状态</span></span><br><span class="line">mc version info myminio/mybucket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出对象所有版本</span></span><br><span class="line">mc <span class="built_in">ls</span> --versions myminio/mybucket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除特定版本</span></span><br><span class="line">mc <span class="built_in">rm</span> --vid <span class="string">&quot;version-id&quot;</span> myminio/mybucket/file.txt</span><br></pre></td></tr></table></figure>

<h4 id="生命周期管理-ILM"><a href="#生命周期管理-ILM" class="headerlink" title="生命周期管理 (ILM)"></a>生命周期管理 (ILM)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建生命周期规则 (30天后过期对象)</span></span><br><span class="line"><span class="built_in">cat</span> &gt; lifecycle.json &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  &quot;Rules&quot;: [</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">      &quot;ID&quot;: &quot;ExpireAfter30Days&quot;,</span></span><br><span class="line"><span class="string">      &quot;Status&quot;: &quot;Enabled&quot;,</span></span><br><span class="line"><span class="string">      &quot;Filter&quot;: &#123; &quot;Prefix&quot;: &quot;&quot; &#125;,</span></span><br><span class="line"><span class="string">      &quot;Expiration&quot;: &#123; &quot;Days&quot;: 30 &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  ]</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 应用生命周期规则</span></span><br><span class="line">mc ilm import myminio/mybucket &lt; lifecycle.json</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看生命周期规则</span></span><br><span class="line">mc ilm <span class="built_in">ls</span> myminio/mybucket</span><br></pre></td></tr></table></figure>

<h4 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启用服务器端加密 (SSE-S3)</span></span><br><span class="line">mc encrypt <span class="built_in">set</span> sse-s3 myminio/mybucket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看加密状态</span></span><br><span class="line">mc encrypt info myminio/mybucket</span><br></pre></td></tr></table></figure>

<h3 id="5-6-联邦扩容配置"><a href="#5-6-联邦扩容配置" class="headerlink" title="5.6 联邦扩容配置"></a>5.6 联邦扩容配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 启动 etcd 集群 (示例)</span></span><br><span class="line"><span class="comment"># 节点1:</span></span><br><span class="line">etcd --name etcd-1 --initial-advertise-peer-urls http://192.168.1.107:2380 \</span><br><span class="line">  --listen-peer-urls http://192.168.1.107:2380 \</span><br><span class="line">  --listen-client-urls http://192.168.1.107:2379,http://127.0.0.1:2379 \</span><br><span class="line">  --advertise-client-urls http://192.168.1.107:2379 \</span><br><span class="line">  --initial-cluster-token etcd-cluster-1 \</span><br><span class="line">  --initial-cluster etcd-1=http://192.168.1.107:2380,etcd-2=http://192.168.1.108:2380 \</span><br><span class="line">  --initial-cluster-state new</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 配置并启动 MinIO 租户集群</span></span><br><span class="line"><span class="comment"># 在所有 MinIO 节点上设置环境变量</span></span><br><span class="line"><span class="built_in">export</span> MINIO_ETCD_ENDPOINTS=<span class="string">&quot;http://192.168.1.107:2379,http://192.168.1.108:2379&quot;</span></span><br><span class="line"><span class="built_in">export</span> MINIO_PUBLIC_IPS=<span class="string">&quot;192.168.1.103,192.168.1.104&quot;</span> <span class="comment"># 租户集群的公共IP</span></span><br><span class="line"><span class="built_in">export</span> MINIO_DOMAIN=minio.example.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动集群1 (租户1)</span></span><br><span class="line">minio server http://192.168.1.&#123;103...104&#125;/data&#123;1...2&#125; --console-address <span class="string">&quot;:9001&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-7-故障排除命令"><a href="#5-7-故障排除命令" class="headerlink" title="5.7 故障排除命令"></a>5.7 故障排除命令</h3><h4 id="健康检查"><a href="#健康检查" class="headerlink" title="健康检查"></a>健康检查</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查集群健康状况并修复</span></span><br><span class="line">mc admin heal myminio</span><br><span class="line"></span><br><span class="line"><span class="comment"># 递归地检查所有对象</span></span><br><span class="line">mc admin heal --recursive myminio/mybucket</span><br></pre></td></tr></table></figure>

<h4 id="配置管理"><a href="#配置管理" class="headerlink" title="配置管理"></a>配置管理</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前配置</span></span><br><span class="line">mc admin config get myminio</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置配置 (例如，区域)</span></span><br><span class="line">mc admin config <span class="built_in">set</span> myminio region name=us-east-1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重置配置为默认值</span></span><br><span class="line">mc admin config reset myminio</span><br></pre></td></tr></table></figure>

<h2 id="6-最佳实践"><a href="#6-最佳实践" class="headerlink" title="6. 最佳实践"></a>6. 最佳实践</h2><h3 id="6-1-部署建议"><a href="#6-1-部署建议" class="headerlink" title="6.1 部署建议"></a>6.1 部署建议</h3><h4 id="6-1-1-硬件配置建议"><a href="#6-1-1-硬件配置建议" class="headerlink" title="6.1.1 硬件配置建议"></a>6.1.1 硬件配置建议</h4><ul>
<li><strong>存储设备</strong>：强烈推荐使用同质化的 NVMe SSD，以避免慢盘效应。使用JBOD（Just a Bunch of Disks）模式，避免使用硬件RAID。</li>
<li><strong>网络带宽</strong>：为发挥极致性能，建议节点间使用 25Gbps 到 100Gbps 的高速网络。</li>
<li><strong>CPU要求</strong>：为最大化纠删码性能，推荐使用支持 Intel AVX512 指令集的CPU。</li>
<li><strong>内存配置</strong>：内存使用与并发请求数和纠删码配置相关。官方建议，对于100TB以下的小规模部署，每节点至少配置32GB内存。对于更大规模的部署，应根据监控的实际内存使用情况进行规划，以支持高并发连接和元数据缓存。</li>
</ul>
<h4 id="6-1-2-集群规划建议"><a href="#6-1-2-集群规划建议" class="headerlink" title="6.1.2 集群规划建议"></a>6.1.2 集群规划建议</h4><ul>
<li><strong>纠删码集合大小</strong>：每个纠删码集合（Erasure Set）的驱动器数量建议为4到16块。</li>
<li><strong>节点数量限制</strong>：对于单个MinIO集群，为保证通信效率和一致性，建议节点数不要超过32个。更大规模请使用联邦模式。</li>
<li><strong>可用区部署</strong>：为实现高可用性，应将节点和驱动器分布在不同的物理机架、数据中心可用区中。</li>
<li><strong>DNS轮询</strong>：配置DNS轮询或使用负载均衡器将客户端请求分发到所有MinIO节点。</li>
</ul>
<h4 id="6-1-3-连续IP规划"><a href="#6-1-3-连续IP规划" class="headerlink" title="6.1.3 连续IP规划"></a>6.1.3 连续IP规划</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 推荐使用连续的节点IP和相似的目录结构，便于模板化配置和管理</span></span><br><span class="line">minio server http://192.168.1.&#123;10...13&#125;/data&#123;1...4&#125; --console-address <span class="string">&quot;:9001&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 而非分散的IP和不规则的目录</span></span><br><span class="line"><span class="comment"># minio server http://192.168.1.10/disk_a http://192.168.2.20/drive_1 ...</span></span><br></pre></td></tr></table></figure>

<h3 id="6-2-性能优化"><a href="#6-2-性能优化" class="headerlink" title="6.2 性能优化"></a>6.2 性能优化</h3><h4 id="6-2-1-纠删码配置优化"><a href="#6-2-1-纠删码配置优化" class="headerlink" title="6.2.1 纠删码配置优化"></a>6.2.1 纠删码配置优化</h4><ul>
<li><strong>可靠性与效率的平衡</strong>：根据业务对数据可靠性的要求和成本预算，选择合适的纠删码配置。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># EC:4 (例如 12+4) - 存储效率 75%，可容忍4个驱动器故障，是性能和可靠性的良好平衡点。</span></span><br><span class="line"><span class="comment"># EC:8 (例如 8+8) - 存储效率 50%，可容忍8个驱动器故障，提供极高的可靠性，但成本较高。</span></span><br></pre></td></tr></table></figure></li>
<li><strong>默认配置推荐</strong>：对于大多数场景，MinIO自动选择的默认纠删码配置（通常是EC:4）是一个很好的起点。</li>
</ul>
<h4 id="6-2-2-硬件性能优化"><a href="#6-2-2-硬件性能优化" class="headerlink" title="6.2.2 硬件性能优化"></a>6.2.2 硬件性能优化</h4><ul>
<li><strong>启用AVX512</strong>：确保CPU支持并启用了AVX512指令集。</li>
<li><strong>使用NVMe SSD</strong>：充分利用其高IOPS和低延迟特性。</li>
<li><strong>避免RAID</strong>：硬件RAID会与MinIO自身的纠删码和数据保护机制冲突，并引入性能瓶颈。</li>
</ul>
<h4 id="6-2-3-网络优化"><a href="#6-2-3-网络优化" class="headerlink" title="6.2.3 网络优化"></a>6.2.3 网络优化</h4><ul>
<li><strong>高速网络</strong>：使用25&#x2F;100Gbps网络以支持线速读写。</li>
<li><strong>负载均衡策略</strong>：使用支持最小连接数或轮询的负载均衡策略。</li>
<li><strong>网络拓扑</strong>：设计扁平化的网络拓扑，最小化节点间的网络跳数和延迟。</li>
</ul>
<h4 id="6-2-4-关键监控指标"><a href="#6-2-4-关键监控指标" class="headerlink" title="6.2.4 关键监控指标"></a>6.2.4 关键监控指标</h4><ul>
<li>**吞吐量 (Throughput)**：监控集群的读&#x2F;写吞吐量是否符合预期。</li>
<li>**延迟 (Latency)**：监控S3 API请求的平均和P99延迟。</li>
<li><strong>驱动器健康</strong>：监控驱动器的SMART数据、IO等待时间、错误率等。</li>
<li><strong>纠删码状态</strong>：监控是否有降级的纠删码集合，以及数据重建（Healing）的进度和速度。</li>
</ul>
<h3 id="6-3-安全建议"><a href="#6-3-安全建议" class="headerlink" title="6.3 安全建议"></a>6.3 安全建议</h3><ul>
<li><strong>启用TLS</strong>：为所有API和控制台流量强制启用TLS加密传输。</li>
<li><strong>使用IAM</strong>：实施最小权限原则，为不同应用创建专用的用户和策略。</li>
<li><strong>密钥管理</strong>：定期轮换访问密钥和密钥加密密钥（KEK）。</li>
<li><strong>审计日志</strong>：启用并定期审计访问日志，监控异常行为。</li>
</ul>
<h3 id="6-4-监控和维护"><a href="#6-4-监控和维护" class="headerlink" title="6.4 监控和维护"></a>6.4 监控和维护</h3><ul>
<li><strong>Prometheus集成</strong>：利用MinIO内置的Prometheus端点，进行全面的监控和告警。</li>
<li><strong>定期健康检查</strong>：定期运行 <code>mc admin heal</code> 检查数据完整性。</li>
<li><strong>容量规划</strong>：监控磁盘使用率，并根据增长趋势制定扩容计划。</li>
<li><strong>灾难恢复演练</strong>：定期进行灾备演练，确保备份和恢复流程有效。</li>
</ul>
<h2 id="7-总结"><a href="#7-总结" class="headerlink" title="7. 总结"></a>7. 总结</h2><h3 id="7-1-MinIO-核心优势总览"><a href="#7-1-MinIO-核心优势总览" class="headerlink" title="7.1 MinIO 核心优势总览"></a>7.1 MinIO 核心优势总览</h3><div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  graph TB
    subgraph &quot;MinIO 核心优势&quot;
        A[MinIO对象存储] --&gt; B[简洁高性能]
        A --&gt; C[云原生设计]
        A --&gt; D[S3兼容性]
        A --&gt; E[企业级特性]
        
        B --&gt; B1[无主架构]
        B --&gt; B2[纠删码优化]
        B --&gt; B3[AVX512加速]
        
        C --&gt; C1[轻量级容器化]
        C --&gt; C2[易于自动化运维]
        C --&gt; C3[水平扩展]
        
        D --&gt; D1[事实标准API]
        D --&gt; D2[庞大的生态系统]
        D --&gt; D3[无缝迁移]
        
        E --&gt; E1[加密与安全]
        E --&gt; E2[生命周期管理]
        E --&gt; E3[多租户与联邦]
    end
  </pre></div>

<h3 id="7-2-技术特色总结"><a href="#7-2-技术特色总结" class="headerlink" title="7.2 技术特色总结"></a>7.2 技术特色总结</h3><p>MinIO 通过以下关键技术实现了其独特的优势：</p>
<ul>
<li><strong>架构创新</strong>：<ul>
<li><strong>无主设计</strong>：采用确定性哈希算法和纠删码集合，从根本上消除了单点故障和性能瓶颈。</li>
<li><strong>Reed-Solomon纠删码</strong>：提供比传统副本更高的存储效率和更灵活的容错能力。</li>
<li><strong>自描述元数据</strong>：<code>xl.json</code>随对象存储，确保数据的完整性、可移植性和恢复的简便性。</li>
</ul>
</li>
<li><strong>性能优化</strong>：<ul>
<li><strong>SIMD加速</strong>：利用AVX512&#x2F;NEON等指令集，将纠删码计算的CPU开销降至最低。</li>
<li><strong>智能并行处理</strong>：读写操作仅限于纠删码集合内的节点，精准并行，避免了不必要的网络风暴。</li>
</ul>
</li>
<li><strong>运维友好</strong>：<ul>
<li><strong>极简设计</strong>：单个二进制文件，无复杂依赖，配置简单。</li>
<li><strong>自动修复</strong>：内置数据完整性检查和自愈机制，大大降低了运维负担。</li>
</ul>
</li>
</ul>
<h3 id="7-3-适用场景总结"><a href="#7-3-适用场景总结" class="headerlink" title="7.3 适用场景总结"></a>7.3 适用场景总结</h3><p>MinIO 在以下场景中表现尤为出色：</p>
<ul>
<li><strong>云原生应用存储</strong>：作为Kubernetes等容器化环境的持久化存储后端。</li>
<li><strong>数据湖与AI&#x2F;ML</strong>：为Spark、Presto、TensorFlow等框架提供高性能、可扩展的统一存储层。</li>
<li><strong>备份与归档</strong>：为数据库、虚拟机、应用日志提供高性价比、高可靠的数据保护方案。</li>
<li><strong>CDN与媒体服务</strong>：作为静态资源（图片、视频）的源站，满足高并发访问需求。</li>
</ul>
<h3 id="7-4-总体评价"><a href="#7-4-总体评价" class="headerlink" title="7.4 总体评价"></a>7.4 总体评价</h3><p>MinIO 是一个功能强大、性能卓越且设计简洁的对象存储解决方案。它通过对分布式系统核心问题的深刻理解和创新性的工程实现，成功地在性能、可靠性、可扩展性和易用性之间取得了卓越的平衡。</p>
<p>对于寻求在私有云、混合云或边缘环境中部署S3兼容存储的组织而言，MinIO无疑是当前市场上最具竞争力的选择之一。</p>
<h3 id="7-5-最佳实践建议"><a href="#7-5-最佳实践建议" class="headerlink" title="7.5 最佳实践建议"></a>7.5 最佳实践建议</h3><h4 id="分阶段部署策略"><a href="#分阶段部署策略" class="headerlink" title="分阶段部署策略"></a>分阶段部署策略</h4><ol>
<li><strong>规划阶段</strong>：<ul>
<li>根据业务需求选择合适的纠删码配置（EC:4是良好起点）。</li>
<li>规划集群节点和驱动器数量，确保它们均匀分布在不同故障域。</li>
<li>设计长远的扩容策略（对等扩容 vs 联邦扩容）。</li>
</ul>
</li>
<li><strong>部署阶段</strong>：<ul>
<li>确保硬件和网络配置满足性能要求（高速网络 + NVMe SSD）。</li>
<li>使用自动化工具（如Ansible, Terraform）进行声明式部署和配置管理。</li>
<li>配置DNS轮询或负载均衡器。</li>
</ul>
</li>
<li><strong>运维阶段</strong>：<ul>
<li>集成Prometheus和Grafana，建立完善的监控和告警体系。</li>
<li>定期执行 <code>mc admin heal</code> 进行数据巡检。</li>
<li>定期进行安全审计和密钥轮换。</li>
</ul>
</li>
<li><strong>优化阶段</strong>：<ul>
<li>根据监控数据，持续调优系统参数。</li>
<li>根据业务增长，执行预先规划的扩容策略。</li>
</ul>
</li>
</ol>
<h4 id="关键技术要点"><a href="#关键技术要点" class="headerlink" title="关键技术要点"></a>关键技术要点</h4><ul>
<li><strong>理解纠删码</strong>：深入理解纠删码的K、M值对可靠性和存储效率的影响。</li>
<li><strong>理解元数据</strong>：清晰区分对象元数据和配置元数据的不同管理方式。</li>
<li><strong>善用硬件特性</strong>：充分利用AVX512、NVMe、高速网络等硬件特性来释放MinIO的全部潜力。</li>
</ul>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">XR</div><div class="post-copyright__author_desc">一片叶、一朵云</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2025/06/16/minio-learning-guide/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2025/06/16/minio-learning-guide/')">MinIO 学习指南</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231130275.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231130275.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231143327.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231143327.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2025/06/16/minio-learning-guide/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=MinIO 学习指南&amp;url=http://example.com/2025/06/16/minio-learning-guide/&amp;pic=https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/09c33b5dbe1bd3fec63ad2e4128b55b6.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">凌霄的博客</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/MinIO/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>MinIO<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>对象存储<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>分布式存储<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/S3%E5%85%BC%E5%AE%B9/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>S3兼容<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/20250624000019253.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/06/16/CRC-32%E6%8A%80%E6%9C%AF%E8%AF%A6%E8%A7%A3%EF%BC%9A%E4%BB%8E%E5%8E%9F%E7%90%86%E5%88%B0HDFS%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/20250607203155245.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">CRC-32技术详解：从原理到HDFS应用实践</div></div></a></div><div class="next-post pull-right"><a href="/2025/06/17/Spring%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96%E4%B8%8EAOP/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/20250618094256140.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Spring AOP 与循环依赖：揭秘提前暴露代理的底层原理</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2025/06/25/HDFS%E6%8A%80%E6%9C%AF%E8%AF%A6%E8%A7%A3%EF%BC%9A%E6%9E%B6%E6%9E%84%E3%80%81%E5%AD%98%E5%82%A8%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/" title="HDFS技术详解：架构、存储与数据安全机制"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/20250618094256140.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-06-25</div><div class="title">HDFS技术详解：架构、存储与数据安全机制</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">XR</h1><div class="author-info__desc">一片叶、一朵云</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/kongxiaoran" target="_blank" title="Github"></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MinIO-%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97"><span class="toc-number">1.</span> <span class="toc-text">MinIO 学习指南</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E6%A1%A3%E7%BB%93%E6%9E%84"><span class="toc-number">1.2.</span> <span class="toc-text">文档结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-MinIO-%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="toc-number">1.3.</span> <span class="toc-text">1. MinIO 核心概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.3.1.</span> <span class="toc-text">1.1 基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Object%EF%BC%88%E5%AF%B9%E8%B1%A1%EF%BC%89"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">Object（对象）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Bucket%EF%BC%88%E5%AD%98%E5%82%A8%E6%A1%B6%EF%BC%89"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">Bucket（存储桶）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Key%EF%BC%88%E9%94%AE%EF%BC%89"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">Key（键）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Node%EF%BC%88%E8%8A%82%E7%82%B9%EF%BC%89"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">Node（节点）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Drive%EF%BC%88%E9%A9%B1%E5%8A%A8%E5%99%A8%EF%BC%89"><span class="toc-number">1.3.1.5.</span> <span class="toc-text">Drive（驱动器）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E9%AB%98%E7%BA%A7%E6%A6%82%E5%BF%B5"><span class="toc-number">1.3.2.</span> <span class="toc-text">1.2 高级概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Erasure-Coding%EF%BC%88%E7%BA%A0%E5%88%A0%E7%A0%81%EF%BC%89"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">Erasure Coding（纠删码）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Tenant%EF%BC%88%E7%A7%9F%E6%88%B7%EF%BC%89"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">Tenant（租户）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-MinIO-%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84"><span class="toc-number">1.4.</span> <span class="toc-text">2. MinIO 整体架构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E5%9B%BE"><span class="toc-number">1.4.1.</span> <span class="toc-text">2.1 系统架构图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%9E%B6%E6%9E%84%E7%89%B9%E7%82%B9"><span class="toc-number">1.4.2.</span> <span class="toc-text">2.2 架构特点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-S3%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">2.2.1 S3兼容性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-%E6%97%A0%E4%B8%BB%E6%9E%B6%E6%9E%84"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">2.2.2 无主架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-3-%E6%A8%AA%E5%90%91%E6%89%A9%E5%B1%95"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">2.2.3 横向扩展</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-4-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">2.2.4 高可用性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%97%A0%E4%B8%BB%E6%9E%B6%E6%9E%84%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86"><span class="toc-number">1.4.3.</span> <span class="toc-text">2.3 无主架构技术原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-%E6%A0%B8%E5%BF%83%E6%9C%BA%E5%88%B6%EF%BC%9A%E7%A1%AE%E5%AE%9A%E6%80%A7%E5%93%88%E5%B8%8C%E4%B8%8E%E7%BA%A0%E5%88%A0%E7%A0%81"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">2.3.1 核心机制：确定性哈希与纠删码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E6%80%A7%E5%93%88%E5%B8%8C%E5%88%86%E5%B8%83%E7%AE%97%E6%B3%95"><span class="toc-number">1.4.3.1.1.</span> <span class="toc-text">确定性哈希分布算法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Reed-Solomon-%E7%BA%A0%E5%88%A0%E7%A0%81"><span class="toc-number">1.4.3.1.2.</span> <span class="toc-text">Reed-Solomon 纠删码</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%86%99%E6%9C%BA%E5%88%B6"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">2.3.2 数据读写机制</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B9%B6%E8%A1%8C%E8%AF%BB%E5%86%99%E7%9C%9F%E7%9B%B8%EF%BC%9A%E5%B9%B6%E9%9D%9E%E6%89%80%E6%9C%89%E8%8A%82%E7%82%B9%E5%8F%82%E4%B8%8E"><span class="toc-number">1.4.3.2.1.</span> <span class="toc-text">并行读写真相：并非所有节点参与</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%BB%E5%86%99Quorum%E6%9C%BA%E5%88%B6"><span class="toc-number">1.4.3.2.2.</span> <span class="toc-text">读写Quorum机制</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-3-%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%83%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86"><span class="toc-number">1.4.3.3.</span> <span class="toc-text">2.3.3 分布式元数据管理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%85%83%E6%95%B0%E6%8D%AE-Object-Metadata"><span class="toc-number">1.4.3.3.1.</span> <span class="toc-text">对象元数据 (Object Metadata)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%85%83%E6%95%B0%E6%8D%AE-Configuration-Metadata"><span class="toc-number">1.4.3.3.2.</span> <span class="toc-text">配置元数据 (Configuration Metadata)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-4-%E6%95%85%E9%9A%9C%E6%A3%80%E6%B5%8B%E4%B8%8E%E8%87%AA%E6%84%88%E6%9C%BA%E5%88%B6"><span class="toc-number">1.4.3.4.</span> <span class="toc-text">2.3.4 故障检测与自愈机制</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9E%E6%97%B6%E6%95%85%E9%9A%9C%E7%9B%91%E6%8E%A7"><span class="toc-number">1.4.3.4.1.</span> <span class="toc-text">实时故障监控</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E6%95%B0%E6%8D%AE%E9%87%8D%E5%BB%BA%EF%BC%88%E8%87%AA%E6%84%88%EF%BC%89"><span class="toc-number">1.4.3.4.2.</span> <span class="toc-text">自动数据重建（自愈）</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-5-%E6%97%A0%E4%B8%BB%E6%9E%B6%E6%9E%84%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.4.3.5.</span> <span class="toc-text">2.3.5 无主架构的优缺点</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%98%E5%8A%BF"><span class="toc-number">1.4.3.5.1.</span> <span class="toc-text">优势</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9"><span class="toc-number">1.4.3.5.2.</span> <span class="toc-text">缺点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E9%9B%86%E7%BE%A4%E6%89%A9%E5%AE%B9%E6%9C%BA%E5%88%B6"><span class="toc-number">1.4.4.</span> <span class="toc-text">2.4 集群扩容机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-1-%E5%AF%B9%E7%AD%89%E6%89%A9%E5%AE%B9%EF%BC%88Server-Pool%E6%89%A9%E5%AE%B9%EF%BC%89"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">2.4.1 对等扩容（Server Pool扩容）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-2-%E8%81%94%E9%82%A6%E6%89%A9%E5%AE%B9%EF%BC%88Federation%EF%BC%89"><span class="toc-number">1.4.4.2.</span> <span class="toc-text">2.4.2 联邦扩容（Federation）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-3-%E6%89%A9%E5%AE%B9%E6%96%B9%E5%BC%8F%E9%80%89%E6%8B%A9%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.4.4.3.</span> <span class="toc-text">2.4.3 扩容方式选择建议</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-MinIO%E6%8A%80%E6%9C%AF%E6%BE%84%E6%B8%85%E4%B8%8E%E9%97%AE%E9%A2%98%E8%A7%A3%E7%AD%94"><span class="toc-number">1.4.5.</span> <span class="toc-text">2.5 MinIO技术澄清与问题解答</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8D%E8%A6%81%E6%8A%80%E6%9C%AF%E6%BE%84%E6%B8%85"><span class="toc-number">1.4.5.1.</span> <span class="toc-text">重要技术澄清</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF%E9%97%AE%E9%A2%98%E8%A7%A3%E7%AD%94"><span class="toc-number">1.4.5.2.</span> <span class="toc-text">核心技术问题解答</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%981%EF%BC%9AMinIO%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6%E4%BC%9A%E5%B9%B6%E8%A1%8C%E5%86%99%E5%88%B0%E6%89%80%E6%9C%89%E8%8A%82%E7%82%B9%E5%90%97%EF%BC%9F"><span class="toc-number">1.4.5.2.1.</span> <span class="toc-text">问题1：MinIO读写文件会并行写到所有节点吗？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%982%EF%BC%9A%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%83%E6%95%B0%E6%8D%AE%E5%9C%A8%E6%89%A9%E5%AE%B9-%E7%BC%A9%E5%AE%B9%E5%92%8C%E8%8A%82%E7%82%B9%E5%AE%95%E6%9C%BA%E6%97%B6%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%EF%BC%9F"><span class="toc-number">1.4.5.2.2.</span> <span class="toc-text">问题2：分布式元数据在扩容&#x2F;缩容和节点宕机时如何处理？</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-MinIO-%E6%A0%B8%E5%BF%83%E6%B5%81%E7%A8%8B"><span class="toc-number">1.5.</span> <span class="toc-text">3. MinIO 核心流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%95%B0%E6%8D%AE%E5%86%99%E5%85%A5%E6%B5%81%E7%A8%8B"><span class="toc-number">1.5.1.</span> <span class="toc-text">3.1 数据写入流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96%E6%B5%81%E7%A8%8B"><span class="toc-number">1.5.2.</span> <span class="toc-text">3.2 数据读取流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E6%95%85%E9%9A%9C%E6%81%A2%E5%A4%8D%E6%B5%81%E7%A8%8B"><span class="toc-number">1.5.3.</span> <span class="toc-text">3.3 故障恢复流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-MinIO-%E4%B8%8E%E5%85%B6%E4%BB%96%E5%AD%98%E5%82%A8%E7%B3%BB%E7%BB%9F%E5%AF%B9%E6%AF%94"><span class="toc-number">1.6.</span> <span class="toc-text">4. MinIO 与其他存储系统对比</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8-vs-%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8-vs-%E5%9D%97%E5%AD%98%E5%82%A8"><span class="toc-number">1.6.1.</span> <span class="toc-text">4.1 对象存储 vs 文件存储 vs 块存储</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E7%B1%BB%E5%9E%8B%E6%9E%B6%E6%9E%84%E5%AF%B9%E6%AF%94"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">存储类型架构对比</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-MinIO-vs-HDFS-%E8%AF%A6%E7%BB%86%E5%AF%B9%E6%AF%94"><span class="toc-number">1.6.2.</span> <span class="toc-text">4.2 MinIO vs HDFS 详细对比</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E6%9E%B6%E6%9E%84%E5%B7%AE%E5%BC%82"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">4.2.1 架构差异</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-%E6%8A%80%E6%9C%AF%E5%AE%9E%E7%8E%B0%E5%AF%B9%E6%AF%94"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">4.2.2 技术实现对比</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-3-%E6%80%A7%E8%83%BD%E4%B8%8E%E5%8F%AF%E9%9D%A0%E6%80%A7%E5%AF%B9%E6%AF%94"><span class="toc-number">1.6.2.3.</span> <span class="toc-text">4.2.3 性能与可靠性对比</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%BB%E5%86%99%E6%80%A7%E8%83%BD"><span class="toc-number">1.6.2.3.1.</span> <span class="toc-text">读写性能</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%85%E9%9A%9C%E6%81%A2%E5%A4%8D"><span class="toc-number">1.6.2.3.2.</span> <span class="toc-text">故障恢复</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-4-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E5%AF%B9%E6%AF%94"><span class="toc-number">1.6.2.4.</span> <span class="toc-text">4.2.4 使用场景对比</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-MinIO-vs-%E5%85%B6%E4%BB%96%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8"><span class="toc-number">1.6.3.</span> <span class="toc-text">4.3 MinIO vs 其他对象存储</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-1-MinIO-vs-AWS-S3"><span class="toc-number">1.6.3.1.</span> <span class="toc-text">4.3.1 MinIO vs AWS S3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-MinIO-vs-Ceph"><span class="toc-number">1.6.3.2.</span> <span class="toc-text">4.3.2 MinIO vs Ceph</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E9%80%89%E5%9E%8B%E5%86%B3%E7%AD%96%E6%A1%86%E6%9E%B6"><span class="toc-number">1.6.4.</span> <span class="toc-text">4.4 选型决策框架</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-1-%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%E7%9F%A9%E9%98%B5"><span class="toc-number">1.6.4.1.</span> <span class="toc-text">4.4.1 技术选型矩阵</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-2-%E5%86%B3%E7%AD%96%E8%A6%81%E7%B4%A0%E6%9D%83%E9%87%8D"><span class="toc-number">1.6.4.2.</span> <span class="toc-text">4.4.2 决策要素权重</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90"><span class="toc-number">1.6.5.</span> <span class="toc-text">4.5 实际应用案例分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-1-%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0%E5%AD%98%E5%82%A8%E6%9E%B6%E6%9E%84"><span class="toc-number">1.6.5.1.</span> <span class="toc-text">4.5.1 电商平台存储架构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-2-AI-ML%E5%B9%B3%E5%8F%B0%E5%AD%98%E5%82%A8%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.6.5.2.</span> <span class="toc-text">4.5.2 AI&#x2F;ML平台存储设计</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-MinIO-%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97"><span class="toc-number">1.7.</span> <span class="toc-text">5. MinIO 命令使用指南</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%AE%89%E8%A3%85%E5%92%8C%E9%83%A8%E7%BD%B2"><span class="toc-number">1.7.1.</span> <span class="toc-text">5.1 安装和部署</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E6%9C%BA%E9%83%A8%E7%BD%B2"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">单机部署</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2-%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.7.1.2.</span> <span class="toc-text">集群部署 (示例)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-MinIO-Client-mc-%E5%91%BD%E4%BB%A4"><span class="toc-number">1.7.2.</span> <span class="toc-text">5.2 MinIO Client (mc) 命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE"><span class="toc-number">1.7.2.1.</span> <span class="toc-text">基本配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Bucket-%E6%93%8D%E4%BD%9C"><span class="toc-number">1.7.2.2.</span> <span class="toc-text">Bucket 操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E6%93%8D%E4%BD%9C"><span class="toc-number">1.7.2.3.</span> <span class="toc-text">对象操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8C%E6%AD%A5%E6%93%8D%E4%BD%9C"><span class="toc-number">1.7.2.4.</span> <span class="toc-text">同步操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E6%9D%83%E9%99%90%E5%92%8C%E7%AD%96%E7%95%A5%E7%AE%A1%E7%90%86"><span class="toc-number">1.7.3.</span> <span class="toc-text">5.3 权限和策略管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="toc-number">1.7.3.1.</span> <span class="toc-text">用户管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%96%E7%95%A5%E7%AE%A1%E7%90%86"><span class="toc-number">1.7.3.2.</span> <span class="toc-text">策略管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E7%AE%A1%E7%90%86"><span class="toc-number">1.7.3.3.</span> <span class="toc-text">组管理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E7%9B%91%E6%8E%A7%E5%92%8C%E7%AE%A1%E7%90%86"><span class="toc-number">1.7.4.</span> <span class="toc-text">5.4 监控和管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BF%A1%E6%81%AF"><span class="toc-number">1.7.4.1.</span> <span class="toc-text">服务器信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95"><span class="toc-number">1.7.4.2.</span> <span class="toc-text">性能测试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86"><span class="toc-number">1.7.4.3.</span> <span class="toc-text">日志管理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-%E9%AB%98%E7%BA%A7%E5%8A%9F%E8%83%BD"><span class="toc-number">1.7.5.</span> <span class="toc-text">5.5 高级功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6"><span class="toc-number">1.7.5.1.</span> <span class="toc-text">版本控制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%AE%A1%E7%90%86-ILM"><span class="toc-number">1.7.5.2.</span> <span class="toc-text">生命周期管理 (ILM)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86"><span class="toc-number">1.7.5.3.</span> <span class="toc-text">加密</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-%E8%81%94%E9%82%A6%E6%89%A9%E5%AE%B9%E9%85%8D%E7%BD%AE"><span class="toc-number">1.7.6.</span> <span class="toc-text">5.6 联邦扩容配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4%E5%91%BD%E4%BB%A4"><span class="toc-number">1.7.7.</span> <span class="toc-text">5.7 故障排除命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%81%A5%E5%BA%B7%E6%A3%80%E6%9F%A5"><span class="toc-number">1.7.7.1.</span> <span class="toc-text">健康检查</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86"><span class="toc-number">1.7.7.2.</span> <span class="toc-text">配置管理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.8.</span> <span class="toc-text">6. 最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E9%83%A8%E7%BD%B2%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.8.1.</span> <span class="toc-text">6.1 部署建议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-1-%E7%A1%AC%E4%BB%B6%E9%85%8D%E7%BD%AE%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.8.1.1.</span> <span class="toc-text">6.1.1 硬件配置建议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-2-%E9%9B%86%E7%BE%A4%E8%A7%84%E5%88%92%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.8.1.2.</span> <span class="toc-text">6.1.2 集群规划建议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-3-%E8%BF%9E%E7%BB%ADIP%E8%A7%84%E5%88%92"><span class="toc-number">1.8.1.3.</span> <span class="toc-text">6.1.3 连续IP规划</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-number">1.8.2.</span> <span class="toc-text">6.2 性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-1-%E7%BA%A0%E5%88%A0%E7%A0%81%E9%85%8D%E7%BD%AE%E4%BC%98%E5%8C%96"><span class="toc-number">1.8.2.1.</span> <span class="toc-text">6.2.1 纠删码配置优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-2-%E7%A1%AC%E4%BB%B6%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-number">1.8.2.2.</span> <span class="toc-text">6.2.2 硬件性能优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-3-%E7%BD%91%E7%BB%9C%E4%BC%98%E5%8C%96"><span class="toc-number">1.8.2.3.</span> <span class="toc-text">6.2.3 网络优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-4-%E5%85%B3%E9%94%AE%E7%9B%91%E6%8E%A7%E6%8C%87%E6%A0%87"><span class="toc-number">1.8.2.4.</span> <span class="toc-text">6.2.4 关键监控指标</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.8.3.</span> <span class="toc-text">6.3 安全建议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E7%9B%91%E6%8E%A7%E5%92%8C%E7%BB%B4%E6%8A%A4"><span class="toc-number">1.8.4.</span> <span class="toc-text">6.4 监控和维护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%80%BB%E7%BB%93"><span class="toc-number">1.9.</span> <span class="toc-text">7. 总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-MinIO-%E6%A0%B8%E5%BF%83%E4%BC%98%E5%8A%BF%E6%80%BB%E8%A7%88"><span class="toc-number">1.9.1.</span> <span class="toc-text">7.1 MinIO 核心优势总览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E6%8A%80%E6%9C%AF%E7%89%B9%E8%89%B2%E6%80%BB%E7%BB%93"><span class="toc-number">1.9.2.</span> <span class="toc-text">7.2 技术特色总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF%E6%80%BB%E7%BB%93"><span class="toc-number">1.9.3.</span> <span class="toc-text">7.3 适用场景总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-%E6%80%BB%E4%BD%93%E8%AF%84%E4%BB%B7"><span class="toc-number">1.9.4.</span> <span class="toc-text">7.4 总体评价</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.9.5.</span> <span class="toc-text">7.5 最佳实践建议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E9%98%B6%E6%AE%B5%E9%83%A8%E7%BD%B2%E7%AD%96%E7%95%A5"><span class="toc-number">1.9.5.1.</span> <span class="toc-text">分阶段部署策略</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF%E8%A6%81%E7%82%B9"><span class="toc-number">1.9.5.2.</span> <span class="toc-text">关键技术要点</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/07/01/%E4%BD%BF%E7%94%A8Jenv%E7%AE%A1%E7%90%86%E5%A4%9A%E7%89%88%E6%9C%ACJDK%E7%8E%AF%E5%A2%83/" title="使用 Jenv 管理多版本 JDK 环境：轻松切换 Java 版本的最佳实践"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/20250624000019253.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用 Jenv 管理多版本 JDK 环境：轻松切换 Java 版本的最佳实践"/></a><div class="content"><a class="title" href="/2025/07/01/%E4%BD%BF%E7%94%A8Jenv%E7%AE%A1%E7%90%86%E5%A4%9A%E7%89%88%E6%9C%ACJDK%E7%8E%AF%E5%A2%83/" title="使用 Jenv 管理多版本 JDK 环境：轻松切换 Java 版本的最佳实践">使用 Jenv 管理多版本 JDK 环境：轻松切换 Java 版本的最佳实践</a><time datetime="2025-06-30T16:00:00.000Z" title="发表于 2025-07-01 00:00:00">2025-07-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/29/HTTP%E8%AF%B7%E6%B1%82%E9%93%BE%E8%B7%AF%E4%B8%8EDNS%E5%88%86%E6%9E%90%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5/" title="HTTP请求链路与DNS分析技术实践：深入理解网络通信机制"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/20250624000019253.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HTTP请求链路与DNS分析技术实践：深入理解网络通信机制"/></a><div class="content"><a class="title" href="/2025/06/29/HTTP%E8%AF%B7%E6%B1%82%E9%93%BE%E8%B7%AF%E4%B8%8EDNS%E5%88%86%E6%9E%90%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5/" title="HTTP请求链路与DNS分析技术实践：深入理解网络通信机制">HTTP请求链路与DNS分析技术实践：深入理解网络通信机制</a><time datetime="2025-06-28T16:00:00.000Z" title="发表于 2025-06-29 00:00:00">2025-06-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/27/DNS%E8%A7%A3%E9%94%81%E6%8A%80%E6%9C%AF%E8%AF%A6%E8%A7%A3%EF%BC%9A%E5%8E%9F%E7%90%86%E3%80%81%E5%AE%9E%E7%8E%B0%E4%B8%8E%E5%BA%94%E7%94%A8/" title="DNS解锁技术原理、实现"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/20250618094256140.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DNS解锁技术原理、实现"/></a><div class="content"><a class="title" href="/2025/06/27/DNS%E8%A7%A3%E9%94%81%E6%8A%80%E6%9C%AF%E8%AF%A6%E8%A7%A3%EF%BC%9A%E5%8E%9F%E7%90%86%E3%80%81%E5%AE%9E%E7%8E%B0%E4%B8%8E%E5%BA%94%E7%94%A8/" title="DNS解锁技术原理、实现">DNS解锁技术原理、实现</a><time datetime="2025-06-27T02:00:00.000Z" title="发表于 2025-06-27 10:00:00">2025-06-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/27/%E7%A8%8B%E5%BA%8F%E5%8C%96%E5%B9%BF%E5%91%8A%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B8%8E%E6%8A%95%E6%94%BE%E4%B8%9A%E5%8A%A1%E6%A8%A1%E5%BC%8F%E4%B8%8E%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84/" title="程序化广告数据处理与投放技术架构与业务模式"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/20250625170909952.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="程序化广告数据处理与投放技术架构与业务模式"/></a><div class="content"><a class="title" href="/2025/06/27/%E7%A8%8B%E5%BA%8F%E5%8C%96%E5%B9%BF%E5%91%8A%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B8%8E%E6%8A%95%E6%94%BE%E4%B8%9A%E5%8A%A1%E6%A8%A1%E5%BC%8F%E4%B8%8E%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84/" title="程序化广告数据处理与投放技术架构与业务模式">程序化广告数据处理与投放技术架构与业务模式</a><time datetime="2025-06-26T16:00:00.000Z" title="发表于 2025-06-27 00:00:00">2025-06-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/26/confidential_computing_implementation_guide/" title="机密计算环境实施：从硬件选型到应用部署"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/20250625095124143.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="机密计算环境实施：从硬件选型到应用部署"/></a><div class="content"><a class="title" href="/2025/06/26/confidential_computing_implementation_guide/" title="机密计算环境实施：从硬件选型到应用部署">机密计算环境实施：从硬件选型到应用部署</a><time datetime="2025-06-25T16:00:00.000Z" title="发表于 2025-06-26 00:00:00">2025-06-26</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 - 2025 By <a class="footer-bar-link" href="/" title="XR" target="_blank">XR</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">36</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">49</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">4</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Argon2/" style="font-size: 0.88rem;">Argon2<sup>1</sup></a><a href="/tags/DNS/" style="font-size: 0.88rem;">DNS<sup>2</sup></a><a href="/tags/DSP/" style="font-size: 0.88rem;">DSP<sup>1</sup></a><a href="/tags/HBase/" style="font-size: 0.88rem;">HBase<sup>1</sup></a><a href="/tags/HDFS/" style="font-size: 0.88rem;">HDFS<sup>2</sup></a><a href="/tags/Hadoop/" style="font-size: 0.88rem;">Hadoop<sup>1</sup></a><a href="/tags/Hive/" style="font-size: 0.88rem;">Hive<sup>1</sup></a><a href="/tags/Java/" style="font-size: 0.88rem;">Java<sup>6</sup></a><a href="/tags/Kubernetes/" style="font-size: 0.88rem;">Kubernetes<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>4</sup></a><a href="/tags/MinIO/" style="font-size: 0.88rem;">MinIO<sup>1</sup></a><a href="/tags/NAT/" style="font-size: 0.88rem;">NAT<sup>1</sup></a><a href="/tags/RTB/" style="font-size: 0.88rem;">RTB<sup>1</sup></a><a href="/tags/S3%E5%85%BC%E5%AE%B9/" style="font-size: 0.88rem;">S3兼容<sup>1</sup></a><a href="/tags/SGX/" style="font-size: 0.88rem;">SGX<sup>2</sup></a><a href="/tags/Spark/" style="font-size: 0.88rem;">Spark<sup>2</sup></a><a href="/tags/Spring/" style="font-size: 0.88rem;">Spring<sup>2</sup></a><a href="/tags/TDX/" style="font-size: 0.88rem;">TDX<sup>2</sup></a><a href="/tags/TEE/" style="font-size: 0.88rem;">TEE<sup>2</sup></a><a href="/tags/TME/" style="font-size: 0.88rem;">TME<sup>2</sup></a><a href="/tags/YARN/" style="font-size: 0.88rem;">YARN<sup>1</sup></a><a href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/" style="font-size: 0.88rem;">云原生<sup>1</sup></a><a href="/tags/%E5%86%85%E5%AD%98%E8%AE%A1%E7%AE%97/" style="font-size: 0.88rem;">内存计算<sup>1</sup></a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%A4%84%E7%90%86/" style="font-size: 0.88rem;">分布式处理<sup>1</sup></a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/" style="font-size: 0.88rem;">分布式存储<sup>2</sup></a><a href="/tags/%E5%93%88%E5%B8%8C/" style="font-size: 0.88rem;">哈希<sup>1</sup></a><a href="/tags/%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/" style="font-size: 0.88rem;">哈希算法<sup>1</sup></a><a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 0.88rem;">大数据<sup>1</sup></a><a href="/tags/%E5%AE%89%E5%85%A8/" style="font-size: 0.88rem;">安全<sup>2</sup></a><a href="/tags/%E5%AF%86%E7%A0%81%E5%93%88%E5%B8%8C/" style="font-size: 0.88rem;">密码哈希<sup>1</sup></a><a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8/" style="font-size: 0.88rem;">密码存储<sup>1</sup></a><a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size: 0.88rem;">密码学<sup>1</sup></a><a href="/tags/%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8/" style="font-size: 0.88rem;">对象存储<sup>1</sup></a><a href="/tags/%E5%B9%B6%E5%8F%91/" style="font-size: 0.88rem;">并发<sup>2</sup></a><a href="/tags/%E5%B9%BF%E5%91%8A%E6%8A%95%E6%94%BE/" style="font-size: 0.88rem;">广告投放<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F/" style="font-size: 0.88rem;">系统<sup>2</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/" style="font-size: 0.88rem;">系统安全<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 0.88rem;">网络<sup>4</sup></a><a href="/tags/%E9%98%B2%E7%81%AB%E5%A2%99/" style="font-size: 0.88rem;">防火墙<sup>2</sup></a><a href="/tags/%E9%9A%90%E7%A7%81%E8%AE%A1%E7%AE%97/" style="font-size: 0.88rem;">隐私计算<sup>2</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("12/26/2024 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2024 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 XR 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.cbd.int/mermaid@10.2.4/dist/mermaid.min.js').then(runMermaid)
  }

  anzhiyu.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const initValine = () => {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'cbSQtAqs68yENzUQ5wpQK826-MdYXbMMI',
      appKey: 'MR93sqmbPdh7Zm1bZzjXNvlm',
      avatar: 'mp',
      serverURLs: 'https://cbsqtaqs.api.lncldglobal.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  const loadValine = async () => {
    if (typeof Valine === 'function') initValine()
    else {
      await getScript('https://cdn.cbd.int/valine@1.5.1/dist/Valine.min.js')
      initValine()
    }
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script src="https://cdn.cbd.int/blueimp-md5@2.19.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getIcon = (icon, mail) => {
    if (icon) return icon
    let defaultIcon = '?d=mp'
    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`
    return iconUrl
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = () => {
    const serverURL = 'https://cbsqtaqs.api.lncldglobal.com'

    var settings = {
      "method": "GET",
      "headers": {
        "X-LC-Id": 'cbSQtAqs68yENzUQ5wpQK826-MdYXbMMI',
        "X-LC-Key": 'MR93sqmbPdh7Zm1bZzjXNvlm',
        "Content-Type": "application/json"
      },
    }

    fetch(`${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,settings)
      .then(response => response.json())
      .then(data => {
        const valineArray = data.results.map(function (e) {
          return {
            'avatar': getIcon(e.QQAvatar, e.mail),
            'content': changeContent(e.comment),
            'nick': e.nick,
            'url': e.url + '#' + e.objectId,
            'date': e.updatedAt,
          }
        })
        saveToLocal.set('valine-newest-comments', JSON.stringify(valineArray), 10/(60*24))
        generateHtml(valineArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      }) 
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('valine-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>