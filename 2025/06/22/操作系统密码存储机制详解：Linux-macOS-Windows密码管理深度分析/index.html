<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析 | 凌霄的博客</title><meta name="keywords" content="密码存储,系统安全,哈希算法"><meta name="author" content="XR"><meta name="copyright" content="XR"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析"><meta name="application-name" content="操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析"><meta property="og:url" content="http://example.com/2025/06/22/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3%EF%BC%9ALinux-macOS-Windows%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86%E6%B7%B1%E5%BA%A6%E5%88%86%E6%9E%90/index.html"><meta property="og:site_name" content="凌霄的博客"><meta property="og:description" content="深入探讨Linux、macOS、Windows三大操作系统如何安全地存储和管理用户密码，包括存储位置、加密算法、安全机制等技术细节"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta property="article:author" content="XR"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta name="description" content="深入探讨Linux、macOS、Windows三大操作系统如何安全地存储和管理用户密码，包括存储位置、加密算法、安全机制等技术细节"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2025/06/22/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3%EF%BC%9ALinux-macOS-Windows%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86%E6%B7%B1%E5%BA%A6%E5%88%86%E6%9E%90/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🧱 团队小组发动机"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: XR","link":"链接: ","source":"来源: 凌霄的博客","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '凌霄的博客',
  title: '操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析',
  postAI: '',
  pageFillDescription: '操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析, 引言, 1. Linux系统密码存储机制, 1.1 传统的x2Fetcx2Fpasswd文件, 1.2 现代的Shadow密码系统, 1.3 Linux密码哈希算法, 1.4 实际存储示例, 1.5 密码验证流程, 2. macOS系统密码存储机制, 2.1 Open Directory服务, 2.2 密码哈希存储, 2.3 PBKDF2算法, 2.4 Keychain密码管理, 2.5 FileVault磁盘加密, 3. Windows系统密码存储机制, 3.1 SAM数据库, 3.2 密码哈希算法, 3.3 SAM文件结构, 3.4 密码存储格式, 3.5 Windows TPM集成与安全增强, 3.5.1 TPM在Windows中的作用, 3.5.2 TPM密钥封装机制, 3.6 Windows密码验证流程, 4. 密码哈希算法深度分析：为什么Argon2比SHA-512更安全, 4.1 算法类型对比, 4.1.1 快速哈希算法的问题, 4.1.2 Argon2的设计优势, 4.2 Argon2的三重防护机制, 4.2.1 内存困难性（Memory-Hard）, 4.2.2 时间复杂度控制, 4.2.3 并行化阻抗, 4.3 算法安全性量化对比, 4.3.1 破解成本分析, 4.3.2 实际安全建议, 5. 磁盘攻击与防护机制, 5.1 离线攻击的威胁, 5.1.1 传统磁盘攻击方法, 5.2 现代防护机制, 5.2.1 全磁盘加密防护, 5.2.2 TPM集成防护, 5.2.3 安全启动链, 5.3 高级防护策略, 5.3.1 多因素密钥派生, 5.3.2 远程认证机制, 6. 系统安全防护机制对比, 6.1 文件权限保护, 6.2 加密算法强度, 6.3 盐值(Salt)使用, 7. 密码破解防护措施, 7.1 技术防护, 7.2 现代安全增强, 8. 实际安全建议, 8.1 系统管理员建议, 8.2 用户安全实践, 结论, 参考资料操作系统密码存储机制详解密码管理深度分析引言用户密码是操作系统安全的第一道防线不同操作系统采用了各自独特的密码存储和管理机制本文将深入分析和三大主流操作系统如何安全地保存管理员密码以及它们采用的加密算法和安全防护措施系统密码存储机制传统的文件在早期的系统中用户密码直接存储在文件中但这存在严重的安全隐患因为该文件对所有用户可读传统格式已不推荐现代的密码系统现代系统使用密码系统将密码哈希值存储在文件中文件格式字段解释用户名密码哈希最后修改日期从年月日开始的天数最小密码年龄天最大密码年龄天警告期天不活跃期空过期日期空保留字段空密码哈希算法支持多种哈希算法通过前缀标识已不安全推荐最新推荐实际存储示例查看文件需要权限输出示例密码验证流程用户输入密码系统读取提取和算法标识使用相同算法和哈希输入密码比较哈希值哈希值匹配是认证成功否认证失败系统密码存储机制服务使用服务管理用户认证密码存储在以下位置本地用户数据库密码哈希存储用户密码以格式存储哈希数据的编码算法使用算法算法伪代码密码管理还使用服务管理密码文件位置用户级别系统级别磁盘加密当启用时整个磁盘被加密提供额外的安全层用户登录密码解锁获取密钥解密系统磁盘系统正常启动系统密码存储机制数据库将用户密码存储在数据库中位置密码哈希算法使用以下哈希算法已弃用特点基于算法不区分大小写最大字符存在严重安全漏洞当前使用特点基于算法区分大小写支持字符相对更安全文件结构用户密码哈希存储在用户子键中密码存储格式用户记录格式空密码集成与安全增强系统确实广泛使用可信平台模块来增强密码安全在中的作用启动度量启动链磁盘加密认证凭据保护虚拟安全模式保护的关键功能磁盘加密保护的密钥输出显示保护器信息使用存储生物识别模板密钥存储在的安全存储中凭据防护启用凭据防护密钥封装机制密钥封装伪代码将密码哈希密钥封装到中只有在特定状态下才能解封密码验证流程用户输入密码计算哈希验证系统完整性从数据库读取存储的哈希比较哈希值哈希匹配是解封访问令牌否认证失败用户登录成功密码哈希算法深度分析为什么比更安全算法类型对比快速哈希算法的问题等传统哈希算法的特点计算特点计算速度极快每秒数十亿次内存占用极少几易于并行计算专用硬件加速这些特点对密码安全的影响快速哈希算法暴力破解容易彩虹表攻击有效加速破解专用设备破解的设计优势是专门为密码哈希设计的算法算法参数时间成本迭代次数内存成本并行度输出长度的三重防护机制内存困难性内存使用模式需要大量内存来存储中间状态攻击者必须为每个密码尝试分配相同的内存分配大量内存在内存中进行复杂的数据依赖操作内存困难性的安全优势攻击者无法通过时间内存权衡减少成本设备的内存限制降低攻击效率大规模并行攻击变得极其昂贵时间复杂度控制时间成本可调节比较不同时间成本的计算时间固定时间极快可调节时间成本并行化阻抗并行化密码密码密码密码并行化限制密码大量内存密码大量内存密码大量内存密码大量内存内存带宽瓶颈内存带宽瓶颈内存带宽瓶颈内存带宽瓶颈算法安全性量化对比破解成本分析破解成本估算估算不同算法的破解成本破解成本亿次秒价格电力成本几小时几年破解成本内存受内存限制需要大量内存高内存功耗几年几千年实际安全建议不同应用场景的参数建议根据安全需求推荐参数高安全系统适用于高价值系统可容忍较长登录时间企业应用平衡安全性和用户体验移动应用考虑移动设备资源限制磁盘攻击与防护机制离线攻击的威胁传统磁盘攻击方法系统攻击示例攻击者获取物理访问权限后的操作使用启动系统挂载目标磁盘尝试直接修改文件生成已知密码的哈希新的哈希值替换用户的密码哈希系统攻击示例使用工具如等提取文件使用彩虹表或暴力破解或者直接替换密码哈希现代防护机制全磁盘加密防护加密创建加密分区即使攻击者获得物理访问也无法读取加密数据需要密码才能解密磁盘启用启用集成防护系统启动度量启动链验证系统完整性完整性检查通过解封加密密钥失败拒绝访问解密磁盘系统无法启动密钥封装防护密钥封装防护机制系统启动时度量关键组件将度量值存储到寄存器密钥封装时绑定到特定状态绑定到多个只有在相同状态下才能解封系统完整性验证失败安全启动链固件验证签名验证内核签名验证驱动签名验证应用程序签名完整的信任链每个阶段度量组件扩展验证签名记录日志高级防护策略多因素密钥派生结合多种因素的密钥派生用户密码请输入密码密钥硬件指纹时间因子可选小时级别组合所有因子使用派生最终密钥远程认证机制远程认证确保系统完整性获取当前值生成认证报告发送到远程服务器验证根据验证结果决定是否授权系统完整性验证失败系统安全防护机制对比文件权限保护系统密码文件权限设置访问控制集成仅可读写可选集成文件系统保护芯片文件系统独占运行时锁定深度集成加密算法强度不安全弱安全中等安全高安全高安全最高安全盐值使用每个密码使用随机盐值使用随机盐值和高迭代次数不使用盐值安全缺陷密码破解防护措施技术防护密码复杂度要求配置示例账户锁定机制失败尝试次数限制密码历史记录防止重复使用最近的密码现代安全增强多因素认证用户名密码短信验证码生物识别硬件令牌访问授权无密码认证硬件密钥实际安全建议系统管理员建议系统升级到哈希算法配置使用启用全磁盘加密配置如果可用系统启用配置密码策略启用防火墙系统启用配置密码策略启用凭据防护用户安全实践使用强密码至少位包含大小写字母数字和特殊字符启用多因素认证在所有支持的系统和应用中启用定期更新密码定期更换重要账户密码使用密码管理器避免重复使用密码保持系统更新及时安装安全补丁启用全磁盘加密防止物理访问攻击启用功能利用硬件安全模块增强保护结论不同操作系统采用了各自独特的密码存储和管理机制使用系统和强大的哈希算法推荐升级到提供了良好的安全性采用和服务集成安全芯片安全性很高通过深度集成和等现代安全功能大幅增强了安全性关键安全要点优于传统哈希算法内存困难时间可调并行阻抗硬件安全模块提供硬件级密钥保护和系统完整性验证全磁盘加密防止物理访问攻击的最重要防护措施多层防护结合密码策略生物识别等多种安全手段了解这些机制有助于系统管理员和安全专业人员更好地配置和保护系统安全随着技术发展无密码认证和生物识别等新技术正在逐步取代传统的密码认证方式为系统安全提供更强的保障参考资料',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-06-22 22:28:58',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">凌霄的博客</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231130275.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231130275.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231143327.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231143327.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Argon2/" style="font-size: 1.05rem;">Argon2<sup>1</sup></a><a href="/tags/DNS/" style="font-size: 1.05rem;">DNS<sup>4</sup></a><a href="/tags/GRUB/" style="font-size: 1.05rem;">GRUB<sup>1</sup></a><a href="/tags/HDFS/" style="font-size: 1.05rem;">HDFS<sup>4</sup></a><a href="/tags/HTTP/" style="font-size: 1.05rem;">HTTP<sup>1</sup></a><a href="/tags/Hadoop/" style="font-size: 1.05rem;">Hadoop<sup>4</sup></a><a href="/tags/HyperEnclave/" style="font-size: 1.05rem;">HyperEnclave<sup>5</sup></a><a href="/tags/Hypervisor/" style="font-size: 1.05rem;">Hypervisor<sup>2</sup></a><a href="/tags/KVM/" style="font-size: 1.05rem;">KVM<sup>2</sup></a><a href="/tags/Kerberos/" style="font-size: 1.05rem;">Kerberos<sup>1</sup></a><a href="/tags/Kubernetes/" style="font-size: 1.05rem;">Kubernetes<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>7</sup></a><a href="/tags/Linux%E8%BF%90%E7%BB%B4/" style="font-size: 1.05rem;">Linux运维<sup>1</sup></a><a href="/tags/TEE/" style="font-size: 1.05rem;">TEE<sup>10</sup></a><a href="/tags/TPM/" style="font-size: 1.05rem;">TPM<sup>1</sup></a><a href="/tags/UEFI/" style="font-size: 1.05rem;">UEFI<sup>1</sup></a><a href="/tags/VMware/" style="font-size: 1.05rem;">VMware<sup>1</sup></a><a href="/tags/Xen/" style="font-size: 1.05rem;">Xen<sup>1</sup></a><a href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/" style="font-size: 1.05rem;">云原生<sup>1</sup></a><a href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" style="font-size: 1.05rem;">云计算<sup>1</sup></a><a href="/tags/%E4%BB%A3%E7%90%86/" style="font-size: 1.05rem;">代理<sup>1</sup></a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/" style="font-size: 1.05rem;">分布式存储<sup>2</sup></a><a href="/tags/%E5%8F%AF%E4%BF%A1%E5%90%AF%E5%8A%A8/" style="font-size: 1.05rem;">可信启动<sup>1</sup></a><a href="/tags/%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE%E9%99%90%E5%88%B6/" style="font-size: 1.05rem;">地理位置限制<sup>1</sup></a><a href="/tags/%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/" style="font-size: 1.05rem;">学习路线<sup>1</sup></a><a href="/tags/%E5%AE%89%E5%85%A8%E5%90%AF%E5%8A%A8/" style="font-size: 1.05rem;">安全启动<sup>1</sup></a><a href="/tags/%E5%AF%86%E7%A0%81%E5%93%88%E5%B8%8C/" style="font-size: 1.05rem;">密码哈希<sup>1</sup></a><a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size: 1.05rem;">密码学<sup>5</sup></a><a href="/tags/%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5/" style="font-size: 1.05rem;">故障排查<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 1.05rem;">日志<sup>1</sup></a><a href="/tags/%E6%9C%BA%E5%AF%86%E8%AE%A1%E7%AE%97/" style="font-size: 1.05rem;">机密计算<sup>2</sup></a><a href="/tags/%E6%B5%81%E5%AA%92%E4%BD%93%E8%A7%A3%E9%94%81/" style="font-size: 1.05rem;">流媒体解锁<sup>1</sup></a><a href="/tags/%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4/" style="font-size: 1.05rem;">磁盘空间<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/" style="font-size: 1.05rem;">系统日志<sup>1</sup></a><a href="/tags/%E7%BC%93%E5%AD%98%E6%B1%A1%E6%9F%93/" style="font-size: 1.05rem;">缓存污染<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E5%88%86%E6%9E%90/" style="font-size: 1.05rem;">网络分析<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="font-size: 1.05rem;">网络安全<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/" style="font-size: 1.05rem;">虚拟化<sup>5</sup></a><a href="/tags/%E8%AE%BA%E6%96%87%E7%BF%BB%E8%AF%91/" style="font-size: 1.05rem;">论文翻译<sup>1</sup></a><a href="/tags/%E9%9A%90%E7%A7%81%E8%AE%A1%E7%AE%97/" style="font-size: 1.05rem;">隐私计算<sup>6</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/09/"><span class="card-archive-list-date">九月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">11</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/08/"><span class="card-archive-list-date">八月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/07/"><span class="card-archive-list-date">七月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">17</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">六月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">32</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/01/"><span class="card-archive-list-date">一月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url">后端</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>密码存储</span></a><a class="article-meta__tags" href="/tags/%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>系统安全</span></a><a class="article-meta__tags" href="/tags/%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>哈希算法</span></a></span></div></div><h1 class="post-title" itemprop="name headline">操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-06-22T02:00:00.000Z" title="发表于 2025-06-22 10:00:00">2025-06-22</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-06-22T14:28:58.716Z" title="更新于 2025-06-22 22:28:58">2025-06-22</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为杭州"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>杭州</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2025/06/22/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3%EF%BC%9ALinux-macOS-Windows%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86%E6%B7%B1%E5%BA%A6%E5%88%86%E6%9E%90/"><header><a class="post-meta-categories" href="/categories/%E5%90%8E%E7%AB%AF/" itemprop="url">后端</a><a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8/" tabindex="-1" itemprop="url">密码存储</a><a href="/tags/%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/" tabindex="-1" itemprop="url">系统安全</a><a href="/tags/%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/" tabindex="-1" itemprop="url">哈希算法</a><h1 id="CrawlerTitle" itemprop="name headline">操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">XR</span><time itemprop="dateCreated datePublished" datetime="2025-06-22T02:00:00.000Z" title="发表于 2025-06-22 10:00:00">2025-06-22</time><time itemprop="dateCreated datePublished" datetime="2025-06-22T14:28:58.716Z" title="更新于 2025-06-22 22:28:58">2025-06-22</time></header><h1 id="操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析"><a href="#操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析" class="headerlink" title="操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析"></a>操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析</h1><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>用户密码是操作系统安全的第一道防线，不同操作系统采用了各自独特的密码存储和管理机制。本文将深入分析Linux、macOS和Windows三大主流操作系统如何安全地保存管理员密码，以及它们采用的加密算法和安全防护措施。</p>
<h2 id="1-Linux系统密码存储机制"><a href="#1-Linux系统密码存储机制" class="headerlink" title="1. Linux系统密码存储机制"></a>1. Linux系统密码存储机制</h2><h3 id="1-1-传统的-etc-passwd文件"><a href="#1-1-传统的-etc-passwd文件" class="headerlink" title="1.1 传统的&#x2F;etc&#x2F;passwd文件"></a>1.1 传统的&#x2F;etc&#x2F;passwd文件</h3><p>在早期的Unix系统中，用户密码直接存储在<code>/etc/passwd</code>文件中，但这存在严重的安全隐患，因为该文件对所有用户可读。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 传统格式（已不推荐）</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br></pre></td></tr></table></figure>

<h3 id="1-2-现代的Shadow密码系统"><a href="#1-2-现代的Shadow密码系统" class="headerlink" title="1.2 现代的Shadow密码系统"></a>1.2 现代的Shadow密码系统</h3><p>现代Linux系统使用Shadow密码系统，将密码哈希值存储在<code>/etc/shadow</code>文件中：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /etc/shadow文件格式</span></span><br><span class="line">root:$6$salt<span class="variable">$hashedpassword</span>:18000:0:99999:7:::</span><br></pre></td></tr></table></figure>

<p><strong>字段解释：</strong></p>
<ul>
<li>用户名：root</li>
<li>密码哈希：<code>$6$salt$hashedpassword</code></li>
<li>最后修改日期：18000（从1970年1月1日开始的天数）</li>
<li>最小密码年龄：0天</li>
<li>最大密码年龄：99999天</li>
<li>警告期：7天</li>
<li>不活跃期：空</li>
<li>过期日期：空</li>
<li>保留字段：空</li>
</ul>
<h3 id="1-3-Linux密码哈希算法"><a href="#1-3-Linux密码哈希算法" class="headerlink" title="1.3 Linux密码哈希算法"></a>1.3 Linux密码哈希算法</h3><p>Linux支持多种哈希算法，通过<code>$id$</code>前缀标识：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$1$    <span class="comment"># MD5（已不安全）</span></span><br><span class="line">$2a$   <span class="comment"># Blowfish</span></span><br><span class="line">$5$    <span class="comment"># SHA-256</span></span><br><span class="line">$6$    <span class="comment"># SHA-512（推荐）</span></span><br><span class="line">$y$    <span class="comment"># yescrypt（最新推荐）</span></span><br></pre></td></tr></table></figure>

<h3 id="1-4-实际存储示例"><a href="#1-4-实际存储示例" class="headerlink" title="1.4 实际存储示例"></a>1.4 实际存储示例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看shadow文件（需要root权限）</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">cat</span> /etc/shadow | grep root</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出示例</span></span><br><span class="line">root:$6$randomsalt<span class="variable">$4Zw8aBcDe5FgHi6JkLmNoP7QrStUvWxYz0123456789AbCdEfGhIjKlMnOpQrStUvWxYz</span>:19000:0:99999:7:::</span><br></pre></td></tr></table></figure>

<h3 id="1-5-密码验证流程"><a href="#1-5-密码验证流程" class="headerlink" title="1.5 密码验证流程"></a>1.5 密码验证流程</h3><pre class="mermaid">graph TD
    A["用户输入密码"] --> B["系统读取/etc/shadow"]
    B --> C["提取salt和算法标识"]
    C --> D["使用相同算法和salt哈希输入密码"]
    D --> E["比较哈希值"]
    E --> F{哈希值匹配?}
    F -->|是| G["认证成功"]
    F -->|否| H["认证失败"]</pre>

<h2 id="2-macOS系统密码存储机制"><a href="#2-macOS系统密码存储机制" class="headerlink" title="2. macOS系统密码存储机制"></a>2. macOS系统密码存储机制</h2><h3 id="2-1-Open-Directory服务"><a href="#2-1-Open-Directory服务" class="headerlink" title="2.1 Open Directory服务"></a>2.1 Open Directory服务</h3><p>macOS使用Open Directory服务管理用户认证，密码存储在以下位置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 本地用户数据库</span></span><br><span class="line">/var/db/dslocal/nodes/Default/users/</span><br></pre></td></tr></table></figure>

<h3 id="2-2-密码哈希存储"><a href="#2-2-密码哈希存储" class="headerlink" title="2.2 密码哈希存储"></a>2.2 密码哈希存储</h3><p>macOS用户密码以plist格式存储：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- /var/db/dslocal/nodes/Default/users/root.plist --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>ShadowHashData<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">        SALTED-SHA512-PBKDF2哈希数据的Base64编码</span><br><span class="line">        <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-3-PBKDF2算法"><a href="#2-3-PBKDF2算法" class="headerlink" title="2.3 PBKDF2算法"></a>2.3 PBKDF2算法</h3><p>macOS使用PBKDF2（Password-Based Key Derivation Function 2）算法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># PBKDF2算法伪代码</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pbkdf2_hash</span>(<span class="params">password, salt, iterations=<span class="number">10000</span></span>):</span><br><span class="line">    <span class="keyword">return</span> pbkdf2(password, salt, iterations, <span class="number">32</span>, <span class="string">&#x27;sha512&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-4-Keychain密码管理"><a href="#2-4-Keychain密码管理" class="headerlink" title="2.4 Keychain密码管理"></a>2.4 Keychain密码管理</h3><p>macOS还使用Keychain服务管理密码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Keychain文件位置</span></span><br><span class="line">~/Library/Keychains/login.keychain-db  <span class="comment"># 用户级别</span></span><br><span class="line">/Library/Keychains/System.keychain     <span class="comment"># 系统级别</span></span><br></pre></td></tr></table></figure>

<h3 id="2-5-FileVault磁盘加密"><a href="#2-5-FileVault磁盘加密" class="headerlink" title="2.5 FileVault磁盘加密"></a>2.5 FileVault磁盘加密</h3><p>当启用FileVault时，整个磁盘被加密，提供额外的安全层：</p>
<pre class="mermaid">graph TD
    A["用户登录密码"] --> B["解锁Keychain"]
    B --> C["获取FileVault密钥"]
    C --> D["解密系统磁盘"]
    D --> E["系统正常启动"]</pre>

<h2 id="3-Windows系统密码存储机制"><a href="#3-Windows系统密码存储机制" class="headerlink" title="3. Windows系统密码存储机制"></a>3. Windows系统密码存储机制</h2><h3 id="3-1-SAM数据库"><a href="#3-1-SAM数据库" class="headerlink" title="3.1 SAM数据库"></a>3.1 SAM数据库</h3><p>Windows将用户密码存储在SAM（Security Account Manager）数据库中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">位置：C:\Windows\System32\config\SAM</span><br></pre></td></tr></table></figure>

<h3 id="3-2-密码哈希算法"><a href="#3-2-密码哈希算法" class="headerlink" title="3.2 密码哈希算法"></a>3.2 密码哈希算法</h3><p>Windows使用以下哈希算法：</p>
<p><strong>LM Hash（已弃用）：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># LM Hash特点</span><br><span class="line">- 基于DES算法</span><br><span class="line">- 不区分大小写</span><br><span class="line">- 最大14字符</span><br><span class="line">- 存在严重安全漏洞</span><br></pre></td></tr></table></figure>

<p><strong>NTLM Hash（当前使用）：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># NTLM Hash特点</span><br><span class="line">- 基于MD4算法</span><br><span class="line">- 区分大小写</span><br><span class="line">- 支持Unicode字符</span><br><span class="line">- 相对更安全</span><br></pre></td></tr></table></figure>

<h3 id="3-3-SAM文件结构"><a href="#3-3-SAM文件结构" class="headerlink" title="3.3 SAM文件结构"></a>3.3 SAM文件结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SAM Registry Hive:</span><br><span class="line">├── SAM\Domains\Account\Users\</span><br><span class="line">│   ├── 000001F4 (Administrator)</span><br><span class="line">│   ├── 000001F5 (Guest)</span><br><span class="line">│   └── [用户RID]</span><br><span class="line">└── 密码哈希存储在用户RID子键中</span><br></pre></td></tr></table></figure>

<h3 id="3-4-密码存储格式"><a href="#3-4-密码存储格式" class="headerlink" title="3.4 密码存储格式"></a>3.4 密码存储格式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">用户记录格式：</span><br><span class="line">Username: Administrator</span><br><span class="line">RID: 500</span><br><span class="line">LM Hash: aad3b435b51404eeaad3b435b51404ee (空密码)</span><br><span class="line">NTLM Hash: 31d6cfe0d16ae931b73c59d7e0c089c0</span><br></pre></td></tr></table></figure>

<h3 id="3-5-Windows-TPM集成与安全增强"><a href="#3-5-Windows-TPM集成与安全增强" class="headerlink" title="3.5 Windows TPM集成与安全增强"></a>3.5 Windows TPM集成与安全增强</h3><p><strong>Windows系统确实广泛使用TPM（可信平台模块）来增强密码安全：</strong></p>
<h4 id="3-5-1-TPM在Windows中的作用"><a href="#3-5-1-TPM在Windows中的作用" class="headerlink" title="3.5.1 TPM在Windows中的作用"></a>3.5.1 TPM在Windows中的作用</h4><pre class="mermaid">graph TD
    A["Windows启动"] --> B["TPM度量启动链"]
    B --> C["BitLocker磁盘加密"]
    C --> D["Windows Hello认证"]
    D --> E["凭据保护"]
    E --> F["虚拟安全模式VSM"]</pre>

<p><strong>TPM保护的关键功能：</strong></p>
<ol>
<li><p><strong>BitLocker磁盘加密</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># TPM保护的BitLocker密钥</span></span><br><span class="line">manage<span class="literal">-bde</span> <span class="literal">-protectors</span> <span class="literal">-get</span> C:</span><br><span class="line"><span class="comment"># 输出显示TPM保护器信息</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Windows Hello</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows Hello使用TPM存储生物识别模板</span></span><br><span class="line"><span class="comment"># 密钥存储在TPM的安全存储中</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>凭据防护（Credential Guard）</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启用凭据防护</span></span><br><span class="line"><span class="built_in">Enable-WindowsOptionalFeature</span> <span class="literal">-Online</span> <span class="literal">-FeatureName</span> IsolatedUserMode</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="3-5-2-TPM密钥封装机制"><a href="#3-5-2-TPM密钥封装机制" class="headerlink" title="3.5.2 TPM密钥封装机制"></a>3.5.2 TPM密钥封装机制</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># TPM密钥封装伪代码</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tpm_seal_password_key</span>(<span class="params">password_hash, pcr_values</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    将密码哈希密钥封装到TPM中</span></span><br><span class="line"><span class="string">    只有在特定PCR状态下才能解封</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    sealed_key = tpm2_create_sealed_object(</span><br><span class="line">        parent_handle=SRK_HANDLE,</span><br><span class="line">        data=password_hash,</span><br><span class="line">        auth_policy=pcr_policy(pcr_values)</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> sealed_key</span><br></pre></td></tr></table></figure>

<h3 id="3-6-Windows密码验证流程"><a href="#3-6-Windows密码验证流程" class="headerlink" title="3.6 Windows密码验证流程"></a>3.6 Windows密码验证流程</h3><pre class="mermaid">graph TD
    A["用户输入密码"] --> B["计算NTLM哈希"]
    B --> C["TPM验证系统完整性"]
    C --> D["从SAM数据库读取存储的哈希"]
    D --> E["比较哈希值"]
    E --> F{哈希匹配?}
    F -->|是| G["TPM解封访问令牌"]
    F -->|否| H["认证失败"]
    G --> I["用户登录成功"]</pre>

<h2 id="4-密码哈希算法深度分析：为什么Argon2比SHA-512更安全"><a href="#4-密码哈希算法深度分析：为什么Argon2比SHA-512更安全" class="headerlink" title="4. 密码哈希算法深度分析：为什么Argon2比SHA-512更安全"></a>4. 密码哈希算法深度分析：为什么Argon2比SHA-512更安全</h2><h3 id="4-1-算法类型对比"><a href="#4-1-算法类型对比" class="headerlink" title="4.1 算法类型对比"></a>4.1 算法类型对比</h3><h4 id="4-1-1-快速哈希算法的问题"><a href="#4-1-1-快速哈希算法的问题" class="headerlink" title="4.1.1 快速哈希算法的问题"></a>4.1.1 快速哈希算法的问题</h4><p><strong>SHA-512等传统哈希算法的特点：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SHA-512计算特点</span></span><br><span class="line">- 计算速度极快（每秒数十亿次）</span><br><span class="line">- 内存占用极少（几KB）</span><br><span class="line">- 易于并行计算</span><br><span class="line">- 专用硬件加速（GPU、ASIC）</span><br></pre></td></tr></table></figure>

<p><strong>这些特点对密码安全的影响：</strong></p>
<pre class="mermaid">graph TD
    A["快速哈希算法"] --> B["暴力破解容易"]
    A --> C["彩虹表攻击有效"]
    A --> D["GPU加速破解"]
    A --> E["ASIC专用设备破解"]</pre>

<h4 id="4-1-2-Argon2的设计优势"><a href="#4-1-2-Argon2的设计优势" class="headerlink" title="4.1.2 Argon2的设计优势"></a>4.1.2 Argon2的设计优势</h4><p><strong>Argon2是专门为密码哈希设计的算法：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Argon2算法参数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">argon2_hash</span>(<span class="params">password, salt, </span></span><br><span class="line"><span class="params">                time_cost=<span class="number">3</span>,      <span class="comment"># 时间成本（迭代次数）</span></span></span><br><span class="line"><span class="params">                memory_cost=<span class="number">65536</span>, <span class="comment"># 内存成本（KB）</span></span></span><br><span class="line"><span class="params">                parallelism=<span class="number">4</span>,    <span class="comment"># 并行度</span></span></span><br><span class="line"><span class="params">                hash_length=<span class="number">32</span></span>):  <span class="comment"># 输出长度</span></span><br><span class="line">    <span class="keyword">return</span> argon2.<span class="built_in">hash</span>(password, salt, time_cost, memory_cost, parallelism, hash_length)</span><br></pre></td></tr></table></figure>

<h3 id="4-2-Argon2的三重防护机制"><a href="#4-2-Argon2的三重防护机制" class="headerlink" title="4.2 Argon2的三重防护机制"></a>4.2 Argon2的三重防护机制</h3><h4 id="4-2-1-内存困难性（Memory-Hard）"><a href="#4-2-1-内存困难性（Memory-Hard）" class="headerlink" title="4.2.1 内存困难性（Memory-Hard）"></a>4.2.1 内存困难性（Memory-Hard）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Argon2内存使用模式</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">argon2_memory_pattern</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Argon2需要大量内存来存储中间状态</span></span><br><span class="line"><span class="string">    攻击者必须为每个密码尝试分配相同的内存</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    memory_blocks = allocate_memory(memory_cost * <span class="number">1024</span>)  <span class="comment"># 分配大量内存</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 在内存中进行复杂的数据依赖操作</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(time_cost):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(memory_cost):</span><br><span class="line">            memory_blocks[j] = complex_operation(</span><br><span class="line">                memory_blocks[j], </span><br><span class="line">                memory_blocks[pseudo_random_index(j)]</span><br><span class="line">            )</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> final_hash(memory_blocks)</span><br></pre></td></tr></table></figure>

<p><strong>内存困难性的安全优势：</strong></p>
<ul>
<li>攻击者无法通过时间-内存权衡减少成本</li>
<li>GPU&#x2F;ASIC设备的内存限制降低攻击效率</li>
<li>大规模并行攻击变得极其昂贵</li>
</ul>
<h4 id="4-2-2-时间复杂度控制"><a href="#4-2-2-时间复杂度控制" class="headerlink" title="4.2.2 时间复杂度控制"></a>4.2.2 时间复杂度控制</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 时间成本可调节</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compare_time_costs</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    比较不同时间成本的计算时间</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    passwords = [<span class="string">&quot;password123&quot;</span>, <span class="string">&quot;admin&quot;</span>, <span class="string">&quot;123456&quot;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># SHA-512：固定时间，极快</span></span><br><span class="line">    <span class="keyword">for</span> pwd <span class="keyword">in</span> passwords:</span><br><span class="line">        start = time.time()</span><br><span class="line">        sha512_hash = hashlib.sha512(pwd.encode()).hexdigest()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;SHA-512: <span class="subst">&#123;time.time() - start:<span class="number">.6</span>f&#125;</span>s&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Argon2：可调节时间成本</span></span><br><span class="line">    <span class="keyword">for</span> time_cost <span class="keyword">in</span> [<span class="number">1</span>, <span class="number">3</span>, <span class="number">10</span>]:</span><br><span class="line">        start = time.time()</span><br><span class="line">        argon2_hash = argon2.hash_password_raw(</span><br><span class="line">            pwd.encode(), </span><br><span class="line">            salt=<span class="string">b&quot;somesalt&quot;</span>, </span><br><span class="line">            time_cost=time_cost,</span><br><span class="line">            memory_cost=<span class="number">65536</span>,</span><br><span class="line">            parallelism=<span class="number">1</span></span><br><span class="line">        )</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Argon2 (t=<span class="subst">&#123;time_cost&#125;</span>): <span class="subst">&#123;time.time() - start:<span class="number">.6</span>f&#125;</span>s&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="4-2-3-并行化阻抗"><a href="#4-2-3-并行化阻抗" class="headerlink" title="4.2.3 并行化阻抗"></a>4.2.3 并行化阻抗</h4><pre class="mermaid">graph TD
    subgraph "SHA-512并行化"
        A1["密码1"] --> B1["SHA-512"]
        A2["密码2"] --> B2["SHA-512"]
        A3["密码3"] --> B3["SHA-512"]
        A4["密码4"] --> B4["SHA-512"]
    end
    
    subgraph "Argon2并行化限制"
        C1["密码1"] --> D1["大量内存"]
        C2["密码2"] --> D2["大量内存"]
        C3["密码3"] --> D3["大量内存"]
        C4["密码4"] --> D4["大量内存"]
        D1 --> E1["内存带宽瓶颈"]
        D2 --> E2["内存带宽瓶颈"]
        D3 --> E3["内存带宽瓶颈"]
        D4 --> E4["内存带宽瓶颈"]
    end</pre>

<h3 id="4-3-算法安全性量化对比"><a href="#4-3-算法安全性量化对比" class="headerlink" title="4.3 算法安全性量化对比"></a>4.3 算法安全性量化对比</h3><h4 id="4-3-1-破解成本分析"><a href="#4-3-1-破解成本分析" class="headerlink" title="4.3.1 破解成本分析"></a>4.3.1 破解成本分析</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 破解成本估算</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_cost_analysis</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    估算不同算法的破解成本</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># SHA-512 + Salt破解成本</span></span><br><span class="line">    sha512_cost = &#123;</span><br><span class="line">        <span class="string">&quot;gpu_per_second&quot;</span>: <span class="number">10</span>**<span class="number">9</span>,  <span class="comment"># 10亿次/秒</span></span><br><span class="line">        <span class="string">&quot;hardware_cost&quot;</span>: <span class="number">1000</span>,    <span class="comment"># GPU价格</span></span><br><span class="line">        <span class="string">&quot;power_cost&quot;</span>: <span class="number">0.1</span>,        <span class="comment"># 电力成本</span></span><br><span class="line">        <span class="string">&quot;time_to_crack_8char&quot;</span>: <span class="string">&quot;几小时&quot;</span>,</span><br><span class="line">        <span class="string">&quot;time_to_crack_12char&quot;</span>: <span class="string">&quot;几年&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Argon2破解成本</span></span><br><span class="line">    argon2_cost = &#123;</span><br><span class="line">        <span class="string">&quot;memory_per_attempt&quot;</span>: <span class="number">64</span>,  <span class="comment"># 64MB内存</span></span><br><span class="line">        <span class="string">&quot;attempts_per_second&quot;</span>: <span class="number">10</span>, <span class="comment"># 受内存限制</span></span><br><span class="line">        <span class="string">&quot;hardware_cost&quot;</span>: <span class="number">50000</span>,    <span class="comment"># 需要大量内存</span></span><br><span class="line">        <span class="string">&quot;power_cost&quot;</span>: <span class="number">10</span>,          <span class="comment"># 高内存功耗</span></span><br><span class="line">        <span class="string">&quot;time_to_crack_8char&quot;</span>: <span class="string">&quot;几年&quot;</span>,</span><br><span class="line">        <span class="string">&quot;time_to_crack_12char&quot;</span>: <span class="string">&quot;几千年&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> sha512_cost, argon2_cost</span><br></pre></td></tr></table></figure>

<h4 id="4-3-2-实际安全建议"><a href="#4-3-2-实际安全建议" class="headerlink" title="4.3.2 实际安全建议"></a>4.3.2 实际安全建议</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不同应用场景的Argon2参数建议</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">argon2_parameters_recommendation</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    根据安全需求推荐Argon2参数</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    scenarios = &#123;</span><br><span class="line">        <span class="string">&quot;高安全系统&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;time_cost&quot;</span>: <span class="number">10</span>,</span><br><span class="line">            <span class="string">&quot;memory_cost&quot;</span>: <span class="number">1024</span>*<span class="number">1024</span>,  <span class="comment"># 1GB</span></span><br><span class="line">            <span class="string">&quot;parallelism&quot;</span>: <span class="number">4</span>,</span><br><span class="line">            <span class="string">&quot;description&quot;</span>: <span class="string">&quot;适用于高价值系统，可容忍较长登录时间&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;企业应用&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;time_cost&quot;</span>: <span class="number">3</span>,</span><br><span class="line">            <span class="string">&quot;memory_cost&quot;</span>: <span class="number">65536</span>,      <span class="comment"># 64MB</span></span><br><span class="line">            <span class="string">&quot;parallelism&quot;</span>: <span class="number">4</span>,</span><br><span class="line">            <span class="string">&quot;description&quot;</span>: <span class="string">&quot;平衡安全性和用户体验&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;移动应用&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;time_cost&quot;</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="string">&quot;memory_cost&quot;</span>: <span class="number">32768</span>,      <span class="comment"># 32MB</span></span><br><span class="line">            <span class="string">&quot;parallelism&quot;</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="string">&quot;description&quot;</span>: <span class="string">&quot;考虑移动设备资源限制&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> scenarios</span><br></pre></td></tr></table></figure>

<h2 id="5-磁盘攻击与防护机制"><a href="#5-磁盘攻击与防护机制" class="headerlink" title="5. 磁盘攻击与防护机制"></a>5. 磁盘攻击与防护机制</h2><h3 id="5-1-离线攻击的威胁"><a href="#5-1-离线攻击的威胁" class="headerlink" title="5.1 离线攻击的威胁"></a>5.1 离线攻击的威胁</h3><h4 id="5-1-1-传统磁盘攻击方法"><a href="#5-1-1-传统磁盘攻击方法" class="headerlink" title="5.1.1 传统磁盘攻击方法"></a>5.1.1 传统磁盘攻击方法</h4><p><strong>Linux系统攻击示例：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 攻击者获取物理访问权限后的操作</span></span><br><span class="line"><span class="comment"># 1. 使用Live CD启动系统</span></span><br><span class="line"><span class="comment"># 2. 挂载目标磁盘</span></span><br><span class="line"><span class="built_in">sudo</span> mount /dev/sda1 /mnt/target</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 尝试直接修改shadow文件</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">cp</span> /mnt/target/etc/shadow /mnt/target/etc/shadow.bak</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 生成已知密码的哈希</span></span><br><span class="line">python3 -c <span class="string">&quot;</span></span><br><span class="line"><span class="string">import crypt</span></span><br><span class="line"><span class="string">import getpass</span></span><br><span class="line"><span class="string">password = &#x27;newpassword&#x27;</span></span><br><span class="line"><span class="string">salt = &#x27;$6$randomsalt$&#x27;</span></span><br><span class="line"><span class="string">hashed = crypt.crypt(password, salt)</span></span><br><span class="line"><span class="string">print(f&#x27;新的哈希值: &#123;hashed&#125;&#x27;)</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 替换root用户的密码哈希</span></span><br><span class="line"><span class="built_in">sudo</span> sed -i <span class="string">&#x27;s/root:[^:]*:/root:$6$randomsalt$newhash:/&#x27;</span> /mnt/target/etc/shadow</span><br></pre></td></tr></table></figure>

<p><strong>Windows系统攻击示例：</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用工具如Ophcrack、John the Ripper等</span></span><br><span class="line"><span class="comment"># 1. 提取SAM文件</span></span><br><span class="line"><span class="comment"># 2. 使用彩虹表或暴力破解</span></span><br><span class="line"><span class="comment"># 3. 或者直接替换密码哈希</span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-现代防护机制"><a href="#5-2-现代防护机制" class="headerlink" title="5.2 现代防护机制"></a>5.2 现代防护机制</h3><h4 id="5-2-1-全磁盘加密防护"><a href="#5-2-1-全磁盘加密防护" class="headerlink" title="5.2.1 全磁盘加密防护"></a>5.2.1 全磁盘加密防护</h4><p><strong>Linux LUKS加密：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建LUKS加密分区</span></span><br><span class="line">cryptsetup luksFormat /dev/sda1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 即使攻击者获得物理访问，也无法读取加密数据</span></span><br><span class="line"><span class="comment"># 需要密码才能解密磁盘</span></span><br><span class="line">cryptsetup luksOpen /dev/sda1 encrypted_disk</span><br></pre></td></tr></table></figure>

<p><strong>Windows BitLocker：</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启用BitLocker with TPM</span></span><br><span class="line"><span class="built_in">Enable-BitLocker</span> <span class="literal">-MountPoint</span> C: <span class="literal">-TpmProtector</span></span><br></pre></td></tr></table></figure>

<p><strong>macOS FileVault：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启用FileVault</span></span><br><span class="line"><span class="built_in">sudo</span> fdesetup <span class="built_in">enable</span></span><br></pre></td></tr></table></figure>

<h4 id="5-2-2-TPM集成防护"><a href="#5-2-2-TPM集成防护" class="headerlink" title="5.2.2 TPM集成防护"></a>5.2.2 TPM集成防护</h4><pre class="mermaid">graph TD
    A["系统启动"] --> B["TPM度量启动链"]
    B --> C["验证系统完整性"]
    C --> D{完整性检查}
    D -->|通过| E["解封加密密钥"]
    D -->|失败| F["拒绝访问"]
    E --> G["解密磁盘"]
    F --> H["系统无法启动"]</pre>

<p><strong>TPM密钥封装防护：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">tpm_sealed_key_protection</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    TPM密钥封装防护机制</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 1. 系统启动时度量关键组件</span></span><br><span class="line">    boot_measurements = measure_boot_components()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. 将度量值存储到PCR寄存器</span></span><br><span class="line">    extend_pcr(boot_measurements)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. 密钥封装时绑定到特定PCR状态</span></span><br><span class="line">    sealed_key = tpm_seal(</span><br><span class="line">        data=disk_encryption_key,</span><br><span class="line">        pcr_selection=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]  <span class="comment"># 绑定到多个PCR</span></span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. 只有在相同PCR状态下才能解封</span></span><br><span class="line">    <span class="keyword">if</span> current_pcr_values == sealed_pcr_values:</span><br><span class="line">        disk_key = tpm_unseal(sealed_key)</span><br><span class="line">        <span class="keyword">return</span> disk_key</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> SecurityError(<span class="string">&quot;系统完整性验证失败&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="5-2-3-安全启动链"><a href="#5-2-3-安全启动链" class="headerlink" title="5.2.3 安全启动链"></a>5.2.3 安全启动链</h4><pre class="mermaid">graph TD
    A["UEFI固件"] --> B["验证Bootloader签名"]
    B --> C["验证内核签名"]
    C --> D["验证驱动签名"]
    D --> E["验证应用程序签名"]
    E --> F["完整的信任链"]
    
    subgraph "每个阶段"
        G["度量组件"]
        H["扩展PCR"]
        I["验证签名"]
        J["记录日志"]
    end</pre>

<h3 id="5-3-高级防护策略"><a href="#5-3-高级防护策略" class="headerlink" title="5.3 高级防护策略"></a>5.3 高级防护策略</h3><h4 id="5-3-1-多因素密钥派生"><a href="#5-3-1-多因素密钥派生" class="headerlink" title="5.3.1 多因素密钥派生"></a>5.3.1 多因素密钥派生</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">advanced_key_derivation</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    结合多种因素的密钥派生</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 1. 用户密码</span></span><br><span class="line">    user_password = <span class="built_in">input</span>(<span class="string">&quot;请输入密码: &quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. TPM密钥</span></span><br><span class="line">    tpm_key = tpm_get_random(<span class="number">32</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. 硬件指纹</span></span><br><span class="line">    hardware_fingerprint = get_hardware_id()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. 时间因子（可选）</span></span><br><span class="line">    time_factor = <span class="built_in">int</span>(time.time() / <span class="number">3600</span>)  <span class="comment"># 小时级别</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 5. 组合所有因子</span></span><br><span class="line">    combined_input = (</span><br><span class="line">        user_password.encode() + </span><br><span class="line">        tpm_key + </span><br><span class="line">        hardware_fingerprint + </span><br><span class="line">        time_factor.to_bytes(<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 6. 使用Argon2派生最终密钥</span></span><br><span class="line">    final_key = argon2.hash_password_raw(</span><br><span class="line">        combined_input,</span><br><span class="line">        salt=<span class="string">b&quot;system_salt&quot;</span>,</span><br><span class="line">        time_cost=<span class="number">3</span>,</span><br><span class="line">        memory_cost=<span class="number">65536</span>,</span><br><span class="line">        parallelism=<span class="number">4</span></span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> final_key</span><br></pre></td></tr></table></figure>

<h4 id="5-3-2-远程认证机制"><a href="#5-3-2-远程认证机制" class="headerlink" title="5.3.2 远程认证机制"></a>5.3.2 远程认证机制</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">remote_attestation</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    远程认证确保系统完整性</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 1. 获取当前PCR值</span></span><br><span class="line">    current_pcrs = tpm_read_pcrs()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. 生成认证报告</span></span><br><span class="line">    attestation_report = tpm_quote(</span><br><span class="line">        pcr_selection=<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">24</span>)),</span><br><span class="line">        nonce=server_nonce</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. 发送到远程服务器验证</span></span><br><span class="line">    response = requests.post(</span><br><span class="line">        <span class="string">&quot;https://attestation-server.com/verify&quot;</span>,</span><br><span class="line">        json=&#123;</span><br><span class="line">            <span class="string">&quot;pcr_values&quot;</span>: current_pcrs,</span><br><span class="line">            <span class="string">&quot;quote&quot;</span>: attestation_report,</span><br><span class="line">            <span class="string">&quot;certificate_chain&quot;</span>: tpm_cert_chain</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. 根据验证结果决定是否授权</span></span><br><span class="line">    <span class="keyword">if</span> response.json()[<span class="string">&quot;trusted&quot;</span>]:</span><br><span class="line">        <span class="keyword">return</span> grant_access()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> deny_access(<span class="string">&quot;系统完整性验证失败&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="6-系统安全防护机制对比"><a href="#6-系统安全防护机制对比" class="headerlink" title="6. 系统安全防护机制对比"></a>6. 系统安全防护机制对比</h2><h3 id="6-1-文件权限保护"><a href="#6-1-文件权限保护" class="headerlink" title="6.1 文件权限保护"></a>6.1 文件权限保护</h3><table>
<thead>
<tr>
<th>系统</th>
<th>密码文件</th>
<th>权限设置</th>
<th>访问控制</th>
<th>TPM集成</th>
</tr>
</thead>
<tbody><tr>
<td>Linux</td>
<td>&#x2F;etc&#x2F;shadow</td>
<td>600 (rw——-)</td>
<td>仅root可读写</td>
<td>可选集成</td>
</tr>
<tr>
<td>macOS</td>
<td>.plist文件</td>
<td>600</td>
<td>系统保护 + SIP</td>
<td>T2&#x2F;M1芯片</td>
</tr>
<tr>
<td>Windows</td>
<td>SAM文件</td>
<td>系统独占</td>
<td>运行时锁定</td>
<td>深度集成</td>
</tr>
</tbody></table>
<h3 id="6-2-加密算法强度"><a href="#6-2-加密算法强度" class="headerlink" title="6.2 加密算法强度"></a>6.2 加密算法强度</h3><pre class="mermaid">graph LR
    A["MD5/MD4"] --> B["SHA-1"]
    B --> C["SHA-256"]
    C --> D["SHA-512"]
    D --> E["PBKDF2"]
    E --> F["Argon2"]
    
    A --> G["不安全"]
    B --> H["弱安全"]
    C --> I["中等安全"]
    D --> J["高安全"]
    E --> K["高安全"]
    F --> L["最高安全"]
    
    style F fill:#90EE90
    style L fill:#90EE90</pre>

<h3 id="6-3-盐值-Salt-使用"><a href="#6-3-盐值-Salt-使用" class="headerlink" title="6.3 盐值(Salt)使用"></a>6.3 盐值(Salt)使用</h3><p><strong>Linux:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 每个密码使用随机盐值</span></span><br><span class="line">$6$randomsalt<span class="variable">$hashedpassword</span></span><br></pre></td></tr></table></figure>

<p><strong>macOS:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># PBKDF2使用随机盐值和高迭代次数</span></span><br><span class="line">PBKDF2(password, salt, 10000+ iterations)</span><br></pre></td></tr></table></figure>

<p><strong>Windows:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># NTLM不使用盐值（安全缺陷）</span></span><br><span class="line">MD4(UTF16LE(password))</span><br></pre></td></tr></table></figure>

<h2 id="7-密码破解防护措施"><a href="#7-密码破解防护措施" class="headerlink" title="7. 密码破解防护措施"></a>7. 密码破解防护措施</h2><h3 id="7-1-技术防护"><a href="#7-1-技术防护" class="headerlink" title="7.1 技术防护"></a>7.1 技术防护</h3><p><strong>1. 密码复杂度要求：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Linux PAM配置示例</span></span><br><span class="line">password requisite pam_pwquality.so retry=3 minlen=8 difok=3</span><br></pre></td></tr></table></figure>

<p><strong>2. 账户锁定机制：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 失败尝试次数限制</span></span><br><span class="line">auth required pam_faillock.so deny=5 unlock_time=900</span><br></pre></td></tr></table></figure>

<p><strong>3. 密码历史记录：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 防止重复使用最近的密码</span></span><br><span class="line">password sufficient pam_unix.so remember=5</span><br></pre></td></tr></table></figure>

<h3 id="7-2-现代安全增强"><a href="#7-2-现代安全增强" class="headerlink" title="7.2 现代安全增强"></a>7.2 现代安全增强</h3><p><strong>多因素认证（MFA）：</strong></p>
<pre class="mermaid">graph TD
    A["用户名密码"] --> B["短信验证码"]
    B --> C["生物识别"]
    C --> D["硬件令牌"]
    D --> E["访问授权"]</pre>

<p><strong>无密码认证：</strong></p>
<ul>
<li>Windows Hello</li>
<li>Touch ID &#x2F; Face ID</li>
<li>FIDO2硬件密钥</li>
</ul>
<h2 id="8-实际安全建议"><a href="#8-实际安全建议" class="headerlink" title="8. 实际安全建议"></a>8. 实际安全建议</h2><h3 id="8-1-系统管理员建议"><a href="#8-1-系统管理员建议" class="headerlink" title="8.1 系统管理员建议"></a>8.1 系统管理员建议</h3><p><strong>Linux系统：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 升级到Argon2哈希算法</span></span><br><span class="line"><span class="built_in">sudo</span> apt-get install libpam-pwquality</span><br><span class="line"><span class="comment"># 配置/etc/pam.d/common-password使用Argon2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 启用全磁盘加密</span></span><br><span class="line">cryptsetup luksFormat /dev/sda1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 配置TPM（如果可用）</span></span><br><span class="line">tpm2-tools installation and configuration</span><br></pre></td></tr></table></figure>

<p><strong>macOS系统：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 启用FileVault</span></span><br><span class="line"><span class="built_in">sudo</span> fdesetup <span class="built_in">enable</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 配置密码策略</span></span><br><span class="line"><span class="built_in">sudo</span> pwpolicy -setglobalpolicy <span class="string">&quot;minChars=8 requiresAlpha=1 requiresNumeric=1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 启用防火墙</span></span><br><span class="line"><span class="built_in">sudo</span> /usr/libexec/ApplicationFirewall/socketfilterfw --setglobalstate on</span><br></pre></td></tr></table></figure>

<p><strong>Windows系统：</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 启用BitLocker with TPM</span></span><br><span class="line"><span class="built_in">Enable-BitLocker</span> <span class="literal">-MountPoint</span> C: <span class="literal">-TpmProtector</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 配置密码策略</span></span><br><span class="line">net accounts /minpwlen:<span class="number">8</span> /maxpwage:<span class="number">90</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 启用凭据防护</span></span><br><span class="line"><span class="built_in">Enable-WindowsOptionalFeature</span> <span class="literal">-Online</span> <span class="literal">-FeatureName</span> IsolatedUserMode</span><br></pre></td></tr></table></figure>

<h3 id="8-2-用户安全实践"><a href="#8-2-用户安全实践" class="headerlink" title="8.2 用户安全实践"></a>8.2 用户安全实践</h3><ol>
<li><strong>使用强密码</strong>：至少12位，包含大小写字母、数字和特殊字符</li>
<li><strong>启用多因素认证</strong>：在所有支持的系统和应用中启用MFA</li>
<li><strong>定期更新密码</strong>：定期更换重要账户密码</li>
<li><strong>使用密码管理器</strong>：避免重复使用密码</li>
<li><strong>保持系统更新</strong>：及时安装安全补丁</li>
<li><strong>启用全磁盘加密</strong>：防止物理访问攻击</li>
<li><strong>启用TPM功能</strong>：利用硬件安全模块增强保护</li>
</ol>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>不同操作系统采用了各自独特的密码存储和管理机制：</p>
<ul>
<li><strong>Linux</strong> 使用Shadow系统和强大的哈希算法（推荐升级到Argon2），提供了良好的安全性</li>
<li><strong>macOS</strong> 采用PBKDF2和Keychain服务，集成T2&#x2F;M1安全芯片，安全性很高</li>
<li><strong>Windows</strong> 通过TPM深度集成和BitLocker等现代安全功能，大幅增强了安全性</li>
</ul>
<p><strong>关键安全要点：</strong></p>
<ol>
<li><strong>Argon2优于传统哈希算法</strong>：内存困难、时间可调、并行阻抗</li>
<li><strong>TPM硬件安全模块</strong>：提供硬件级密钥保护和系统完整性验证</li>
<li><strong>全磁盘加密</strong>：防止物理访问攻击的最重要防护措施</li>
<li><strong>多层防护</strong>：结合密码策略、MFA、生物识别等多种安全手段</li>
</ol>
<p>了解这些机制有助于系统管理员和安全专业人员更好地配置和保护系统安全。随着技术发展，无密码认证和生物识别等新技术正在逐步取代传统的密码认证方式，为系统安全提供更强的保障。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a target="_blank" rel="noopener" href="https://linux-pam.org/Linux-PAM-html/">Linux PAM Documentation</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/library/archive/documentation/Security/Conceptual/Security_Overview/">macOS Security Guide</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/security/">Windows Security Technical Reference</a></li>
<li><a target="_blank" rel="noopener" href="https://pages.nist.gov/800-63-3/">NIST Password Guidelines</a></li>
<li><a target="_blank" rel="noopener" href="https://tools.ietf.org/html/draft-irtf-cfrg-argon2-13">Argon2 Specification</a></li>
<li><a target="_blank" rel="noopener" href="https://trustedcomputinggroup.org/resource/tpm-library-specification/">TPM 2.0 Library Specification</a></li>
</ol>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">XR</div><div class="post-copyright__author_desc">一片叶、一朵云</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2025/06/22/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3%EF%BC%9ALinux-macOS-Windows%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86%E6%B7%B1%E5%BA%A6%E5%88%86%E6%9E%90/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2025/06/22/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3%EF%BC%9ALinux-macOS-Windows%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86%E6%B7%B1%E5%BA%A6%E5%88%86%E6%9E%90/')">操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231130275.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231130275.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231143327.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/kongxiaoran/image-repo/blog20241226231143327.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2025/06/22/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3%EF%BC%9ALinux-macOS-Windows%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86%E6%B7%B1%E5%BA%A6%E5%88%86%E6%9E%90/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析&amp;url=http://example.com/2025/06/22/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3%EF%BC%9ALinux-macOS-Windows%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86%E6%B7%B1%E5%BA%A6%E5%88%86%E6%9E%90/&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">凌霄的博客</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>密码存储<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>系统安全<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>哈希算法<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/image-20250929143618895.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/06/19/%E9%9A%90%E7%A7%81%E6%B1%82%E4%BA%A4%E7%9A%84%E5%AD%A6%E4%B9%A0%E6%80%9D%E8%80%83/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/20250607203155245.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">关于隐私集合求交 (PSI) 的认识</div></div></a></div><div class="next-post pull-right"><a href="/2025/06/22/synchronized%E7%9B%91%E8%A7%86%E5%99%A8%E4%B8%8E%E9%9D%9E%E5%85%AC%E5%B9%B3%E9%94%81/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/20250618110852735.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Java监视器有等待队列，为什么synchronized还是非公平锁？</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">XR</h1><div class="author-info__desc">一片叶、一朵云</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/kongxiaoran" target="_blank" title="Github"></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3%EF%BC%9ALinux%E3%80%81macOS%E3%80%81Windows%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86%E6%B7%B1%E5%BA%A6%E5%88%86%E6%9E%90"><span class="toc-number">1.</span> <span class="toc-text">操作系统密码存储机制详解：Linux、macOS、Windows密码管理深度分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E8%A8%80"><span class="toc-number">1.1.</span> <span class="toc-text">引言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Linux%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8%E6%9C%BA%E5%88%B6"><span class="toc-number">1.2.</span> <span class="toc-text">1. Linux系统密码存储机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%BC%A0%E7%BB%9F%E7%9A%84-etc-passwd%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.1 传统的&#x2F;etc&#x2F;passwd文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E7%8E%B0%E4%BB%A3%E7%9A%84Shadow%E5%AF%86%E7%A0%81%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2 现代的Shadow密码系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-Linux%E5%AF%86%E7%A0%81%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95"><span class="toc-number">1.2.3.</span> <span class="toc-text">1.3 Linux密码哈希算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E5%AE%9E%E9%99%85%E5%AD%98%E5%82%A8%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.2.4.</span> <span class="toc-text">1.4 实际存储示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81%E6%B5%81%E7%A8%8B"><span class="toc-number">1.2.5.</span> <span class="toc-text">1.5 密码验证流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-macOS%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8%E6%9C%BA%E5%88%B6"><span class="toc-number">1.3.</span> <span class="toc-text">2. macOS系统密码存储机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Open-Directory%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.3.1.</span> <span class="toc-text">2.1 Open Directory服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%AF%86%E7%A0%81%E5%93%88%E5%B8%8C%E5%AD%98%E5%82%A8"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.2 密码哈希存储</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-PBKDF2%E7%AE%97%E6%B3%95"><span class="toc-number">1.3.3.</span> <span class="toc-text">2.3 PBKDF2算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-Keychain%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.4.</span> <span class="toc-text">2.4 Keychain密码管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-FileVault%E7%A3%81%E7%9B%98%E5%8A%A0%E5%AF%86"><span class="toc-number">1.3.5.</span> <span class="toc-text">2.5 FileVault磁盘加密</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Windows%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8%E6%9C%BA%E5%88%B6"><span class="toc-number">1.4.</span> <span class="toc-text">3. Windows系统密码存储机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-SAM%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.4.1.</span> <span class="toc-text">3.1 SAM数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%AF%86%E7%A0%81%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95"><span class="toc-number">1.4.2.</span> <span class="toc-text">3.2 密码哈希算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-SAM%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-number">1.4.3.</span> <span class="toc-text">3.3 SAM文件结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E5%AF%86%E7%A0%81%E5%AD%98%E5%82%A8%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.4.4.</span> <span class="toc-text">3.4 密码存储格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-Windows-TPM%E9%9B%86%E6%88%90%E4%B8%8E%E5%AE%89%E5%85%A8%E5%A2%9E%E5%BC%BA"><span class="toc-number">1.4.5.</span> <span class="toc-text">3.5 Windows TPM集成与安全增强</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-1-TPM%E5%9C%A8Windows%E4%B8%AD%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">1.4.5.1.</span> <span class="toc-text">3.5.1 TPM在Windows中的作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-2-TPM%E5%AF%86%E9%92%A5%E5%B0%81%E8%A3%85%E6%9C%BA%E5%88%B6"><span class="toc-number">1.4.5.2.</span> <span class="toc-text">3.5.2 TPM密钥封装机制</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-Windows%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81%E6%B5%81%E7%A8%8B"><span class="toc-number">1.4.6.</span> <span class="toc-text">3.6 Windows密码验证流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%AF%86%E7%A0%81%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95%E6%B7%B1%E5%BA%A6%E5%88%86%E6%9E%90%EF%BC%9A%E4%B8%BA%E4%BB%80%E4%B9%88Argon2%E6%AF%94SHA-512%E6%9B%B4%E5%AE%89%E5%85%A8"><span class="toc-number">1.5.</span> <span class="toc-text">4. 密码哈希算法深度分析：为什么Argon2比SHA-512更安全</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E7%AE%97%E6%B3%95%E7%B1%BB%E5%9E%8B%E5%AF%B9%E6%AF%94"><span class="toc-number">1.5.1.</span> <span class="toc-text">4.1 算法类型对比</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1-%E5%BF%AB%E9%80%9F%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">4.1.1 快速哈希算法的问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-2-Argon2%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%BC%98%E5%8A%BF"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">4.1.2 Argon2的设计优势</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-Argon2%E7%9A%84%E4%B8%89%E9%87%8D%E9%98%B2%E6%8A%A4%E6%9C%BA%E5%88%B6"><span class="toc-number">1.5.2.</span> <span class="toc-text">4.2 Argon2的三重防护机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E5%86%85%E5%AD%98%E5%9B%B0%E9%9A%BE%E6%80%A7%EF%BC%88Memory-Hard%EF%BC%89"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">4.2.1 内存困难性（Memory-Hard）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%8E%A7%E5%88%B6"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">4.2.2 时间复杂度控制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-3-%E5%B9%B6%E8%A1%8C%E5%8C%96%E9%98%BB%E6%8A%97"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">4.2.3 并行化阻抗</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E7%AE%97%E6%B3%95%E5%AE%89%E5%85%A8%E6%80%A7%E9%87%8F%E5%8C%96%E5%AF%B9%E6%AF%94"><span class="toc-number">1.5.3.</span> <span class="toc-text">4.3 算法安全性量化对比</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-1-%E7%A0%B4%E8%A7%A3%E6%88%90%E6%9C%AC%E5%88%86%E6%9E%90"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">4.3.1 破解成本分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-%E5%AE%9E%E9%99%85%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">4.3.2 实际安全建议</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%A3%81%E7%9B%98%E6%94%BB%E5%87%BB%E4%B8%8E%E9%98%B2%E6%8A%A4%E6%9C%BA%E5%88%B6"><span class="toc-number">1.6.</span> <span class="toc-text">5. 磁盘攻击与防护机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E7%A6%BB%E7%BA%BF%E6%94%BB%E5%87%BB%E7%9A%84%E5%A8%81%E8%83%81"><span class="toc-number">1.6.1.</span> <span class="toc-text">5.1 离线攻击的威胁</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-1-%E4%BC%A0%E7%BB%9F%E7%A3%81%E7%9B%98%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">5.1.1 传统磁盘攻击方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E7%8E%B0%E4%BB%A3%E9%98%B2%E6%8A%A4%E6%9C%BA%E5%88%B6"><span class="toc-number">1.6.2.</span> <span class="toc-text">5.2 现代防护机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-1-%E5%85%A8%E7%A3%81%E7%9B%98%E5%8A%A0%E5%AF%86%E9%98%B2%E6%8A%A4"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">5.2.1 全磁盘加密防护</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-2-TPM%E9%9B%86%E6%88%90%E9%98%B2%E6%8A%A4"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">5.2.2 TPM集成防护</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-3-%E5%AE%89%E5%85%A8%E5%90%AF%E5%8A%A8%E9%93%BE"><span class="toc-number">1.6.2.3.</span> <span class="toc-text">5.2.3 安全启动链</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E9%AB%98%E7%BA%A7%E9%98%B2%E6%8A%A4%E7%AD%96%E7%95%A5"><span class="toc-number">1.6.3.</span> <span class="toc-text">5.3 高级防护策略</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-1-%E5%A4%9A%E5%9B%A0%E7%B4%A0%E5%AF%86%E9%92%A5%E6%B4%BE%E7%94%9F"><span class="toc-number">1.6.3.1.</span> <span class="toc-text">5.3.1 多因素密钥派生</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-2-%E8%BF%9C%E7%A8%8B%E8%AE%A4%E8%AF%81%E6%9C%BA%E5%88%B6"><span class="toc-number">1.6.3.2.</span> <span class="toc-text">5.3.2 远程认证机制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4%E6%9C%BA%E5%88%B6%E5%AF%B9%E6%AF%94"><span class="toc-number">1.7.</span> <span class="toc-text">6. 系统安全防护机制对比</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%BF%9D%E6%8A%A4"><span class="toc-number">1.7.1.</span> <span class="toc-text">6.1 文件权限保护</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E5%BC%BA%E5%BA%A6"><span class="toc-number">1.7.2.</span> <span class="toc-text">6.2 加密算法强度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E7%9B%90%E5%80%BC-Salt-%E4%BD%BF%E7%94%A8"><span class="toc-number">1.7.3.</span> <span class="toc-text">6.3 盐值(Salt)使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E5%AF%86%E7%A0%81%E7%A0%B4%E8%A7%A3%E9%98%B2%E6%8A%A4%E6%8E%AA%E6%96%BD"><span class="toc-number">1.8.</span> <span class="toc-text">7. 密码破解防护措施</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E6%8A%80%E6%9C%AF%E9%98%B2%E6%8A%A4"><span class="toc-number">1.8.1.</span> <span class="toc-text">7.1 技术防护</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E7%8E%B0%E4%BB%A3%E5%AE%89%E5%85%A8%E5%A2%9E%E5%BC%BA"><span class="toc-number">1.8.2.</span> <span class="toc-text">7.2 现代安全增强</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%AE%9E%E9%99%85%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.9.</span> <span class="toc-text">8. 实际安全建议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.9.1.</span> <span class="toc-text">8.1 系统管理员建议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E7%94%A8%E6%88%B7%E5%AE%89%E5%85%A8%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.9.2.</span> <span class="toc-text">8.2 用户安全实践</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="toc-number">1.10.</span> <span class="toc-text">结论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">1.11.</span> <span class="toc-text">参考资料</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/09/29/SecretPad%20All%20in%20One%20%E4%B8%AD%E5%BF%83%E5%8C%96%E9%83%A8%E7%BD%B2%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E6%B5%8B%E8%AF%95/" title="SecretPad All-in-One中心化部署模式安装与测试"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/image-20250929143618895.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SecretPad All-in-One中心化部署模式安装与测试"/></a><div class="content"><a class="title" href="/2025/09/29/SecretPad%20All%20in%20One%20%E4%B8%AD%E5%BF%83%E5%8C%96%E9%83%A8%E7%BD%B2%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E6%B5%8B%E8%AF%95/" title="SecretPad All-in-One中心化部署模式安装与测试">SecretPad All-in-One中心化部署模式安装与测试</a><time datetime="2025-09-29T10:00:00.000Z" title="发表于 2025-09-29 18:00:00">2025-09-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/26/%E5%8D%95%E6%9C%BA%E6%90%AD%E5%BB%BA%20kuscia%E5%A4%9A%E6%9C%BA%E9%83%A8%E7%BD%B2%E7%82%B9%E5%AF%B9%E7%82%B9%E9%9B%86%E7%BE%A4/" title="单机模拟Kuscia多机部署点对点集群实践指南"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/20250804092337513.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="单机模拟Kuscia多机部署点对点集群实践指南"/></a><div class="content"><a class="title" href="/2025/09/26/%E5%8D%95%E6%9C%BA%E6%90%AD%E5%BB%BA%20kuscia%E5%A4%9A%E6%9C%BA%E9%83%A8%E7%BD%B2%E7%82%B9%E5%AF%B9%E7%82%B9%E9%9B%86%E7%BE%A4/" title="单机模拟Kuscia多机部署点对点集群实践指南">单机模拟Kuscia多机部署点对点集群实践指南</a><time datetime="2025-09-26T11:00:00.000Z" title="发表于 2025-09-26 19:00:00">2025-09-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/24/%E9%9A%90%E8%AF%ADSecretflow%E2%80%94%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85%E4%BD%93%E9%AA%8C/" title="隐语Secretflow—源码编译安装体验"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/image-20250924140004853.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="隐语Secretflow—源码编译安装体验"/></a><div class="content"><a class="title" href="/2025/09/24/%E9%9A%90%E8%AF%ADSecretflow%E2%80%94%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85%E4%BD%93%E9%AA%8C/" title="隐语Secretflow—源码编译安装体验">隐语Secretflow—源码编译安装体验</a><time datetime="2025-09-24T06:00:00.000Z" title="发表于 2025-09-24 14:00:00">2025-09-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/22/DNS%E6%8A%95%E6%AF%92%E5%8E%9F%E7%90%86%E4%B8%8E%E8%BF%87%E7%A8%8B/" title="DNS投毒原理与过程"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/20250716144607754.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DNS投毒原理与过程"/></a><div class="content"><a class="title" href="/2025/09/22/DNS%E6%8A%95%E6%AF%92%E5%8E%9F%E7%90%86%E4%B8%8E%E8%BF%87%E7%A8%8B/" title="DNS投毒原理与过程">DNS投毒原理与过程</a><time datetime="2025-09-22T13:30:00.000Z" title="发表于 2025-09-22 21:30:00">2025-09-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/22/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E4%B8%B2%E7%83%A7/" title="计算机网络核心概念串烧"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://raw.githubusercontent.com/kongxiaoran/image-repo/main/blog/09c33b5dbe1bd3fec63ad2e4128b55b6.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="计算机网络核心概念串烧"/></a><div class="content"><a class="title" href="/2025/09/22/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E4%B8%B2%E7%83%A7/" title="计算机网络核心概念串烧">计算机网络核心概念串烧</a><time datetime="2025-09-22T02:00:00.000Z" title="发表于 2025-09-22 10:00:00">2025-09-22</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 - 2025 By <a class="footer-bar-link" href="/" title="XR" target="_blank">XR</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">69</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">99</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">5</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Argon2/" style="font-size: 0.88rem;">Argon2<sup>1</sup></a><a href="/tags/DNS/" style="font-size: 0.88rem;">DNS<sup>4</sup></a><a href="/tags/GRUB/" style="font-size: 0.88rem;">GRUB<sup>1</sup></a><a href="/tags/HDFS/" style="font-size: 0.88rem;">HDFS<sup>4</sup></a><a href="/tags/HTTP/" style="font-size: 0.88rem;">HTTP<sup>1</sup></a><a href="/tags/Hadoop/" style="font-size: 0.88rem;">Hadoop<sup>4</sup></a><a href="/tags/HyperEnclave/" style="font-size: 0.88rem;">HyperEnclave<sup>5</sup></a><a href="/tags/Hypervisor/" style="font-size: 0.88rem;">Hypervisor<sup>2</sup></a><a href="/tags/KVM/" style="font-size: 0.88rem;">KVM<sup>2</sup></a><a href="/tags/Kerberos/" style="font-size: 0.88rem;">Kerberos<sup>1</sup></a><a href="/tags/Kubernetes/" style="font-size: 0.88rem;">Kubernetes<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>7</sup></a><a href="/tags/Linux%E8%BF%90%E7%BB%B4/" style="font-size: 0.88rem;">Linux运维<sup>1</sup></a><a href="/tags/TEE/" style="font-size: 0.88rem;">TEE<sup>10</sup></a><a href="/tags/TPM/" style="font-size: 0.88rem;">TPM<sup>1</sup></a><a href="/tags/UEFI/" style="font-size: 0.88rem;">UEFI<sup>1</sup></a><a href="/tags/VMware/" style="font-size: 0.88rem;">VMware<sup>1</sup></a><a href="/tags/Xen/" style="font-size: 0.88rem;">Xen<sup>1</sup></a><a href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/" style="font-size: 0.88rem;">云原生<sup>1</sup></a><a href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" style="font-size: 0.88rem;">云计算<sup>1</sup></a><a href="/tags/%E4%BB%A3%E7%90%86/" style="font-size: 0.88rem;">代理<sup>1</sup></a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/" style="font-size: 0.88rem;">分布式存储<sup>2</sup></a><a href="/tags/%E5%8F%AF%E4%BF%A1%E5%90%AF%E5%8A%A8/" style="font-size: 0.88rem;">可信启动<sup>1</sup></a><a href="/tags/%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE%E9%99%90%E5%88%B6/" style="font-size: 0.88rem;">地理位置限制<sup>1</sup></a><a href="/tags/%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/" style="font-size: 0.88rem;">学习路线<sup>1</sup></a><a href="/tags/%E5%AE%89%E5%85%A8%E5%90%AF%E5%8A%A8/" style="font-size: 0.88rem;">安全启动<sup>1</sup></a><a href="/tags/%E5%AF%86%E7%A0%81%E5%93%88%E5%B8%8C/" style="font-size: 0.88rem;">密码哈希<sup>1</sup></a><a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size: 0.88rem;">密码学<sup>5</sup></a><a href="/tags/%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5/" style="font-size: 0.88rem;">故障排查<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 0.88rem;">日志<sup>1</sup></a><a href="/tags/%E6%9C%BA%E5%AF%86%E8%AE%A1%E7%AE%97/" style="font-size: 0.88rem;">机密计算<sup>2</sup></a><a href="/tags/%E6%B5%81%E5%AA%92%E4%BD%93%E8%A7%A3%E9%94%81/" style="font-size: 0.88rem;">流媒体解锁<sup>1</sup></a><a href="/tags/%E7%A3%81%E7%9B%98%E7%A9%BA%E9%97%B4/" style="font-size: 0.88rem;">磁盘空间<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/" style="font-size: 0.88rem;">系统日志<sup>1</sup></a><a href="/tags/%E7%BC%93%E5%AD%98%E6%B1%A1%E6%9F%93/" style="font-size: 0.88rem;">缓存污染<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E5%88%86%E6%9E%90/" style="font-size: 0.88rem;">网络分析<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="font-size: 0.88rem;">网络安全<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/" style="font-size: 0.88rem;">虚拟化<sup>5</sup></a><a href="/tags/%E8%AE%BA%E6%96%87%E7%BF%BB%E8%AF%91/" style="font-size: 0.88rem;">论文翻译<sup>1</sup></a><a href="/tags/%E9%9A%90%E7%A7%81%E8%AE%A1%E7%AE%97/" style="font-size: 0.88rem;">隐私计算<sup>6</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("12/26/2024 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2024 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 XR 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.cbd.int/mermaid@10.2.4/dist/mermaid.min.js').then(runMermaid)
  }

  anzhiyu.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const initValine = () => {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'cbSQtAqs68yENzUQ5wpQK826-MdYXbMMI',
      appKey: 'MR93sqmbPdh7Zm1bZzjXNvlm',
      avatar: 'mp',
      serverURLs: 'https://cbsqtaqs.api.lncldglobal.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  const loadValine = async () => {
    if (typeof Valine === 'function') initValine()
    else {
      await getScript('https://cdn.cbd.int/valine@1.5.1/dist/Valine.min.js')
      initValine()
    }
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script src="https://cdn.cbd.int/blueimp-md5@2.19.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getIcon = (icon, mail) => {
    if (icon) return icon
    let defaultIcon = '?d=mp'
    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`
    return iconUrl
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = () => {
    const serverURL = 'https://cbsqtaqs.api.lncldglobal.com'

    var settings = {
      "method": "GET",
      "headers": {
        "X-LC-Id": 'cbSQtAqs68yENzUQ5wpQK826-MdYXbMMI',
        "X-LC-Key": 'MR93sqmbPdh7Zm1bZzjXNvlm',
        "Content-Type": "application/json"
      },
    }

    fetch(`${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,settings)
      .then(response => response.json())
      .then(data => {
        const valineArray = data.results.map(function (e) {
          return {
            'avatar': getIcon(e.QQAvatar, e.mail),
            'content': changeContent(e.comment),
            'nick': e.nick,
            'url': e.url + '#' + e.objectId,
            'date': e.updatedAt,
          }
        })
        saveToLocal.set('valine-newest-comments', JSON.stringify(valineArray), 10/(60*24))
        generateHtml(valineArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      }) 
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('valine-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>